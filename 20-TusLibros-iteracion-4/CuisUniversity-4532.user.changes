

----STARTUP---- (9 June 2021 00:21:16) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!



Object subclass: #CarritoTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CarritoTest category: #TusLibros stamp: 'ET 6/9/2021 18:26:19'!
Object subclass: #CarritoTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Cart category: #TusLibros stamp: 'ET 6/9/2021 18:27:43'!
Object subclass: #Cart
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CarritoTest methodsFor: 'no messages' stamp: 'ET 6/9/2021 18:27:37'!
test01NewCartisEmpty

	|cart|
	
	cart := Cart new.
	
	self assert: cart isEmpty.! !

TestCase subclass: #CarritoTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CarritoTest category: #TusLibros stamp: 'ET 6/9/2021 18:27:53'!
TestCase subclass: #CarritoTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 18:27:55'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:28:01'!
isEmpty
	self shouldBeImplemented.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:28:08' prior: 51031032!
isEmpty
	^true.! !

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 18:28:10'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 18:28:10'!
PASSED!

!classDefinition: #Book category: #TusLibros stamp: 'ET 6/9/2021 18:31:33'!
Object subclass: #Book
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:31:29'!
test02NewCartIsAddedABookAndItsListHasThatBook

	|cart book|
	
	cart := Cart new.
	
	book := Book new.
	
	cart addBook: book.
	
	self deny: cart isEmpty.
	self assert: cart hasBook: book.! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:31:40' prior: 51031051!
test02NewCartIsAddedABookAndItsListHasThatBook

	|cart book|
	
	cart := Cart new.
	
	book := Book new.
	
	cart addBook: book.
	
	self deny: cart isEmpty.
	self assert: (cart hasBook: book).! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:31:42'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:31:48'!
addBook: aBook 
	self shouldBeImplemented.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:32:12' prior: 51031072!
addBook: aBook ! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:32:14'!
FAILURE!

!classDefinition: #Cart category: #TusLibros stamp: 'ET 6/9/2021 18:33:31'!
Object subclass: #Cart
	instanceVariableNames: 'books'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:33:29' prior: 51031077!
addBook: aBook 

	books ifNotNil: [books add: aBook].! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:33:32'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:33:50' prior: 51031091!
addBook: aBook 

	books ifNotNil: [books := OrderedCollection with: aBook].! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:33:53'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:34:45' prior: 51031036!
isEmpty
	^books isEmpty.! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:34:49'!
ERROR!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:35:33'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:35:43' prior: 51031099!
addBook: aBook 

	books ifNotNil: [books := OrderedCollection with: aBook].
	self halt.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:35:56' prior: 51031119!
addBook: aBook 

	books ifNil: [books := OrderedCollection with: aBook].
	self halt.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:36:03' prior: 51031125!
addBook: aBook 

	books ifNil: [books := OrderedCollection with: aBook].! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:36:04'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:36:11'!
hasBook: aBook 
	self shouldBeImplemented.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:36:27' prior: 51031140!
hasBook: aBook 
	^books includes: aBook.! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:36:29'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 18:36:29'!
ERROR!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:36:29'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 18:36:29'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:37:04' prior: 51031108!
isEmpty
	^books ifNil: [books := OrderedCollection new.
		books isEmpty.]! !

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 18:37:06'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:37:10'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:37:41' prior: 51031162!
isEmpty
	books ifNil: [books := OrderedCollection new.
		^books isEmpty.]! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:37:43'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:38:03' prior: 51031174!
isEmpty
	books ifNil: [books := OrderedCollection new.]
	
	^books isEmpty.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:38:05' prior: 51031183!
isEmpty
	books ifNil: [books := OrderedCollection new.].
	
	^books isEmpty.! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:38:06'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 18:38:06'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:38:06'!
PASSED!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:39:12' overrides: 16896425!
initialize

	books := OrderedCollection new.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:39:23' prior: 51031131!
addBook: aBook 

	books add: aBook.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:39:35' prior: 51031189!
isEmpty
	
	^books isEmpty.! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:39:43'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 18:39:43'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:39:43'!
PASSED!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:43:32'!
test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks

	|cart book1 book2|
	
	cart := Cart new.
	
	book1 := Book new.
	
	book2 := Book new.
	
	cart addBook: book1;
		addBook: book2.
	
	self deny: cart bookList size equals: 2.
	self assert: (cart bookList includes: book1).
	self assert: (cart bookList includes: book2).! !

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 18:43:34'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:43:45'!
bookList
	self shouldBeImplemented.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:43:53' prior: 51031243!
bookList
	^books copy.! !

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 18:43:54'!
ERROR!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:44:07' prior: 51031226!
test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks

	|cart book1 book2|
	
	cart := Cart new.
	
	book1 := Book new.
	
	book2 := Book new.
	
	cart addBook: book1;
		addBook: book2.
	
	self assert: cart bookList size equals: 2.
	self assert: (cart bookList includes: book1).
	self assert: (cart bookList includes: book2).! !

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 18:44:13'!
ERROR!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 18:44:17'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 18:44:17'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:44:17'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 18:44:17'!
PASSED!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:46:19'!
test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks

	|cart book |
	
	cart := Cart new.
	
	book := Book new.
	
	cart addBook: book;
		addBook: book.
	
	self assert: cart bookList size equals: 2.
	self assert: (cart bookList first) equals: book.
	self assert: (cart bookList second) equals: book.! !

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 18:46:21'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 18:46:21'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 18:46:21'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 18:46:21'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 18:46:21'!
PASSED!

!classDefinition: #BookCatalog category: #TusLibros stamp: 'ET 6/9/2021 18:54:51'!
Object subclass: #BookCatalog
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:54:47'!
test05

	|cart book catalog|
	
	catalog := BookCatalog new.
	
	cart := Cart new.
	
	book := Book new.
	
	cart addBook: book;
		addBook: book.
	
	self assert: cart bookList size equals: 2.
	self assert: (cart bookList first) equals: book.
	self assert: (cart bookList second) equals: book.! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:55:24' prior: 51031323!
test05

	|cart book catalog|
	
	catalog := BookCatalog new.
	
	cart := Cart xxxx: catalog.
	
	book := Book new.
	
	cart addBook: book;
		addBook: book.
	
	self assert: cart bookList size equals: 2.
	self assert: (cart bookList first) equals: book.
	self assert: (cart bookList second) equals: book.! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:55:43' prior: 51031336!
test05

	|cart book catalog|
	
	catalog := BookCatalog new.
	
	cart := Cart xxxx: catalog.
	
	book := Book new.
	
	
! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:56:50' prior: 51031349!
test05

	|cart book catalog|
	
	catalog := BookCatalog new.
	
	cart := Cart xxxx: catalog.
	
	book := Book new.
	
	self should:[cart addBook: book]
	raise: Error 
	withExceptionDo: [ :anError | self assert: anError messageText equals: (Cart canNotAddBookThatIsNotInTheCatalog) ].
	
	
! !

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 18:56:54'!
ERROR!
!Cart class methodsFor: 'instance creation' stamp: 'ET 6/9/2021 18:57:01'!
xxxx: aBookCatalog 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeXxxx: aBookCatalog ! !
!Cart class methodsFor: 'instance creation' stamp: 'ET 6/9/2021 18:57:16' prior: 51031370!
xxxx: aBookCatalog 
	
	^self new initializeXxxx: aBookCatalog.! !

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 18:57:19'!
ERROR!

!classDefinition: #Cart category: #TusLibros stamp: 'ET 6/9/2021 18:57:26'!
Object subclass: #Cart
	instanceVariableNames: 'books bookCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cart methodsFor: 'initialization' stamp: 'ET 6/9/2021 18:57:26'!
initializeXxxx: aBookCatalog 
	self shouldBeImplemented.
	bookCatalog := aBookCatalog.! !
!Cart methodsFor: 'initialization' stamp: 'ET 6/9/2021 18:57:40' prior: 51031391!
initializeXxxx: aBookCatalog 

	bookCatalog := aBookCatalog.
	books := OrderedCollection new.! !

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 18:57:43'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:58:19' prior: 51031209!
addBook: aBook 

	self assertBookIsInCatalog: aBook.

	books add: aBook.! !

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 18:58:22'!
ERROR!
!Cart class methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:58:41'!
canNotAddBookThatIsNotInTheCatalog
	self shouldBeImplemented.! !
!Cart class methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 18:59:07' prior: 51031412!
canNotAddBookThatIsNotInTheCatalog
	
	^'No se puede agregar un libro que no est� en el cat�logo de compras'.! !

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 18:59:09'!
FAILURE!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 18:59:22'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:02:21'!
assertBookIsInCatalog: aBook

	bookCatalog hasBook: aBook ifFalse: [self error: self class canNotAddBookThatIsNotInTheCatalog ].! !

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:02:31'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:02:31'!
ERROR!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:02:31'!
ERROR!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:02:31'!
ERROR!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:02:31'!
FAILURE!
!BookCatalog methodsFor: 'no messages' stamp: 'ET 6/9/2021 19:03:05'!
hasBook: aBook

	^true! !

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:03:08'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:03:08'!
ERROR!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:03:08'!
ERROR!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:03:08'!
ERROR!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:03:08'!
FAILURE!

!classDefinition: #BookCatalog category: #TusLibros stamp: 'ET 6/9/2021 19:04:00'!
Object subclass: #BookCatalog
	instanceVariableNames: 'books'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!BookCatalog methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:03:59'!
addBook: aBook

	books add: aBook.! !
!BookCatalog methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:04:12' overrides: 16896425!
initialize

	books := OrderedCollection new.! !
!BookCatalog methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:04:20' prior: 51031483 overrides: 16896425!
initialize

	books := Set new.! !

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:04:28'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:04:28'!
ERROR!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:04:28'!
ERROR!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:04:28'!
ERROR!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:04:28'!
FAILURE!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:05:30' prior: 51031060!
test02NewCartIsAddedABookAndItsListHasThatBook

	|cart book catalog|
	
	catalog := BookCatalog new.
	book := Book new.
	
	catalog addBook: book.
	
	cart := Cart xxxx: catalog.
	
	cart addBook: book.
	
	self deny: cart isEmpty.
	self assert: (cart hasBook: book).! !

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:05:32'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:05:32'!
ERROR!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:05:32'!
ERROR!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:05:32'!
ERROR!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:05:32'!
FAILURE!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:05:39'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:05:55' prior: 51031428!
assertBookIsInCatalog: aBook

	(bookCatalog hasBook: aBook) ifFalse: [self error: self class canNotAddBookThatIsNotInTheCatalog ].! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:05:57'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:05:59'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:05:59'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:05:59'!
ERROR!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:05:59'!
ERROR!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:05:59'!
FAILURE!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:06:34' prior: 51031255!
test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks

	|cart book1 book2 catalog|
	
	catalog := BookCatalog new.
	book1 := Book new.
	book2 := Book new.
	
	catalog addBook: book1.
	catalog addBook: book2.
	
	cart := Cart xxxx: catalog.
	
	cart addBook: book1;
		addBook: book2.
	
	self assert: cart bookList size equals: 2.
	self assert: (cart bookList includes: book1).
	self assert: (cart bookList includes: book2).! !

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:06:35'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:06:35'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:06:35'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:06:35'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:06:35'!
ERROR!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:06:35'!
FAILURE!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:07:59' prior: 51031286!
test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks

	|cart book catalog |
	
	catalog := BookCatalog new.
	book := Book new.
	catalog addBook: book.
	cart := Cart xxxx: catalog.
	
	cart addBook: book;
		addBook: book.
	
	self assert: cart bookList size equals: 2.
	self assert: (cart bookList first) equals: book.
	self assert: (cart bookList second) equals: book.! !

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:08:02'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:08:02'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:08:02'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:08:02'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:08:02'!
FAILURE!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:08:02'!
FAILURE!
!BookCatalog methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:08:51' prior: 51031451!
hasBook: aBook

	^books includes: aBook.! !

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:08:53'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:08:57'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:08:57'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:08:57'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:08:57'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:08:57'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:08:57'!
PASSED!

TestCase subclass: #CarritoTest
	instanceVariableNames: 'catalog cart'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

TestCase subclass: #CarritoTest
	instanceVariableNames: 'catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CarritoTest category: #TusLibros stamp: 'ET 6/9/2021 19:14:27'!
TestCase subclass: #CarritoTest
	instanceVariableNames: 'catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:15:34' prior: 51031510!
test02NewCartIsAddedABookAndItsListHasThatBook

	|cart book catalog|
	
	catalog := BookCatalog new.
	book := Book new.
	
	catalog addBook: book.
	
	cart := self emptyCartWithEmptyCatalog.
	
	cart addBook: book.
	
	self deny: cart isEmpty.
	self assert: (cart hasBook: book).! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:15:38'!
ERROR!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:15:45'!
emptyCartWithEmptyCatalog
	self shouldBeImplemented.! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:16:24' prior: 51031695!
emptyCartWithEmptyCatalog
	
	catalogue := BookCatalog new.
	
	^Cart xxxx: catalogue.! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:16:27'!
ERROR!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:16:53' prior: 51031680!
test02NewCartIsAddedABookAndItsListHasThatBook

	|cart book |
	
	book := Book new.
	
	cart := self emptyCartWithEmptyCatalog.
	
	catalogue addBook: book.
	
	cart addBook: book.
	
	self deny: cart isEmpty.
	self assert: (cart hasBook: book).! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:16:54'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:16:54'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:16:54'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:16:54'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:16:54'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:16:54'!
PASSED!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:17:46' prior: 51031710!
test02NewCartIsAddedABookAndItsListHasThatBook

	|cart book |
	
	book := Book new.
	
	cart := self emptyCartWithCatalogue.
	
	catalogue addBook: book.
	
	cart addBook: book.
	
	self deny: cart isEmpty.
	self assert: (cart hasBook: book).! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:18:04' prior: 51031741!
test02NewCartIsAddedABookAndItsListHasThatBook

	|cart book |
	
	book := Book new.
	
	cart := self emptyCart.
	
	catalogue addBook: book.
	
	cart addBook: book.
	
	self deny: cart isEmpty.
	self assert: (cart hasBook: book).! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:19:06' overrides: 16927572!
setUp

	catalogue := BookCatalog new.! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:19:16' prior: 51031700!
emptyCartWithEmptyCatalog
	
	^Cart xxxx: catalogue.! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:19:25'!
emptyCart
	
	^Cart xxxx: catalogue.! !

!methodRemoval: CarritoTest #emptyCartWithEmptyCatalog stamp: 'ET 6/9/2021 19:19:25'!
emptyCartWithEmptyCatalog
	
	^Cart xxxx: catalogue.!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:19:31'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:19:31'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:19:31'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:19:31'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:19:31'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:19:31'!
PASSED!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:19:39' prior: 51031013!
test01NewCartisEmpty

	|cart|
	
	cart := self emptyCart.
	
	self assert: cart isEmpty.! !

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:20:08'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:20:08'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:20:08'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:20:08'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:20:08'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:20:08'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:20:25'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:20:25'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:20:25'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:20:25'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:20:25'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:20:25'!
PASSED!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:20:55' prior: 51031752!
test02NewCartIsAddedABookAndItsListHasThatBook

	|cart book |
	
	book := Book new.
	catalogue addBook: book.
	cart := self emptyCart.
	
	cart addBook: book.
	
	self deny: cart isEmpty.
	self assert: (cart hasBook: book).! !

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:21:04'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:21:04'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:21:04'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:21:04'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:21:04'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:21:04'!
PASSED!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:22:03' prior: 51031568!
test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks

	|cart book1 book2 |
	
	book1 := Book new.
	book2 := Book new.
	catalogue 
		addBook: book1;
		addBook: book2.

	cart := self emptyCart.
	cart addBook: book1;
		addBook: book2.
	
	self assert: cart bookList size equals: 2.
	self assert: (cart bookList includes: book1).
	self assert: (cart bookList includes: book2).! !

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:22:07'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:22:07'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:22:07'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:22:07'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:22:07'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:22:07'!
PASSED!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:22:35' prior: 51031605!
test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks

	|cart book |
	
	book := Book new.
	catalogue addBook: book.
	cart := self emptyCart.
	
	cart addBook: book;
		addBook: book.
	
	self assert: cart bookList size equals: 2.
	self assert: (cart bookList first) equals: book.
	self assert: (cart bookList second) equals: book.! !

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:22:37'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:22:37'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:22:37'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:22:37'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:22:37'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:22:37'!
PASSED!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:22:58' prior: 51031356!
test05

	|cart book |
	
	cart := self emptyCart.
	book := Book new.
	
	self should:[cart addBook: book]
	raise: Error 
	withExceptionDo: [ :anError | self assert: anError messageText equals: (Cart canNotAddBookThatIsNotInTheCatalog) ].
	
	
! !

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:23:00'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:23:00'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:23:00'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:23:00'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:23:00'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:23:00'!
PASSED!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:26:02' prior: 51031910!
test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks

	|cart book |
	
	book := Book new.
	catalogue addBook: book.
	cart := self emptyCart.
	
	cart addBook: book;
		addBook: book.
	
	self assert: cart bookList size equals: 2.
	self assert: (cart bookList occurrencesOf: book) equals: 2.! !

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:26:03'!
PASSED!

!testRun: #CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:26:03'!
PASSED!

!testRun: #CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:26:03'!
PASSED!

!testRun: #CarritoTest #test03NewCartIsAddedTwoDifferentBooksAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:26:03'!
PASSED!

!testRun: #CarritoTest #test04NewCartIsAddedTheSameBookTwiceAndItsListHasThoseBooks stamp: 'ET 6/9/2021 19:26:03'!
PASSED!

!testRun: #CarritoTest #test05 stamp: 'ET 6/9/2021 19:26:03'!
PASSED!
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:33:05'!
test05NewCartCannotAddBookThatIsNotInTheCatalog

	|cart book |
	
	cart := self emptyCart.
	book := Book new.
	
	self should:[cart addBook: book]
	raise: Error 
	withExceptionDo: [ :anError | self assert: anError messageText equals: (Cart canNotAddBookThatIsNotInTheCatalog) ].
	
	
! !

!methodRemoval: CarritoTest #test05 stamp: 'ET 6/9/2021 19:33:05'!
test05

	|cart book |
	
	cart := self emptyCart.
	book := Book new.
	
	self should:[cart addBook: book]
	raise: Error 
	withExceptionDo: [ :anError | self assert: anError messageText equals: (Cart canNotAddBookThatIsNotInTheCatalog) ].
	
	
!
!Cart methodsFor: 'initialization' stamp: 'ET 6/9/2021 19:34:15'!
initializeWithCatalog: aBookCatalog 

	bookCatalog := aBookCatalog.
	books := OrderedCollection new.! !
!Cart class methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:34:15' prior: 51031378!
xxxx: aBookCatalog 
	
	^self new initializeWithCatalog: aBookCatalog.! !

!methodRemoval: Cart #initializeXxxx: stamp: 'ET 6/9/2021 19:34:15'!
initializeXxxx: aBookCatalog 

	bookCatalog := aBookCatalog.
	books := OrderedCollection new.!
!Cart class methodsFor: 'instance creation' stamp: 'ET 6/9/2021 19:34:45'!
withCatalog: aBookCatalog 
	
	^self new initializeWithCatalog: aBookCatalog.! !
!CarritoTest methodsFor: 'as yet unclassified' stamp: 'ET 6/9/2021 19:34:45' prior: 51031773!
emptyCart
	
	^Cart withCatalog: catalogue.! !

!methodRemoval: Cart class #xxxx: stamp: 'ET 6/9/2021 19:34:45'!
xxxx: aBookCatalog 
	
	^self new initializeWithCatalog: aBookCatalog.!

!methodRemoval: Cart #initialize stamp: 'ET 6/9/2021 19:35:51'!
initialize

	books := OrderedCollection new.!
!CarritoTest methodsFor: 'tests' stamp: 'ET 6/9/2021 19:37:57'!
test01NewCartIsEmpty

	|cart|
	
	cart := self emptyCart.
	
	self assert: cart isEmpty.! !

!methodRemoval: CarritoTest #test01NewCartisEmpty stamp: 'ET 6/9/2021 19:37:57'!
test01NewCartisEmpty

	|cart|
	
	cart := self emptyCart.
	
	self assert: cart isEmpty.!
!CarritoTest methodsFor: 'tests' stamp: 'ET 6/9/2021 19:38:21'!
test02NewCartIsAddedABookAndItHasThatBook

	|cart book |
	
	book := Book new.
	catalogue addBook: book.
	cart := self emptyCart.
	
	cart addBook: book.
	
	self deny: cart isEmpty.
	self assert: (cart hasBook: book).! !

!methodRemoval: CarritoTest #test02NewCartIsAddedABookAndItsListHasThatBook stamp: 'ET 6/9/2021 19:38:21'!
test02NewCartIsAddedABookAndItsListHasThatBook

	|cart book |
	
	book := Book new.
	catalogue addBook: book.
	cart := self emptyCart.
	
	cart addBook: book.
	
	self deny: cart isEmpty.
	self assert: (cart hasBook: book).!

----SNAPSHOT----(9 June 2021 19:42:05) CuisUniversity-4532.image priorSource: 22378975!

----STARTUP---- (10 June 2021 17:24:02) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!


!classRemoval: #Cart stamp: 'ET 6/10/2021 18:22:26'!
Object subclass: #Cart
	instanceVariableNames: 'books bookCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #BookCatalog stamp: 'ET 6/10/2021 18:22:26'!
Object subclass: #BookCatalog
	instanceVariableNames: 'books'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Book stamp: 'ET 6/10/2021 18:22:26'!
Object subclass: #Book
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CarritoTest stamp: 'ET 6/10/2021 18:22:27'!
TestCase subclass: #CarritoTest
	instanceVariableNames: 'catalogue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of C:\Users\ezequ\Desktop\windows64\TusLibros.st----!

----SNAPSHOT----(10 June 2021 18:22:47) CuisUniversity-4532.image priorSource: 22414116!
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/10/2021 19:31:19'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/10/2021 19:31:19'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/10/2021 19:31:19'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/10/2021 19:31:19'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/10/2021 19:31:19'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/10/2021 19:31:19'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/10/2021 19:31:19'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/10/2021 19:31:19'!
PASSED!

TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'ET 6/10/2021 19:39:46'!
TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CashierTest methodsFor: 'no messages' stamp: 'ET 6/10/2021 19:40:58'!
test01

	|cart catalog|
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.! !

!classDefinition: #Cashier category: 'TusLibros' stamp: 'ET 6/10/2021 19:45:25'!
Object subclass: #Cashier
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 19:45:18' prior: 51032447!
test01

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 19:46:31' prior: 51032460!
test01

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart]
	 raise: Error
	 withExceptionDo: [].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 19:47:35' prior: 51032470!
test01

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. ]! !

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 19:47:53'!
ERROR!
!Cashier class methodsFor: 'instance creation' stamp: 'ET 6/10/2021 19:48:01'!
with: aDictionary 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWith: aDictionary ! !
!Cashier class methodsFor: 'instance creation' stamp: 'ET 6/10/2021 19:48:18' prior: 51032498!
with: aPriceList 
	^self new initializeWith: aPriceList! !

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 19:48:20'!
ERROR!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'ET 6/10/2021 19:48:29'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 19:48:29'!
initializeWith: aPriceList 
	self shouldBeImplemented.
	priceList := aPriceList.! !
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 19:48:32' prior: 51032519!
initializeWith: aPriceList 

	priceList := aPriceList.! !

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 19:48:34'!
ERROR!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 19:48:52'!
CanNotCheckoutEmptyCart
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 19:49:19' prior: 51032532!
CanNotCheckoutEmptyCart
	^'The cart is empty'.! !

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 19:49:20'!
FAILURE!
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 19:50:50'!
checkout: aCart

	self error: self class CanNotCheckoutEmptyCart.! !

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 19:50:56'!
PASSED!

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 19:50:56'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 19:53:10'!
test02

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	
	cart add: 'book'.
	catalog add: 'book'.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. ]! !

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 19:53:13'!
ERROR!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 19:53:24' prior: 51032554!
test02

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. ]! !

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 19:53:31'!
ERROR!

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 19:53:37'!
ERROR!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 19:53:46'!
AnItemIsNotInThePriceList
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 19:54:00' prior: 51032592!
AnItemIsNotInThePriceList
	^'An item in the cart is not in the price list'.! !

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 19:54:03'!
FAILURE!
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 19:55:09' prior: 51032544!
checkout: aCart

	aCart isEmpty ifTrue: [	self error: self class CanNotCheckoutEmptyCart] 
	ifFalse: [self error: self class AnItemIsNotInThePriceList ].! !

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 19:55:13'!
PASSED!

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 19:55:13'!
PASSED!

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 19:55:13'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 19:58:09'!
test03

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 1 equals:  (cashier checkout: cart).! !

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 19:58:13'!
ERROR!
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:08:33' prior: 51032605!
checkout: aCart
	|totalPrice|
	aCart isEmpty ifTrue: [	self error: self class CanNotCheckoutEmptyCart].
	totalPrice := 0.
	[aCart do: [:anElement | totalPrice := priceList includesKey: anElement + totalPrice]]
	on: Error
	do: [:anError | 
		self halt.
		self error: self class AnItemIsNotInThePriceList ].! !
!Cart methodsFor: 'adding' stamp: 'ET 6/10/2021 20:09:25'!
do: aBlockClosure

	items do: aBlockClosure.! !
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:10:10' prior: 51032636!
checkout: aCart
	|totalPrice|
	aCart isEmpty ifTrue: [	self error: self class CanNotCheckoutEmptyCart].
	totalPrice := 0.
	[aCart do: [:anElement | totalPrice := totalPrice + priceList includesKey: anElement ]]
	on: Error
	do: [:anError | 
		self halt.
		self error: self class AnItemIsNotInThePriceList ].! !

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:10:12'!
FAILURE!

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:10:19'!
FAILURE!
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:10:57' prior: 51032653!
checkout: aCart
	|totalPrice|
	aCart isEmpty ifTrue: [	self error: self class CanNotCheckoutEmptyCart].
	totalPrice := 0.
	[aCart do: [:anElement | totalPrice := totalPrice + priceList includesKey: anElement ]]
	on: Error
	do: [:anError | 
		self halt.
		self error: self class AnItemIsNotInThePriceList ].
	
	^totalPrice.! !

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:11:00'!
FAILURE!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:11:34' prior: 51032572!
test02

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. ]! !

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 20:11:35'!
FAILURE!
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:13:49' prior: 51032670!
checkout: aCart
	|totalPrice|
	aCart isEmpty ifTrue: [	self error: self class CanNotCheckoutEmptyCart].
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self error: self class AnItemIsNotInThePriceList ].].
	
	^totalPrice.! !

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 20:13:51'!
PASSED!

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 20:13:51'!
PASSED!

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 20:13:51'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:13:51'!
PASSED!
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:14:38'!
assertCartIsNotEmpty: aCart

	^ aCart isEmpty ifTrue: [	self error: self class CanNotCheckoutEmptyCart]! !
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:14:38' prior: 51032704!
checkout: aCart
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self error: self class AnItemIsNotInThePriceList ].].
	
	^totalPrice.! !
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:14:57'!
itemNotInPriceListError

	^ self error: self class AnItemIsNotInThePriceList! !
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:14:57' prior: 51032731!
checkout: aCart
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self itemNotInPriceListError ].].
	
	^totalPrice.! !
!Cashier methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:15:01' prior: 51032747!
checkout: aCart
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self itemNotInPriceListError].].
	
	^totalPrice.! !

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:15:04'!
PASSED!

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 20:15:04'!
PASSED!

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 20:15:04'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:15:04'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:15:26' prior: 51032620!
test03

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 1 equals:  (cashier checkout: cart).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:17:04' prior: 51032776!
test03

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 2 equals:  (cashier checkout: cart).! !

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:17:05'!
PASSED!

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 20:17:05'!
PASSED!

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 20:17:05'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:17:05'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:15:26' prior: 51032790!
test03

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 1 equals:  (cashier checkout: cart).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:17:20' prior: 51032813!
test03

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 1 equals:  (cashier checkout: cart).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:17:22'!
test04

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 1 equals:  (cashier checkout: cart).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:17:29' prior: 51032840!
test04

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 2 equals:  (cashier checkout: cart).! !

!testRun: #CashierTest #test04 stamp: 'ET 6/10/2021 20:17:31'!
PASSED!

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 20:17:31'!
PASSED!

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 20:17:31'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:17:31'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'ET 6/10/2021 20:17:31'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'ET 6/10/2021 20:17:42'!
PASSED!

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 20:17:42'!
PASSED!

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 20:17:42'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:17:42'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'ET 6/10/2021 20:17:42'!
PASSED!

2021 / 01!

2021 \ 01!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'ET 6/10/2021 20:29:28'!
Object subclass: #CreditCard
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:29:22'!
test05

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next.

	
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: creditCard).! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:31:08'!
ERROR!
!CreditCard class methodsFor: 'instance creation' stamp: 'ET 6/10/2021 20:31:15'!
owner: aString number: aString2 expiration: aGregorianMonthOfYear 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeOwner: aString number: aString2 expiration: aGregorianMonthOfYear ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'ET 6/10/2021 20:32:05' prior: 51032919!
owner: anOwnerString number: aCreditCardNumber expiration: aGregorianMonthOfYear 
	
	^self new initializeOwner: anOwnerString number: aCreditCardNumber expiration: aGregorianMonthOfYear ! !
!CreditCard class methodsFor: 'instance creation' stamp: 'ET 6/10/2021 20:32:45' prior: 51032930!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear 
	self assertCreditCardNumberIsValid: aCreditCardNumberString.
	^self new initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear ! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:32:50'!
ERROR!
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:32:58'!
assertCreditCardNumberIsValid: aString 
	self shouldBeImplemented.! !
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:33:37' prior: 51032953!
assertCreditCardNumberIsValid: aString 
	
	aString size = 16 ifFalse: [self error: self creditCardIsInvalid]! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:33:41'!
ERROR!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'ET 6/10/2021 20:33:52'!
Object subclass: #CreditCard
	instanceVariableNames: 'ownerString'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'ET 6/10/2021 20:33:53'!
Object subclass: #CreditCard
	instanceVariableNames: 'ownerString creditCardNumberString'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'ET 6/10/2021 20:33:53'!
Object subclass: #CreditCard
	instanceVariableNames: 'ownerString creditCardNumberString gregorianMonthOfYear'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:33:53'!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear 
	self shouldBeImplemented.
	ownerString := anOwnerString.
	creditCardNumberString := aCreditCardNumberString.
	gregorianMonthOfYear := aGregorianMonthOfYear.! !
!CreditCard methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:34:00' prior: 51032990!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear 

	ownerString := anOwnerString.
	creditCardNumberString := aCreditCardNumberString.
	gregorianMonthOfYear := aGregorianMonthOfYear.! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:34:02'!
ERROR!
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:34:09'!
checkout: aCart withCreditCard: aCreditCard 
	self shouldBeImplemented.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:34:25' prior: 51033013!
checkout: aCart withCreditCard: aCreditCard 
	^1.! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:34:27'!
FAILURE!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:34:36' prior: 51032898!
test05

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next.

	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: creditCard).! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:34:38'!
PASSED!

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 20:34:38'!
PASSED!

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 20:34:38'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:34:38'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'ET 6/10/2021 20:34:38'!
PASSED!

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:34:38'!
PASSED!

!methodRemoval: Cashier #checkout:withCreditCard: stamp: 'ET 6/10/2021 20:37:02'!
checkout: aCart withCreditCard: aCreditCard 
	^1.!
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:38:13'!
checkout: aCart withCreditCard: aCreditCard 
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self itemNotInPriceListError].].
	
	^totalPrice.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:38:13' prior: 51032854!
test04

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: withCreditCard).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:38:13' prior: 51032827!
test03

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: withCreditCard).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:38:13' prior: 51032482!
test01

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart withCreditCard: withCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. ]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:38:13' prior: 51032686!
test02

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart withCreditCard: withCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. ]! !

!methodRemoval: Cashier #checkout: stamp: 'ET 6/10/2021 20:38:13'!
checkout: aCart
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self itemNotInPriceListError].].
	
	^totalPrice.!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:38:58'!
validCreditCard

	^ CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:38:58' prior: 51033026!
test05

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := self validCreditCard.

	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: creditCard).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:39:17' prior: 51033073!
test04

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:39:23' prior: 51033088!
test03

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:39:30' prior: 51033119!
test02

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. ]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:39:31' prior: 51033197!
test02

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. ]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:39:38' prior: 51033103!
test01

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. ]! !

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 20:39:39'!
PASSED!

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 20:39:39'!
PASSED!

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 20:39:39'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:39:39'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'ET 6/10/2021 20:39:39'!
PASSED!

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:39:39'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:40:39'!
invalidCreditCard

	^ CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current previous.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:40:54'!
expiredCreditCard

	^ CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current previous.! !

!methodRemoval: CashierTest #invalidCreditCard stamp: 'ET 6/10/2021 20:40:59'!
invalidCreditCard

	^ CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current previous.!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:41:26' prior: 51033151!
test05

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := self validCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [] .! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:42:06' prior: 51033281!
test05

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := self validCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError ]	.
		
		
		! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:42:12'!
FAILURE!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:42:40' prior: 51033298!
test05

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError ]	.
		
		
		! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:42:46'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:43:17' prior: 51033062!
checkout: aCart withCreditCard: aCreditCard 
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	self assertCreditCardIsValid: aCreditCard.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self itemNotInPriceListError].].
	
	^totalPrice.! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:43:26'!
ERROR!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:43:33'!
ExpiredCreditCardError
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:43:48' prior: 51033356!
ExpiredCreditCardError
	^'The credit card is expired'.! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:43:49'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:45:42'!
assertCreditCardIsValid: aCreditCard
	
	aCreditCard expirationDate < GregorianMonthOfYear current ifTrue: [self error: self class ExpiredCreditCardError].! !
!CreditCard methodsFor: 'initialization' stamp: 'ET 6/10/2021 20:46:08'!
expirationDate

	^gregorianMonthOfYear! !

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:46:14'!
PASSED!

!testRun: #CashierTest #test01 stamp: 'ET 6/10/2021 20:46:14'!
PASSED!

!testRun: #CashierTest #test02 stamp: 'ET 6/10/2021 20:46:14'!
PASSED!

!testRun: #CashierTest #test03 stamp: 'ET 6/10/2021 20:46:14'!
PASSED!

!testRun: #CashierTest #test04 stamp: 'ET 6/10/2021 20:46:14'!
PASSED!

!testRun: #CashierTest #test05 stamp: 'ET 6/10/2021 20:46:14'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:49:28' prior: 51033320!
test05

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError ]	.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:50:24'!
test01CanNotCheckoutEmptyCart

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. ]! !

!methodRemoval: CashierTest #test01 stamp: 'ET 6/10/2021 20:50:24'!
test01

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. ]!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:51:03'!
test02CanNotCheckoutCartWithNonPricedItem

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. ]! !

!methodRemoval: CashierTest #test02 stamp: 'ET 6/10/2021 20:51:03'!
test02

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	priceList := Dictionary new.
	
	cashier := Cashier with: priceList.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. ]!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:51:53'!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).! !

!methodRemoval: CashierTest #test03 stamp: 'ET 6/10/2021 20:51:53'!
test03

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:52:25'!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).! !

!methodRemoval: CashierTest #test04 stamp: 'ET 6/10/2021 20:52:25'!
test04

	|cart catalog cashier priceList |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/10/2021 20:52:47'!
test05CanNotCheckoutWithExpiratedCreditCard

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError ]	.
		
		
		! !

!methodRemoval: CashierTest #test05 stamp: 'ET 6/10/2021 20:52:47'!
test05

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError ]	.
		
		
		!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/14/2021 17:06:54'!
test05CanNotCheckoutWithExpiredCreditCard

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError ]	.
		
		
		! !

!methodRemoval: CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/14/2021 17:06:54'!
test05CanNotCheckoutWithExpiratedCreditCard

	|cart catalog cashier priceList creditCard |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	cashier := Cashier with: priceList.
	
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError ]	.
		
		
		!

014!

014!

----STARTUP---- (14 June 2021 18:38:42) as /home/julian/facu/ingenieria1/ambientesCuis/TusLibros1/CuisUniversity-4532.image!


----End fileIn of /home/julian/facu/ingenieria1/ejsIS1/20-TusLibros/TusLibros.st----!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:41:24'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:41:24'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 18:44:57' prior: 50859653!
test01CanNotCheckoutEmptyCart

	|cart catalog cashier priceList aSalesBook |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. 
			self assert: aSalesBook isEmpty.]! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:45:05'!
ERROR!
!Cashier class methodsFor: 'instance creation' stamp: 'JA 6/14/2021 18:45:25'!
with: aDictionary registerSalesOn: anOrderedCollection 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWith: aDictionary registerSalesOn: anOrderedCollection ! !
!Cashier class methodsFor: 'instance creation' stamp: 'JA 6/14/2021 18:46:32' prior: 50860025!
with: aPriceList registerSalesOn: aSalesBook 
	
	^self new initializeWith: aPriceList registerSalesOn: aSalesBook! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:46:37'!
ERROR!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'JA 6/14/2021 18:46:54'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList salesBook'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'initialization' stamp: 'JA 6/14/2021 18:46:54'!
initializeWith: aPriceList registerSalesOn: aSalesBook 
	self shouldBeImplemented.
	priceList := aPriceList.
	salesBook := aSalesBook.! !
!Cashier methodsFor: 'initialization' stamp: 'JA 6/14/2021 18:47:05' prior: 50860052!
initializeWith: aPriceList registerSalesOn: aSalesBook 	
	priceList := aPriceList.
	salesBook := aSalesBook.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:47:06'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:47:06'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 18:47:06'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:47:06'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:47:06'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:47:06'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:47:29'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:47:29'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 18:47:29'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:47:29'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:47:29'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:47:29'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 18:50:22' prior: 50859669!
test02CanNotCheckoutCartWithNonPricedItem

	|cart catalog cashier priceList aSalesBook |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. 
			self assert: aSalesBook isEmpty]! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 18:50:25'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:50:25'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 18:50:25'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:50:25'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:50:25'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:50:25'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 18:52:29' prior: 50859687!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart catalog cashier priceList aSalesBook |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook.
	
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 1 equals: aSalesBook first.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:52:32'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 18:53:33' prior: 50859857!
checkout: aCart withCreditCard: aCreditCard 
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	self assertCreditCardIsValid: aCreditCard.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self itemNotInPriceListError].].
	salesBook add: totalPrice .
	^totalPrice.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:53:34'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:53:34'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 18:53:34'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:53:34'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:53:34'!
ERROR!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:53:34'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:53:34'!
ERROR!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:54:11'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 18:55:18' prior: 50859703!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart catalog cashier priceList aSalesBook |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook.
		
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 2 equals: aSalesBook first.! !

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:55:22'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:55:22'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 18:55:22'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:55:22'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:55:22'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:55:22'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:55:33'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:55:33'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 18:55:33'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:55:33'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:55:33'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:55:33'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 18:56:06' prior: 50859720!
test05CanNotCheckoutWithExpiratedCreditCard

	|cart catalog cashier priceList creditCard aSalesBook |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook.
		
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:56:09'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:56:09'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 18:56:09'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:56:09'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:56:09'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:56:09'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 18:56:15'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 18:56:15'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 18:58:19'!
test06

	|cart catalog cashier priceList creditCard aSalesBook |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook.
		
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:01:39' prior: 50860371!
test06

	|cart catalog cashier priceList creditCard aSalesBook |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CreditCardWithotCreditError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:01:45'!
FAILURE!

!classDefinition: #MerchantProcessorSimulator category: 'TusLibros' stamp: 'JA 6/14/2021 19:05:11'!
Object subclass: #MerchantProcessorSimulator
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:05:02' prior: 50860394!
test06

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CreditCardWithotCreditError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:05:19'!
ERROR!
!Cashier class methodsFor: 'instance creation' stamp: 'JA 6/14/2021 19:05:29'!
with: aDictionary registerSalesOn: anOrderedCollection merchantProcessor: aMerchantProcessorSimulator 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWith: aDictionary registerSalesOn: anOrderedCollection merchantProcessor: aMerchantProcessorSimulator ! !
!Cashier class methodsFor: 'instance creation' stamp: 'JA 6/14/2021 19:06:11' prior: 50860457!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator 
	^self new initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator ! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:06:12'!
ERROR!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'JA 6/14/2021 19:06:22'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList salesBook merchantProcessorSimulator'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'initialization' stamp: 'JA 6/14/2021 19:06:22'!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator 
	self shouldBeImplemented.
	priceList := aPriceList.
	salesBook := aSalesBook.
	merchantProcessorSimulator := aMerchantProcessorSimulator.! !
!Cashier methodsFor: 'initialization' stamp: 'JA 6/14/2021 19:06:29' prior: 50860490!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator 
	
	priceList := aPriceList.
	salesBook := aSalesBook.
	merchantProcessorSimulator := aMerchantProcessorSimulator.! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:06:32'!
FAILURE!
!Cashier methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:08:26' prior: 50860175!
checkout: aCart withCreditCard: aCreditCard 
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	self assertCreditCardIsValid: aCreditCard.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self itemNotInPriceListError].].
	merchantProcessorSimulator charge: totalPrice  on: aCreditCard .
	salesBook add: totalPrice .
	^totalPrice.! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:08:41'!
ERROR!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:08:51'!
charge: aSmallInteger on: aCreditCard 
	self shouldBeImplemented.! !
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:10:49' prior: 50860531!
charge: aCharge on: aCreditCard 
	self error: Cashier CreditCardWithoutCredit.! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:10:54'!
ERROR!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:11:08'!
CreditCardWithoutCredit
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:11:45' prior: 50860545!
CreditCardWithoutCredit
	^ 'La tarjeta no tiene suficiente cr�dito.'! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:11:47'!
ERROR!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:12:32' prior: 50860428!
test06

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CreditCardWithoutCreditError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:13:08'!
CreditCardWithoutCreditError
	^ 'La tarjeta no tiene suficiente cr�dito.'! !

!methodRemoval: Cashier class #CreditCardWithoutCredit stamp: 'JA 6/14/2021 19:13:08'!
CreditCardWithoutCredit
	^ 'La tarjeta no tiene suficiente cr�dito.'!

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:13:22'!
ERROR!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:13:45' prior: 50860537!
charge: aCharge on: aCreditCard 
	self error: Cashier CreditCardWithoutCreditError.! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:13:54'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 19:13:54'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 19:13:54'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 19:13:54'!
ERROR!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 19:13:54'!
ERROR!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 19:13:54'!
PASSED!

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:13:54'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 19:14:33'!
ERROR!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:15:17' prior: 50860002!
test01CanNotCheckoutEmptyCart

	|cart catalog cashier priceList aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. 
			self assert: aSalesBook isEmpty.]! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 19:15:22'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 19:15:22'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 19:15:22'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 19:15:22'!
ERROR!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 19:15:22'!
ERROR!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 19:15:22'!
PASSED!

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:15:22'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:15:34' prior: 50860107!
test02CanNotCheckoutCartWithNonPricedItem

	|cart catalog cashier priceList aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. 
			self assert: aSalesBook isEmpty]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:15:47' prior: 50860150!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart catalog cashier priceList aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.	
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 1 equals: aSalesBook first.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:16:03' prior: 50860218!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart catalog cashier priceList aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.		
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.		
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 2 equals: aSalesBook first.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:16:14' prior: 50860283!
test05CanNotCheckoutWithExpiratedCreditCard

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:19:34' prior: 50860558!
test06

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier CreditCardWithoutCreditError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CreditCardWithoutCreditError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:19:43'!
ERROR!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:19:51'!
raiseErrorOnCharge: aString 
	self shouldBeImplemented.! !

!classDefinition: #MerchantProcessorSimulator category: 'TusLibros' stamp: 'JA 6/14/2021 19:20:22'!
Object subclass: #MerchantProcessorSimulator
	instanceVariableNames: 'messageError'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:20:19' prior: 50860812!
raiseErrorOnCharge: aMessageError 
	messageError := aMessageError.! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:20:24'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 19:20:24'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 19:20:24'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 19:20:24'!
ERROR!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 19:20:24'!
ERROR!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 19:20:24'!
PASSED!

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:20:24'!
PASSED!
!MerchantProcessorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:21:11' prior: 50860598!
charge: aCharge on: aCreditCard 
	messageError ifNotNil: [	self error: messageError].! !

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:21:19'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 19:21:19'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 19:21:19'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 19:21:19'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 19:21:19'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 19:21:19'!
PASSED!

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:21:19'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:30:06'!
test07

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier StolenCreditCardError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier StolenCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test07 stamp: 'JA 6/14/2021 19:30:10'!
ERROR!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:30:26'!
StolenCreditCardError
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:31:11' prior: 50860913!
StolenCreditCardError
 	^ 'La tarjeta de cr�dito es robada'! !

!testRun: #CashierTest #test07 stamp: 'JA 6/14/2021 19:31:13'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 19:31:13'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 19:31:13'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 19:31:13'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 19:31:13'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 19:31:13'!
PASSED!

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:31:13'!
PASSED!

!testRun: #CashierTest #test07 stamp: 'JA 6/14/2021 19:31:13'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:31:41'!
test08

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier FakeCreditCardError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier FakeCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test08 stamp: 'JA 6/14/2021 19:31:48'!
ERROR!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:31:56'!
FakeCreditCardError
	self shouldBeImplemented.! !
!Cashier class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:32:16' prior: 50860978!
FakeCreditCardError
	^'La tarjeta de cr�dito es falsa'! !

!testRun: #CashierTest #test08 stamp: 'JA 6/14/2021 19:32:17'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 19:32:17'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 19:32:17'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 19:32:17'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 19:32:17'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 19:32:17'!
PASSED!

!testRun: #CashierTest #test06 stamp: 'JA 6/14/2021 19:32:17'!
PASSED!

!testRun: #CashierTest #test07 stamp: 'JA 6/14/2021 19:32:17'!
PASSED!

!testRun: #CashierTest #test08 stamp: 'JA 6/14/2021 19:32:17'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:34:50'!
test06CanNotCheckoutWithACreditCardWithoutCredit

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier CreditCardWithoutCreditError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CreditCardWithoutCreditError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!methodRemoval: CashierTest #test06 stamp: 'JA 6/14/2021 19:34:50'!
test06

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier CreditCardWithoutCreditError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CreditCardWithoutCreditError.
			self assert: aSalesBook isEmpty ]	.
		
		
		!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:35:28'!
test07CanNotCheckoutWithAStolenCreditCard

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier StolenCreditCardError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier StolenCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!methodRemoval: CashierTest #test07 stamp: 'JA 6/14/2021 19:35:28'!
test07

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier StolenCreditCardError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier StolenCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:35:59'!
test08CanNotCheckoutWithAFakeCreditCard

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier FakeCreditCardError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier FakeCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!methodRemoval: CashierTest #test08 stamp: 'JA 6/14/2021 19:35:59'!
test08

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier FakeCreditCardError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier FakeCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		!

!testRun: #CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'JA 6/14/2021 19:36:06'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 19:36:06'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 19:36:06'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 19:36:06'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 19:36:06'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 19:36:06'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutWithACreditCardWithoutCredit stamp: 'JA 6/14/2021 19:36:06'!
PASSED!

!testRun: #CashierTest #test07CanNotCheckoutWithAStolenCreditCard stamp: 'JA 6/14/2021 19:36:06'!
PASSED!

!testRun: #CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'JA 6/14/2021 19:36:06'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutWithACreditCardWithoutCredit stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CashierTest #test07CanNotCheckoutWithAStolenCreditCard stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

!testRun: #CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'JA 6/14/2021 19:36:10'!
PASSED!

TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CreditCardTest category: 'TusLibros' stamp: 'JA 6/14/2021 19:40:39'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCardTest methodsFor: 'no messages' stamp: 'JA 6/14/2021 19:44:26'!
test01
	self should: [ CreditCard owner: 'Juan' number: '1234' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard  	] ! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:46:55' prior: 50861286!
test01
	self should: [ CreditCard owner: 'Juan' number: '1234' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] ! !

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 19:47:00'!
ERROR!
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:47:11'!
InvalidCreditCardError
	self shouldBeImplemented.! !
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:47:59' prior: 50861308!
InvalidCreditCardError
	^'Los datos de la tarjeta de cr�dito son inv�lidos'! !

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 19:48:01'!
FAILURE!

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 19:48:32'!
FAILURE!
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:49:05' prior: 50859949!
assertCreditCardNumberIsValid: aString 
	
	aString size = 16 ifFalse: [self error: self InvalidCreditCardError ]! !

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 19:49:10'!
PASSED!

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 19:49:10'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:50:52'!
test02
	self should: [ CreditCard owner: 'Juan' number: '1234567890ABCDEF' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] ! !

!testRun: #CreditCardTest #test02 stamp: 'JA 6/14/2021 19:50:53'!
FAILURE!

!testRun: #CreditCardTest #test02 stamp: 'JA 6/14/2021 19:51:32'!
FAILURE!
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:56:53' prior: 50861324!
assertCreditCardNumberIsValid: aString 
	
	aString size = 16 ifFalse: [self error: self InvalidCreditCardError ].
	(aString allSatisfy: [:aDigit | aDigit isDigit]	) ifFalse: [self error: self InvalidCreditCardError ].! !

!testRun: #CreditCardTest #test02 stamp: 'JA 6/14/2021 19:56:54'!
PASSED!

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 19:56:54'!
PASSED!

!testRun: #CreditCardTest #test02 stamp: 'JA 6/14/2021 19:56:54'!
PASSED!

!testRun: #CreditCardTest #test02 stamp: 'JA 6/14/2021 19:56:57'!
PASSED!

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 19:56:57'!
PASSED!

!testRun: #CreditCardTest #test02 stamp: 'JA 6/14/2021 19:56:57'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 19:57:43'!
test03
	self should: [ CreditCard owner: '    ' number: '1234567890123456' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] ! !

!testRun: #CreditCardTest #test03 stamp: 'JA 6/14/2021 19:57:44'!
FAILURE!
!CreditCard class methodsFor: 'instance creation' stamp: 'JA 6/14/2021 19:58:44' prior: 50859938!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear 
	self assertCreditCardNumberIsValid: aCreditCardNumberString.
	self assertNonBlankOwner.
	^self new initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear ! !

!testRun: #CreditCardTest #test03 stamp: 'JA 6/14/2021 19:58:48'!
FAILURE!
!CreditCard class methodsFor: 'instance creation' stamp: 'JA 6/14/2021 19:59:51' prior: 50861389!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear 
	self assertCreditCardNumberIsValid: aCreditCardNumberString.
	self assertNonBlankOwner: anOwnerString.
	^self new initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear ! !

!testRun: #CreditCardTest #test03 stamp: 'JA 6/14/2021 19:59:54'!
FAILURE!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 20:00:22' prior: 50861375!
test03
	self should: [ CreditCard owner: '    ' number: '1234567890123456' expiration: GregorianMonthOfYear current.]
	 	raise:  Error - MessageNotUnderstood 
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] ! !

!testRun: #CreditCardTest #test03 stamp: 'JA 6/14/2021 20:00:23'!
ERROR!
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 20:00:37'!
assertNonBlankOwner: aString 
	self shouldBeImplemented.! !
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 20:53:24' prior: 50861433!
assertNonBlankOwner: anOwnerString
	anOwnerString withBlanksTrimmed isEmpty
	
	! !

!testRun: #CreditCardTest #test03 stamp: 'JA 6/14/2021 20:53:25'!
FAILURE!

'   ' withBlanksTrimmed !

'   ' withBlanksTrimmed  isEmpty!
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 20:57:02' prior: 50861438!
assertNonBlankOwner: anOwnerString
	anOwnerString withBlanksTrimmed isEmpty ifTrue: [self error: self InvalidCreditCardError ]
	
	! !

!testRun: #CreditCardTest #test03 stamp: 'JA 6/14/2021 20:57:21'!
PASSED!

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 20:57:21'!
PASSED!

!testRun: #CreditCardTest #test02 stamp: 'JA 6/14/2021 20:57:21'!
PASSED!

!testRun: #CreditCardTest #test03 stamp: 'JA 6/14/2021 20:57:21'!
PASSED!
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/14/2021 20:59:34'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/14/2021 20:59:34'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/14/2021 20:59:34'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/14/2021 20:59:34'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/14/2021 20:59:34'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/14/2021 20:59:34'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/14/2021 20:59:34'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/14/2021 20:59:34'!
PASSED!
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator
	^ [
	([
	(self coverAll:
		{96 to: 99}) new ] valueCoveringAll:
		{101 to: 103})
		initializeWith:
			(aPriceList
				cover: (121 to: 130)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (149 to: 158)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessorSimulator
				cover: (179 to: 205)
				declaredAt: (65 to: 91)) ] valueCoveringAll:
		{105 to: 119. 132 to: 147. 160 to: 177}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator
	(priceList _ aPriceList
		cover: (120 to: 129)
		declaredAt: (17 to: 26))
		cover: (107 to: 115)
		declaredAt: (107 to: 115).
	(salesBook _ aSalesBook
		cover: (146 to: 155)
		declaredAt: (45 to: 54))
		cover: (133 to: 141)
		declaredAt: (133 to: 141).
	(merchantProcessorSimulator _ aMerchantProcessorSimulator
		cover: (189 to: 215)
		declaredAt: (75 to: 101))
		cover: (159 to: 184)
		declaredAt: (159 to: 184).! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) InvalidCreditCardError ] valueCoveringAll:
				{89 to: 110}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (117 to: 123)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (148 to: 153)
			declaredAt: (139 to: 144)) isDigit ] valueCoveringAll:
			{155 to: 161} ]] valueCoveringAll:
		{125 to: 135}) ifFalse: [
		[
		(self coverAll:
			{176 to: 179}) error:
			([
			(self coverAll:
				{188 to: 191}) InvalidCreditCardError ] valueCoveringAll:
				{193 to: 214}) ] valueCoveringAll:
			{181 to: 186} ]] valueCoveringAll:
		{166 to: 173}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) InvalidCreditCardError ] valueCoveringAll:
				{103 to: 124}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(gregorianMonthOfYear _ aGregorianMonthOfYear
		cover: (208 to: 228)
		declaredAt: (76 to: 96))
		cover: (184 to: 203)
		declaredAt: (184 to: 203).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice |
	[
	(self coverAll:
		{61 to: 64}) assertCartIsNotEmpty:
		(aCart
			cover: (88 to: 92)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{66 to: 86}.
	[
	(self coverAll:
		{96 to: 99}) assertCreditCardIsValid:
		(aCreditCard
			cover: (126 to: 136)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{101 to: 124}.
	(totalPrice _ 0 coverAll:
		{154 to: 154})
		cover: (140 to: 149)
		declaredAt: (48 to: 57).
	[
	(aCart
		cover: (158 to: 162)
		declaredAt: (11 to: 15)) do: [ :anElement |
		(totalPrice _ [
		([
		(totalPrice
			cover: (182 to: 191)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (209 to: 217)
				declaredAt: (209 to: 217)) ] valueCoveringAll:
			{207 to: 207})
			at:
				(anElement
					cover: (223 to: 231)
					declaredAt: (170 to: 178))
			ifAbsent: [
				[
				(self coverAll:
					{244 to: 247}) itemNotInPriceListError ] valueCoveringAll:
					{249 to: 271} ]] valueCoveringAll:
			{219 to: 221. 233 to: 241})
			cover: (196 to: 205)
			declaredAt: (48 to: 57) ]] valueCoveringAll:
		{164 to: 166}.
	[
	(merchantProcessorSimulator
		cover: (278 to: 303)
		declaredAt: (278 to: 303))
		charge:
			(totalPrice
				cover: (313 to: 322)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (329 to: 339)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{305 to: 311. 325 to: 327}.
	[
	(salesBook
		cover: (344 to: 352)
		declaredAt: (344 to: 352)) add:
		(totalPrice
			cover: (359 to: 368)
			declaredAt: (48 to: 57)) ] valueCoveringAll:
		{354 to: 357}.
	^ totalPrice
		cover: (374 to: 383)
		declaredAt: (48 to: 57).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) CanNotCheckoutEmptyCart ] valueCoveringAll:
				{80 to: 102}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
CanNotCheckoutEmptyCart
	^ 'The cart is empty' coverAll:
		{27 to: 45}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 20:59:34'!
PASSED!
!Behavior method!
assertCreditCardIsValid: aCreditCard
	[
	([
	([
	(aCreditCard
		cover: (41 to: 51)
		declaredAt: (26 to: 36)) expirationDate ] valueCoveringAll:
		{53 to: 66}) <
		([
		(GregorianMonthOfYear
			cover: (70 to: 89)
			declaredAt: (70 to: 89)) current ] valueCoveringAll:
			{91 to: 97}) ] valueCoveringAll:
		{68 to: 68}) ifTrue: [
		[
		(self coverAll:
			{108 to: 111}) error:
			([
			([
			(self coverAll:
				{120 to: 123}) class ] valueCoveringAll:
				{125 to: 129}) ExpiredCreditCardError ] valueCoveringAll:
				{131 to: 152}) ] valueCoveringAll:
			{113 to: 118} ]] valueCoveringAll:
		{99 to: 105}.! !
!Behavior method!
expirationDate
	^ gregorianMonthOfYear
		cover: (19 to: 38)
		declaredAt: (19 to: 38).! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
itemNotInPriceListError
	^ [
	(self coverAll:
		{29 to: 32}) error:
		([
		([
		(self coverAll:
			{41 to: 44}) class ] valueCoveringAll:
			{46 to: 50}) AnItemIsNotInThePriceList ] valueCoveringAll:
			{52 to: 76}) ] valueCoveringAll:
		{34 to: 39}.! !
!Behavior method!
AnItemIsNotInThePriceList
	^ 'An item in the cart is not in the price list' coverAll:
		{29 to: 74}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 20:59:34'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 20:59:34'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 20:59:35'!
PASSED!
!Behavior method!
ExpiredCreditCardError
	^ 'The credit card is expired' coverAll:
		{26 to: 53}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 20:59:35'!
PASSED!
!Behavior method!
CreditCardWithoutCreditError
	^ 'La tarjeta no tiene suficiente cr�dito.' coverAll:
		{33 to: 73}.! !
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutWithACreditCardWithoutCredit stamp: 'JA 6/14/2021 20:59:35'!
PASSED!
!Behavior method!
StolenCreditCardError
	^ 'La tarjeta de cr�dito es robada' coverAll:
		{27 to: 59}.! !

!testRun: #CashierTest #test07CanNotCheckoutWithAStolenCreditCard stamp: 'JA 6/14/2021 20:59:35'!
PASSED!
!Behavior method!
FakeCreditCardError
	^ 'La tarjeta de cr�dito es falsa' coverAll:
		{23 to: 54}.! !

!testRun: #CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'JA 6/14/2021 20:59:35'!
PASSED!
!Behavior method!
InvalidCreditCardError
	^ 'Los datos de la tarjeta de cr�dito son inv�lidos' coverAll:
		{26 to: 75}.! !

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 20:59:35'!
PASSED!

!testRun: #CreditCardTest #test02 stamp: 'JA 6/14/2021 20:59:35'!
PASSED!

!testRun: #CreditCardTest #test03 stamp: 'JA 6/14/2021 20:59:35'!
PASSED!

!methodRemoval: Cashier class #with: stamp: 'JA 6/14/2021 21:07:34'!
with: aPriceList 
	^self new initializeWith: aPriceList!

!methodRemoval: Cashier class #with:registerSalesOn: stamp: 'JA 6/14/2021 21:07:36'!
with: aPriceList registerSalesOn: aSalesBook 
	
	^self new initializeWith: aPriceList registerSalesOn: aSalesBook!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 21:07:39'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 21:07:39'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 21:07:39'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 21:07:39'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 21:07:39'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutWithACreditCardWithoutCredit stamp: 'JA 6/14/2021 21:07:39'!
PASSED!

!testRun: #CashierTest #test07CanNotCheckoutWithAStolenCreditCard stamp: 'JA 6/14/2021 21:07:39'!
PASSED!

!testRun: #CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'JA 6/14/2021 21:07:39'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 21:07:44'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 21:07:44'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 21:07:44'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 21:07:44'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 21:07:44'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutWithACreditCardWithoutCredit stamp: 'JA 6/14/2021 21:07:44'!
PASSED!

!testRun: #CashierTest #test07CanNotCheckoutWithAStolenCreditCard stamp: 'JA 6/14/2021 21:07:44'!
PASSED!

!testRun: #CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'JA 6/14/2021 21:07:44'!
PASSED!
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/14/2021 21:07:56'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/14/2021 21:07:56'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/14/2021 21:07:56'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator
	^ [
	([
	(self coverAll:
		{96 to: 99}) new ] valueCoveringAll:
		{101 to: 103})
		initializeWith:
			(aPriceList
				cover: (121 to: 130)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (149 to: 158)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessorSimulator
				cover: (179 to: 205)
				declaredAt: (65 to: 91)) ] valueCoveringAll:
		{105 to: 119. 132 to: 147. 160 to: 177}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator
	(priceList _ aPriceList
		cover: (120 to: 129)
		declaredAt: (17 to: 26))
		cover: (107 to: 115)
		declaredAt: (107 to: 115).
	(salesBook _ aSalesBook
		cover: (146 to: 155)
		declaredAt: (45 to: 54))
		cover: (133 to: 141)
		declaredAt: (133 to: 141).
	(merchantProcessorSimulator _ aMerchantProcessorSimulator
		cover: (189 to: 215)
		declaredAt: (75 to: 101))
		cover: (159 to: 184)
		declaredAt: (159 to: 184).! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) InvalidCreditCardError ] valueCoveringAll:
				{89 to: 110}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (117 to: 123)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (148 to: 153)
			declaredAt: (139 to: 144)) isDigit ] valueCoveringAll:
			{155 to: 161} ]] valueCoveringAll:
		{125 to: 135}) ifFalse: [
		[
		(self coverAll:
			{176 to: 179}) error:
			([
			(self coverAll:
				{188 to: 191}) InvalidCreditCardError ] valueCoveringAll:
				{193 to: 214}) ] valueCoveringAll:
			{181 to: 186} ]] valueCoveringAll:
		{166 to: 173}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) InvalidCreditCardError ] valueCoveringAll:
				{103 to: 124}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(gregorianMonthOfYear _ aGregorianMonthOfYear
		cover: (208 to: 228)
		declaredAt: (76 to: 96))
		cover: (184 to: 203)
		declaredAt: (184 to: 203).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice |
	[
	(self coverAll:
		{61 to: 64}) assertCartIsNotEmpty:
		(aCart
			cover: (88 to: 92)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{66 to: 86}.
	[
	(self coverAll:
		{96 to: 99}) assertCreditCardIsValid:
		(aCreditCard
			cover: (126 to: 136)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{101 to: 124}.
	(totalPrice _ 0 coverAll:
		{154 to: 154})
		cover: (140 to: 149)
		declaredAt: (48 to: 57).
	[
	(aCart
		cover: (158 to: 162)
		declaredAt: (11 to: 15)) do: [ :anElement |
		(totalPrice _ [
		([
		(totalPrice
			cover: (182 to: 191)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (209 to: 217)
				declaredAt: (209 to: 217)) ] valueCoveringAll:
			{207 to: 207})
			at:
				(anElement
					cover: (223 to: 231)
					declaredAt: (170 to: 178))
			ifAbsent: [
				[
				(self coverAll:
					{244 to: 247}) itemNotInPriceListError ] valueCoveringAll:
					{249 to: 271} ]] valueCoveringAll:
			{219 to: 221. 233 to: 241})
			cover: (196 to: 205)
			declaredAt: (48 to: 57) ]] valueCoveringAll:
		{164 to: 166}.
	[
	(merchantProcessorSimulator
		cover: (278 to: 303)
		declaredAt: (278 to: 303))
		charge:
			(totalPrice
				cover: (313 to: 322)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (329 to: 339)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{305 to: 311. 325 to: 327}.
	[
	(salesBook
		cover: (344 to: 352)
		declaredAt: (344 to: 352)) add:
		(totalPrice
			cover: (359 to: 368)
			declaredAt: (48 to: 57)) ] valueCoveringAll:
		{354 to: 357}.
	^ totalPrice
		cover: (374 to: 383)
		declaredAt: (48 to: 57).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) CanNotCheckoutEmptyCart ] valueCoveringAll:
				{80 to: 102}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
CanNotCheckoutEmptyCart
	^ 'The cart is empty' coverAll:
		{27 to: 45}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
assertCreditCardIsValid: aCreditCard
	[
	([
	([
	(aCreditCard
		cover: (41 to: 51)
		declaredAt: (26 to: 36)) expirationDate ] valueCoveringAll:
		{53 to: 66}) <
		([
		(GregorianMonthOfYear
			cover: (70 to: 89)
			declaredAt: (70 to: 89)) current ] valueCoveringAll:
			{91 to: 97}) ] valueCoveringAll:
		{68 to: 68}) ifTrue: [
		[
		(self coverAll:
			{108 to: 111}) error:
			([
			([
			(self coverAll:
				{120 to: 123}) class ] valueCoveringAll:
				{125 to: 129}) ExpiredCreditCardError ] valueCoveringAll:
				{131 to: 152}) ] valueCoveringAll:
			{113 to: 118} ]] valueCoveringAll:
		{99 to: 105}.! !
!Behavior method!
expirationDate
	^ gregorianMonthOfYear
		cover: (19 to: 38)
		declaredAt: (19 to: 38).! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
itemNotInPriceListError
	^ [
	(self coverAll:
		{29 to: 32}) error:
		([
		([
		(self coverAll:
			{41 to: 44}) class ] valueCoveringAll:
			{46 to: 50}) AnItemIsNotInThePriceList ] valueCoveringAll:
			{52 to: 76}) ] valueCoveringAll:
		{34 to: 39}.! !
!Behavior method!
AnItemIsNotInThePriceList
	^ 'An item in the cart is not in the price list' coverAll:
		{29 to: 74}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 21:07:56'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
ExpiredCreditCardError
	^ 'The credit card is expired' coverAll:
		{26 to: 53}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
CreditCardWithoutCreditError
	^ 'La tarjeta no tiene suficiente cr�dito.' coverAll:
		{33 to: 73}.! !
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutWithACreditCardWithoutCredit stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
StolenCreditCardError
	^ 'La tarjeta de cr�dito es robada' coverAll:
		{27 to: 59}.! !

!testRun: #CashierTest #test07CanNotCheckoutWithAStolenCreditCard stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
FakeCreditCardError
	^ 'La tarjeta de cr�dito es falsa' coverAll:
		{23 to: 54}.! !

!testRun: #CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'JA 6/14/2021 21:07:56'!
PASSED!
!Behavior method!
InvalidCreditCardError
	^ 'Los datos de la tarjeta de cr�dito son inv�lidos' coverAll:
		{26 to: 75}.! !

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 21:07:56'!
PASSED!

!testRun: #CreditCardTest #test02 stamp: 'JA 6/14/2021 21:07:56'!
PASSED!

!testRun: #CreditCardTest #test03 stamp: 'JA 6/14/2021 21:07:56'!
PASSED!

!methodRemoval: Cashier #initializeWith: stamp: 'JA 6/14/2021 21:09:47'!
initializeWith: aPriceList 

	priceList := aPriceList.!

!methodRemoval: Cashier #initializeWith:registerSalesOn: stamp: 'JA 6/14/2021 21:09:49'!
initializeWith: aPriceList registerSalesOn: aSalesBook 	
	priceList := aPriceList.
	salesBook := aSalesBook.!
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/14/2021 21:09:57'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/14/2021 21:09:57'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/14/2021 21:09:57'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator
	^ [
	([
	(self coverAll:
		{96 to: 99}) new ] valueCoveringAll:
		{101 to: 103})
		initializeWith:
			(aPriceList
				cover: (121 to: 130)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (149 to: 158)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessorSimulator
				cover: (179 to: 205)
				declaredAt: (65 to: 91)) ] valueCoveringAll:
		{105 to: 119. 132 to: 147. 160 to: 177}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator
	(priceList _ aPriceList
		cover: (120 to: 129)
		declaredAt: (17 to: 26))
		cover: (107 to: 115)
		declaredAt: (107 to: 115).
	(salesBook _ aSalesBook
		cover: (146 to: 155)
		declaredAt: (45 to: 54))
		cover: (133 to: 141)
		declaredAt: (133 to: 141).
	(merchantProcessorSimulator _ aMerchantProcessorSimulator
		cover: (189 to: 215)
		declaredAt: (75 to: 101))
		cover: (159 to: 184)
		declaredAt: (159 to: 184).! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) InvalidCreditCardError ] valueCoveringAll:
				{89 to: 110}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (117 to: 123)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (148 to: 153)
			declaredAt: (139 to: 144)) isDigit ] valueCoveringAll:
			{155 to: 161} ]] valueCoveringAll:
		{125 to: 135}) ifFalse: [
		[
		(self coverAll:
			{176 to: 179}) error:
			([
			(self coverAll:
				{188 to: 191}) InvalidCreditCardError ] valueCoveringAll:
				{193 to: 214}) ] valueCoveringAll:
			{181 to: 186} ]] valueCoveringAll:
		{166 to: 173}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) InvalidCreditCardError ] valueCoveringAll:
				{103 to: 124}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(gregorianMonthOfYear _ aGregorianMonthOfYear
		cover: (208 to: 228)
		declaredAt: (76 to: 96))
		cover: (184 to: 203)
		declaredAt: (184 to: 203).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice |
	[
	(self coverAll:
		{61 to: 64}) assertCartIsNotEmpty:
		(aCart
			cover: (88 to: 92)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{66 to: 86}.
	[
	(self coverAll:
		{96 to: 99}) assertCreditCardIsValid:
		(aCreditCard
			cover: (126 to: 136)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{101 to: 124}.
	(totalPrice _ 0 coverAll:
		{154 to: 154})
		cover: (140 to: 149)
		declaredAt: (48 to: 57).
	[
	(aCart
		cover: (158 to: 162)
		declaredAt: (11 to: 15)) do: [ :anElement |
		(totalPrice _ [
		([
		(totalPrice
			cover: (182 to: 191)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (209 to: 217)
				declaredAt: (209 to: 217)) ] valueCoveringAll:
			{207 to: 207})
			at:
				(anElement
					cover: (223 to: 231)
					declaredAt: (170 to: 178))
			ifAbsent: [
				[
				(self coverAll:
					{244 to: 247}) itemNotInPriceListError ] valueCoveringAll:
					{249 to: 271} ]] valueCoveringAll:
			{219 to: 221. 233 to: 241})
			cover: (196 to: 205)
			declaredAt: (48 to: 57) ]] valueCoveringAll:
		{164 to: 166}.
	[
	(merchantProcessorSimulator
		cover: (278 to: 303)
		declaredAt: (278 to: 303))
		charge:
			(totalPrice
				cover: (313 to: 322)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (329 to: 339)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{305 to: 311. 325 to: 327}.
	[
	(salesBook
		cover: (344 to: 352)
		declaredAt: (344 to: 352)) add:
		(totalPrice
			cover: (359 to: 368)
			declaredAt: (48 to: 57)) ] valueCoveringAll:
		{354 to: 357}.
	^ totalPrice
		cover: (374 to: 383)
		declaredAt: (48 to: 57).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) CanNotCheckoutEmptyCart ] valueCoveringAll:
				{80 to: 102}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
CanNotCheckoutEmptyCart
	^ 'The cart is empty' coverAll:
		{27 to: 45}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
assertCreditCardIsValid: aCreditCard
	[
	([
	([
	(aCreditCard
		cover: (41 to: 51)
		declaredAt: (26 to: 36)) expirationDate ] valueCoveringAll:
		{53 to: 66}) <
		([
		(GregorianMonthOfYear
			cover: (70 to: 89)
			declaredAt: (70 to: 89)) current ] valueCoveringAll:
			{91 to: 97}) ] valueCoveringAll:
		{68 to: 68}) ifTrue: [
		[
		(self coverAll:
			{108 to: 111}) error:
			([
			([
			(self coverAll:
				{120 to: 123}) class ] valueCoveringAll:
				{125 to: 129}) ExpiredCreditCardError ] valueCoveringAll:
				{131 to: 152}) ] valueCoveringAll:
			{113 to: 118} ]] valueCoveringAll:
		{99 to: 105}.! !
!Behavior method!
expirationDate
	^ gregorianMonthOfYear
		cover: (19 to: 38)
		declaredAt: (19 to: 38).! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
itemNotInPriceListError
	^ [
	(self coverAll:
		{29 to: 32}) error:
		([
		([
		(self coverAll:
			{41 to: 44}) class ] valueCoveringAll:
			{46 to: 50}) AnItemIsNotInThePriceList ] valueCoveringAll:
			{52 to: 76}) ] valueCoveringAll:
		{34 to: 39}.! !
!Behavior method!
AnItemIsNotInThePriceList
	^ 'An item in the cart is not in the price list' coverAll:
		{29 to: 74}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/14/2021 21:09:57'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
ExpiredCreditCardError
	^ 'The credit card is expired' coverAll:
		{26 to: 53}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
CreditCardWithoutCreditError
	^ 'La tarjeta no tiene suficiente cr�dito.' coverAll:
		{33 to: 73}.! !
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutWithACreditCardWithoutCredit stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
StolenCreditCardError
	^ 'La tarjeta de cr�dito es robada' coverAll:
		{27 to: 59}.! !

!testRun: #CashierTest #test07CanNotCheckoutWithAStolenCreditCard stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
FakeCreditCardError
	^ 'La tarjeta de cr�dito es falsa' coverAll:
		{23 to: 54}.! !

!testRun: #CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!Behavior method!
InvalidCreditCardError
	^ 'Los datos de la tarjeta de cr�dito son inv�lidos' coverAll:
		{26 to: 75}.! !

!testRun: #CreditCardTest #test01 stamp: 'JA 6/14/2021 21:09:57'!
PASSED!

!testRun: #CreditCardTest #test02 stamp: 'JA 6/14/2021 21:09:57'!
PASSED!

!testRun: #CreditCardTest #test03 stamp: 'JA 6/14/2021 21:09:57'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 21:26:34'!
test01CanNotCreateCreditCardWithNumberOfIncorrectSize
	self should: [ CreditCard owner: 'Juan' number: '1234' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] ! !

!methodRemoval: CreditCardTest #test01 stamp: 'JA 6/14/2021 21:26:34'!
test01
	self should: [ CreditCard owner: 'Juan' number: '1234' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 21:27:03'!
test01CanNotCreateCreditCardWithIncorrectSizeNumber
	self should: [ CreditCard owner: 'Juan' number: '1234' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] ! !

!methodRemoval: CreditCardTest #test01CanNotCreateCreditCardWithNumberOfIncorrectSize stamp: 'JA 6/14/2021 21:27:03'!
test01CanNotCreateCreditCardWithNumberOfIncorrectSize
	self should: [ CreditCard owner: 'Juan' number: '1234' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 21:28:29'!
test02CanNotCreateCreditCardWithAlphaNumericNumber
	self should: [ CreditCard owner: 'Juan' number: '1234567890ABCDEF' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] ! !

!methodRemoval: CreditCardTest #test02 stamp: 'JA 6/14/2021 21:28:29'!
test02
	self should: [ CreditCard owner: 'Juan' number: '1234567890ABCDEF' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'JA 6/14/2021 21:29:10'!
test03CanNotCreateCreditCardWithBlankOwner
	self should: [ CreditCard owner: '    ' number: '1234567890123456' expiration: GregorianMonthOfYear current.]
	 	raise:  Error - MessageNotUnderstood 
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] ! !

!methodRemoval: CreditCardTest #test03 stamp: 'JA 6/14/2021 21:29:10'!
test03
	self should: [ CreditCard owner: '    ' number: '1234567890123456' expiration: GregorianMonthOfYear current.]
	 	raise:  Error - MessageNotUnderstood 
		withExceptionDo:[ :anException | self assert: CreditCard InvalidCreditCardError equals: anException messageText	] !

----QUIT----(14 June 2021 21:33:09) CuisUniversity-4532.image priorSource: 16891931!

----STARTUP---- (16 June 2021 17:00:45) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!

!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:02:28' prior: 51044305!
test08CanNotCheckoutWithAFakeCreditCard

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor messageError |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'ET 6/16/2021 17:02:35'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:02:35'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:02:35'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:02:35'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:02:35'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:02:35'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutWithACreditCardWithoutCredit stamp: 'ET 6/16/2021 17:02:35'!
PASSED!

!testRun: #CashierTest #test07CanNotCheckoutWithAStolenCreditCard stamp: 'ET 6/16/2021 17:02:35'!
PASSED!

!testRun: #CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'ET 6/16/2021 17:02:35'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:04:45'!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor messageError |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!methodRemoval: CashierTest #test06CanNotCheckoutWithACreditCardWithoutCredit stamp: 'ET 6/16/2021 17:04:49'!
test06CanNotCheckoutWithACreditCardWithoutCredit

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier CreditCardWithoutCreditError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CreditCardWithoutCreditError.
			self assert: aSalesBook isEmpty ]	.
		
		
		!

!methodRemoval: CashierTest #test07CanNotCheckoutWithAStolenCreditCard stamp: 'ET 6/16/2021 17:04:52'!
test07CanNotCheckoutWithAStolenCreditCard

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: Cashier StolenCreditCardError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier StolenCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		!

!methodRemoval: CashierTest #test08CanNotCheckoutWithAFakeCreditCard stamp: 'ET 6/16/2021 17:04:54'!
test08CanNotCheckoutWithAFakeCreditCard

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor messageError |
	
	catalog := OrderedCollection new.
	
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		!

!methodRemoval: Cashier class #StolenCreditCardError stamp: 'ET 6/16/2021 17:05:17'!
StolenCreditCardError
 	^ 'La tarjeta de cr�dito es robada'!

!methodRemoval: Cashier class #FakeCreditCardError stamp: 'ET 6/16/2021 17:05:20'!
FakeCreditCardError
	^'La tarjeta de cr�dito es falsa'!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:11:03' prior: 51044120!
test01CanNotCheckoutEmptyCart

	|cart catalog cashier priceList aSalesBook aMerchantProcessor |
	
	catalog := OrderedCollection new.
	priceList := Dictionary new.
	cart := Cart acceptingItemsOf: priceList keys.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. 
			self assert: aSalesBook isEmpty.]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:11:17' prior: 51045578!
test01CanNotCheckoutEmptyCart

	|cart cashier priceList aSalesBook aMerchantProcessor |

	priceList := Dictionary new.
	cart := Cart acceptingItemsOf: priceList keys.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. 
			self assert: aSalesBook isEmpty.]! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:11:18'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:11:18'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:11:18'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:11:18'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:11:18'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:11:18'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:11:18'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:12:13' prior: 51045444!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart catalog cashier priceList creditCard aSalesBook aMerchantProcessor messageError |
	
	catalog := OrderedCollection new.
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: catalog.
	catalog add: 'book'.
	cart add: 'book'.
	
	
	
	
	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:12:26' prior: 51045649!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier priceList creditCard aSalesBook aMerchantProcessor messageError |

	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	
	
	
	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:12:29'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:12:29'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:12:29'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:12:29'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:12:29'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:12:29'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:12:29'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:12:57' prior: 51044217!
test05CanNotCheckoutWithExpiratedCreditCard

	|cart cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:13:04' prior: 51045736!
test05CanNotCheckoutWithExpiratedCreditCard

	|cart cashier priceList creditCard aSalesBook aMerchantProcessor |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:13:05'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:13:05'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:13:05'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:13:05'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:13:05'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:13:05'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:13:05'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:13:37' prior: 51044192!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier priceList aSalesBook aMerchantProcessor |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	cart add: 'book'.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.		
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.		
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 2 equals: aSalesBook first.! !

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:13:40'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:13:40'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:13:40'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:13:40'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:13:40'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:13:40'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:13:40'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:14:31' prior: 51044168!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier priceList aSalesBook aMerchantProcessor |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	cart add: 'book'.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.	
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 1 equals: aSalesBook first.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:14:37' prior: 51045864!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier priceList aSalesBook aMerchantProcessor |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.	
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 1 equals: aSalesBook first.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:14:37'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:14:37'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:14:37'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:14:38'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:14:38'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:14:38'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:14:38'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:16:08' prior: 51044143!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier priceList aSalesBook aMerchantProcessor |
	
	cart := Cart acceptingItemsOf: (Array with: 'book').
	cart add: 'book'.
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. 
			self assert: aSalesBook isEmpty]! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:16:08'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:16:08'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:16:08'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:16:08'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:16:08'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:16:08'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:16:08'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:16:41' prior: 51045681!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier priceList creditCard aSalesBook aMerchantProcessor messageError |

	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:19:41'!
newCashierWithPriceList: aPriceList salesBook: aSalesBook
	
	^Cashier with: aPriceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:20:50' prior: 51045764!
test05CanNotCheckoutWithExpiratedCreditCard

	|cart cashier priceList creditCard aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
		
	creditCard := self expiredCreditCard.

	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier ExpiredCreditCardError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:21:08' prior: 51045815!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier priceList aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	cart add: 'book'.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 2 equals: aSalesBook first.! !

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:21:11'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:21:11'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:21:11'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:21:11'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:21:11'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:21:11'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:21:11'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:21:22' prior: 51045887!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier priceList aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 1 equals: aSalesBook first.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:21:34' prior: 51045935!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier priceList aSalesBook |
	
	cart := Cart acceptingItemsOf: (Array with: 'book').
	cart add: 'book'.
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. 
			self assert: aSalesBook isEmpty]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:21:41' prior: 51045602!
test01CanNotCheckoutEmptyCart

	|cart cashier priceList aSalesBook |

	priceList := Dictionary new.
	cart := Cart acceptingItemsOf: priceList keys.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. 
			self assert: aSalesBook isEmpty.]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:31:51'!
assertCashier: aCashier checkout: aCart  with: aCreditCard raisesErrorMessage: anErrorMessage forSalesBook: aSalesBook
	self should: [aCashier checkout: aCart  withCreditCard: aCreditCard]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = anErrorMessage.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:33:34' prior: 51046130!
test01CanNotCheckoutEmptyCart

	|cart cashier priceList aSalesBook |

	priceList := Dictionary new.
	cart := Cart acceptingItemsOf: priceList keys.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self 
		assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: Cashier CanNotCheckoutEmptyCart
		forSalesBook: aSalesBook.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:33:36'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:33:36'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:33:36'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:33:36'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:33:36'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:33:36'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:33:36'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:33:52' prior: 51046110!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier priceList aSalesBook |
	
	cart := Cart acceptingItemsOf: (Array with: 'book').
	cart add: 'book'.
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	self 	assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: Cashier CanNotCheckoutEmptyCart
		forSalesBook: aSalesBook.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:34:02' prior: 51046205!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier priceList aSalesBook |
	
	cart := Cart acceptingItemsOf: (Array with: 'book').
	cart add: 'book'.
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	self 	assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: Cashier AnItemIsNotInThePriceList 
		forSalesBook: aSalesBook.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:34:04'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:34:04'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:34:04'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:34:04'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:34:04'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:34:04'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:34:04'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:34:38' prior: 51045983!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier priceList creditCard aSalesBook aMerchantProcessor messageError |

	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self 	assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: messageError
		forSalesBook: aSalesBook.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:34:55' prior: 51046266!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier priceList aSalesBook aMerchantProcessor messageError |

	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
	
	
	self 	assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: messageError
		forSalesBook: aSalesBook.
		
		
		! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:34:56'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:34:56'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:34:56'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:34:56'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:34:56'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:34:56'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:34:56'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:35:27' prior: 51046021!
test05CanNotCheckoutWithExpiratedCreditCard

	|cart cashier priceList creditCard aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
		
	creditCard := self expiredCreditCard.

	
	self 	assertCashier: cashier  
		checkout: cart
		with: self expiredCreditCard 
		raisesErrorMessage: Cashier ExpiredCreditCardError 
		forSalesBook: aSalesBook.
		
		
		! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:35:31'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:35:31'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:35:31'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:35:31'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:35:31'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:35:31'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:35:31'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:35:40' prior: 51046343!
test05CanNotCheckoutWithExpiratedCreditCard

	|cart cashier priceList aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self 	assertCashier: cashier  
		checkout: cart
		with: self expiredCreditCard 
		raisesErrorMessage: Cashier ExpiredCreditCardError 
		forSalesBook: aSalesBook.
		
		
		! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:35:45'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:35:45'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 17:35:45'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 17:35:45'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 17:35:45'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:35:45'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 17:35:45'!
PASSED!

!methodRemoval: Cashier class #CreditCardWithoutCreditError stamp: 'ET 6/16/2021 17:36:06'!
CreditCardWithoutCreditError
	^ 'La tarjeta no tiene suficiente cr�dito.'!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:36:27'!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier priceList aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self 	assertCashier: cashier  
		checkout: cart
		with: self expiredCreditCard 
		raisesErrorMessage: Cashier ExpiredCreditCardError 
		forSalesBook: aSalesBook.
		
		
		! !

!methodRemoval: CashierTest #test05CanNotCheckoutWithExpiratedCreditCard stamp: 'ET 6/16/2021 17:36:27'!
test05CanNotCheckoutWithExpiratedCreditCard

	|cart cashier priceList aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self 	assertCashier: cashier  
		checkout: cart
		with: self expiredCreditCard 
		raisesErrorMessage: Cashier ExpiredCreditCardError 
		forSalesBook: aSalesBook.
		
		
		!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:37:13'!
anItemIsNotInThePriceList
	^'An item in the cart is not in the price list'.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:37:13' prior: 51044508!
itemNotInPriceListError

	^ self error: self class anItemIsNotInThePriceList! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:37:13' prior: 51046223!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier priceList aSalesBook |
	
	cart := Cart acceptingItemsOf: (Array with: 'book').
	cart add: 'book'.
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	self 	assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: Cashier anItemIsNotInThePriceList 
		forSalesBook: aSalesBook.! !

!methodRemoval: Cashier class #AnItemIsNotInThePriceList stamp: 'ET 6/16/2021 17:37:13'!
AnItemIsNotInThePriceList
	^'An item in the cart is not in the price list'.!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:37:23'!
expiredCreditCardError
	^'The credit card is expired'.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:37:23' prior: 51044519!
assertCreditCardIsValid: aCreditCard
	
	aCreditCard expirationDate < GregorianMonthOfYear current ifTrue: [self error: self class expiredCreditCardError].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:37:23' prior: 51046438!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier priceList aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self 	assertCashier: cashier  
		checkout: cart
		with: self expiredCreditCard 
		raisesErrorMessage: Cashier expiredCreditCardError 
		forSalesBook: aSalesBook.
		
		
		! !

!methodRemoval: Cashier class #ExpiredCreditCardError stamp: 'ET 6/16/2021 17:37:23'!
ExpiredCreditCardError
	^'The credit card is expired'.!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:37:33'!
canNotCheckoutEmptyCart
	^'The cart is empty'.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:37:33' prior: 51046164!
test01CanNotCheckoutEmptyCart

	|cart cashier priceList aSalesBook |

	priceList := Dictionary new.
	cart := Cart acceptingItemsOf: priceList keys.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self 
		assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: Cashier canNotCheckoutEmptyCart
		forSalesBook: aSalesBook.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:37:33' prior: 51044513!
assertCartIsNotEmpty: aCart

	^ aCart isEmpty ifTrue: [	self error: self class canNotCheckoutEmptyCart]! !

!methodRemoval: Cashier class #CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:37:33'!
CanNotCheckoutEmptyCart
	^'The cart is empty'.!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:38:56'!
itemNotInPriceListErrorDescription
	^'An item in the cart is not in the price list'.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:38:57' prior: 51046482!
itemNotInPriceListError

	^ self error: self class itemNotInPriceListErrorDescription! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:38:57' prior: 51046488!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier priceList aSalesBook |
	
	cart := Cart acceptingItemsOf: (Array with: 'book').
	cart add: 'book'.
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	self 	assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: Cashier itemNotInPriceListErrorDescription 
		forSalesBook: aSalesBook.! !

!methodRemoval: Cashier class #anItemIsNotInThePriceList stamp: 'ET 6/16/2021 17:38:57'!
anItemIsNotInThePriceList
	^'An item in the cart is not in the price list'.!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:39:07'!
expiredCreditCardErrorDescription
	^'The credit card is expired'.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:39:07' prior: 51046516!
assertCreditCardIsValid: aCreditCard
	
	aCreditCard expirationDate < GregorianMonthOfYear current ifTrue: [self error: self class expiredCreditCardErrorDescription].! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:39:07' prior: 51046524!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier priceList aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self 	assertCashier: cashier  
		checkout: cart
		with: self expiredCreditCard 
		raisesErrorMessage: Cashier expiredCreditCardErrorDescription 
		forSalesBook: aSalesBook.
		
		
		! !

!methodRemoval: Cashier class #expiredCreditCardError stamp: 'ET 6/16/2021 17:39:07'!
expiredCreditCardError
	^'The credit card is expired'.!
!Cashier class methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:39:23'!
emptyCartErrorDescription
	^'The cart is empty'.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:39:23' prior: 51046552!
test01CanNotCheckoutEmptyCart

	|cart cashier priceList aSalesBook |

	priceList := Dictionary new.
	cart := Cart acceptingItemsOf: priceList keys.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self 
		assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: Cashier emptyCartErrorDescription
		forSalesBook: aSalesBook.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:39:23' prior: 51046569!
assertCartIsNotEmpty: aCart

	^ aCart isEmpty ifTrue: [	self error: self class emptyCartErrorDescription]! !

!methodRemoval: Cashier class #canNotCheckoutEmptyCart stamp: 'ET 6/16/2021 17:39:23'!
canNotCheckoutEmptyCart
	^'The cart is empty'.!
!Cashier methodsFor: 'assertions' stamp: 'ET 6/16/2021 17:40:18'!
assertCreditCardIsNotExpired: aCreditCard
	
	aCreditCard expirationDate < GregorianMonthOfYear current ifTrue: [self error: self class expiredCreditCardErrorDescription].! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:40:18' prior: 51044493!
checkout: aCart withCreditCard: aCreditCard 
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	self assertCreditCardIsNotExpired: aCreditCard.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self itemNotInPriceListError].].
	merchantProcessorSimulator charge: totalPrice  on: aCreditCard .
	salesBook add: totalPrice .
	^totalPrice.! !

!methodRemoval: Cashier #assertCreditCardIsValid: stamp: 'ET 6/16/2021 17:40:18'!
assertCreditCardIsValid: aCreditCard
	
	aCreditCard expirationDate < GregorianMonthOfYear current ifTrue: [self error: self class expiredCreditCardErrorDescription].!
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:42:04'!
raiseItemNotInPriceListError

	^ self error: self class itemNotInPriceListErrorDescription! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:42:04' prior: 51046693!
checkout: aCart withCreditCard: aCreditCard 
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	self assertCreditCardIsNotExpired: aCreditCard.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self raiseItemNotInPriceListError].].
	merchantProcessorSimulator charge: totalPrice  on: aCreditCard .
	salesBook add: totalPrice .
	^totalPrice.! !

!methodRemoval: Cashier #itemNotInPriceListError stamp: 'ET 6/16/2021 17:42:04'!
itemNotInPriceListError

	^ self error: self class itemNotInPriceListErrorDescription!

!classDefinition: #Cashier category: 'TusLibros' stamp: 'ET 6/16/2021 17:42:56'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList salesBook merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:42:56' prior: 51044483!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessorSimulator 
	
	priceList := aPriceList.
	salesBook := aSalesBook.
	merchantProcessor := aMerchantProcessorSimulator.! !
!Cashier methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:42:56' prior: 51046722!
checkout: aCart withCreditCard: aCreditCard 
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	self assertCreditCardIsNotExpired: aCreditCard.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self raiseItemNotInPriceListError].].
	merchantProcessor charge: totalPrice  on: aCreditCard .
	salesBook add: totalPrice .
	^totalPrice.! !
!Cashier methodsFor: 'initialization' stamp: 'ET 6/16/2021 17:43:07' prior: 51046751!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor 
	
	priceList := aPriceList.
	salesBook := aSalesBook.
	merchantProcessor := aMerchantProcessor.! !
!Cashier class methodsFor: 'instance creation' stamp: 'ET 6/16/2021 17:43:19' prior: 51044534!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor 
	^self new initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor ! !
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:44:16'!
invalidCreditCardErrorDescription
	^'Los datos de la tarjeta de cr�dito son inv�lidos'! !
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:44:16' prior: 51044629!
assertCreditCardNumberIsValid: aString 
	
	aString size = 16 ifFalse: [self error: self invalidCreditCardErrorDescription ].
	(aString allSatisfy: [:aDigit | aDigit isDigit]	) ifFalse: [self error: self invalidCreditCardErrorDescription ].! !
!CreditCard class methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:44:16' prior: 51044639!
assertNonBlankOwner: anOwnerString
	anOwnerString withBlanksTrimmed isEmpty ifTrue: [self error: self invalidCreditCardErrorDescription ]
	
	! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:44:16' prior: 51044353!
test01CanNotCreateCreditCardWithIncorrectSizeNumber
	self should: [ CreditCard owner: 'Juan' number: '1234' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard invalidCreditCardErrorDescription equals: anException messageText	] ! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:44:16' prior: 51044377!
test03CanNotCreateCreditCardWithBlankOwner
	self should: [ CreditCard owner: '    ' number: '1234567890123456' expiration: GregorianMonthOfYear current.]
	 	raise:  Error - MessageNotUnderstood 
		withExceptionDo:[ :anException | self assert: CreditCard invalidCreditCardErrorDescription equals: anException messageText	] ! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:44:16' prior: 51044365!
test02CanNotCreateCreditCardWithAlphaNumericNumber
	self should: [ CreditCard owner: 'Juan' number: '1234567890ABCDEF' expiration: GregorianMonthOfYear current.]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard invalidCreditCardErrorDescription equals: anException messageText	] ! !

!methodRemoval: CreditCard class #InvalidCreditCardError stamp: 'ET 6/16/2021 17:44:16'!
InvalidCreditCardError
	^'Los datos de la tarjeta de cr�dito son inv�lidos'!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:47:39'!
newCreditCardOwnedBy: anOwner withNumber: aString
	^CreditCard owner: anOwner number: aString expiration: GregorianMonthOfYear current.! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:48:19' prior: 51046819!
test01CanNotCreateCreditCardWithIncorrectSizeNumber
	self should: [self newCreditCardOwnedBy: 'Juan' withNumber: 1234]
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard invalidCreditCardErrorDescription equals: anException messageText	] ! !

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 17:48:21'!
FAILURE!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:48:38' prior: 51046872!
test01CanNotCreateCreditCardWithIncorrectSizeNumber
	self should: [self newCreditCardOwnedBy: 'Juan' withNumber: '1234']
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard invalidCreditCardErrorDescription equals: anException messageText	] ! !

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 17:48:39'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 17:48:39'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/16/2021 17:48:39'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 17:48:39'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:49:07' prior: 51046846!
test02CanNotCreateCreditCardWithAlphaNumericNumber
	self should: [ self newCreditCardOwnedBy: 'Juan' withNumber: '1234567890ABCDEF']
	 	raise:  Error
		withExceptionDo:[ :anException | self assert: CreditCard invalidCreditCardErrorDescription equals: anException messageText	] ! !

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 17:49:12'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 17:49:14'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 17:49:14'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/16/2021 17:49:14'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 17:49:14'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:49:46' prior: 51046832!
test03CanNotCreateCreditCardWithBlankOwner
	self should: [ self newCreditCardOwnedBy: '    '  withNumber: '1234567890123456']
	 	raise:  Error - MessageNotUnderstood 
		withExceptionDo:[ :anException | self assert: CreditCard invalidCreditCardErrorDescription equals: anException messageText	] ! !

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 17:49:47'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 17:49:47'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/16/2021 17:49:47'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 17:49:47'!
PASSED!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:56:41'!
assertNewCreditCardRaisesErrorOwnedBy: anOwner withNumber: aStringNumber
	self should: [CreditCard owner: anOwner  number: aStringNumber expiration: GregorianMonthOfYear current]
	 	raise: Error - MessageNotUnderstood
		withExceptionDo:[ :anError| self assert: CreditCard invalidCreditCardErrorDescription equals: anError messageText	] ! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:57:08' prior: 51046888!
test01CanNotCreateCreditCardWithIncorrectSizeNumber
	
	self assertNewCreditCardRaisesErrorOwnedBy: 'Juan' withNumber: '1234'.! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:57:30' prior: 51046915!
test02CanNotCreateCreditCardWithAlphaNumericNumber

	self assertNewCreditCardRaisesErrorOwnedBy: 'Juan' withNumber: '1234567890ABCDEF'.! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:57:57' prior: 51046945!
test03CanNotCreateCreditCardWithBlankOwner

	self assertNewCreditCardRaisesErrorOwnedBy: '    '  withNumber: '1234567890123456'.! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:58:00' prior: 51047002!
test03CanNotCreateCreditCardWithBlankOwner

	self assertNewCreditCardRaisesErrorOwnedBy: '    ' withNumber: '1234567890123456'.! !

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 17:58:01'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 17:58:01'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/16/2021 17:58:01'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 17:58:01'!
PASSED!

!methodRemoval: CreditCardTest #newCreditCardOwnedBy:withNumber: stamp: 'ET 6/16/2021 17:58:06'!
newCreditCardOwnedBy: anOwner withNumber: aString
	^CreditCard owner: anOwner number: aString expiration: GregorianMonthOfYear current.!
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:58:33'!
assertCreditCardInstanceCreationRaisesErrorWhenOwnedBy: anOwner withNumber: aStringNumber
	self should: [CreditCard owner: anOwner  number: aStringNumber expiration: GregorianMonthOfYear current]
	 	raise: Error - MessageNotUnderstood
		withExceptionDo:[ :anError| self assert: CreditCard invalidCreditCardErrorDescription equals: anError messageText	] ! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:58:33' prior: 51046986!
test01CanNotCreateCreditCardWithIncorrectSizeNumber
	
	self assertCreditCardInstanceCreationRaisesErrorWhenOwnedBy: 'Juan' withNumber: '1234'.! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:58:33' prior: 51046994!
test02CanNotCreateCreditCardWithAlphaNumericNumber

	self assertCreditCardInstanceCreationRaisesErrorWhenOwnedBy: 'Juan' withNumber: '1234567890ABCDEF'.! !
!CreditCardTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:58:33' prior: 51047010!
test03CanNotCreateCreditCardWithBlankOwner

	self assertCreditCardInstanceCreationRaisesErrorWhenOwnedBy: '    ' withNumber: '1234567890123456'.! !

!methodRemoval: CreditCardTest #assertNewCreditCardRaisesErrorOwnedBy:withNumber: stamp: 'ET 6/16/2021 17:58:33'!
assertNewCreditCardRaisesErrorOwnedBy: anOwner withNumber: aStringNumber
	self should: [CreditCard owner: anOwner  number: aStringNumber expiration: GregorianMonthOfYear current]
	 	raise: Error - MessageNotUnderstood
		withExceptionDo:[ :anError| self assert: CreditCard invalidCreditCardErrorDescription equals: anError messageText	] !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:02:15'!
assertCashier: aCashier checkout: aCart  with: aCreditCard raisesErrorMessage: anErrorMessage assertingSalesBookIsNotModified: aSalesBook
	self should: [aCashier checkout: aCart  withCreditCard: aCreditCard]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = anErrorMessage.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:02:15' prior: 51046592!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier priceList aSalesBook |
	
	cart := Cart acceptingItemsOf: (Array with: 'book').
	cart add: 'book'.
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	self 	assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: Cashier itemNotInPriceListErrorDescription 
		assertingSalesBookIsNotModified: aSalesBook.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:02:15' prior: 51046657!
test01CanNotCheckoutEmptyCart

	|cart cashier priceList aSalesBook |

	priceList := Dictionary new.
	cart := Cart acceptingItemsOf: priceList keys.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self 
		assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: Cashier emptyCartErrorDescription
		assertingSalesBookIsNotModified: aSalesBook.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:02:15' prior: 51046629!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier priceList aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self 	assertCashier: cashier  
		checkout: cart
		with: self expiredCreditCard 
		raisesErrorMessage: Cashier expiredCreditCardErrorDescription 
		assertingSalesBookIsNotModified: aSalesBook.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:02:15' prior: 51046293!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier priceList aSalesBook aMerchantProcessor messageError |

	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
	
	
	self 	assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: messageError
		assertingSalesBookIsNotModified: aSalesBook.
		
		
		! !

!methodRemoval: CashierTest #assertCashier:checkout:with:raisesErrorMessage:forSalesBook: stamp: 'ET 6/16/2021 18:02:15'!
assertCashier: aCashier checkout: aCart  with: aCreditCard raisesErrorMessage: anErrorMessage forSalesBook: aSalesBook
	self should: [aCashier checkout: aCart  withCreditCard: aCreditCard]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = anErrorMessage.
			self assert: aSalesBook isEmpty ]	.
		
		
		!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:21:41' prior: 51047126!
test01CanNotCheckoutEmptyCart

	|cart cashier priceList aSalesBook |

	priceList := Dictionary new.
	cart := Cart acceptingItemsOf: priceList keys.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier CanNotCheckoutEmptyCart. 
			self assert: aSalesBook isEmpty.]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:33:52' prior: 51047107!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier priceList aSalesBook |
	
	cart := Cart acceptingItemsOf: (Array with: 'book').
	cart add: 'book'.
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	self 	assertCashier: cashier  
		checkout: cart
		with: self validCreditCard
		raisesErrorMessage: Cashier CanNotCheckoutEmptyCart
		forSalesBook: aSalesBook.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:21:34' prior: 51047224!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier priceList aSalesBook |
	
	cart := Cart acceptingItemsOf: (Array with: 'book').
	cart add: 'book'.
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier AnItemIsNotInThePriceList. 
			self assert: aSalesBook isEmpty]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 17:16:41' prior: 51047164!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier priceList creditCard aSalesBook aMerchantProcessor messageError |

	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
		
	creditCard := self validCreditCard.
	
	
	self should: [ (cashier checkout: cart withCreditCard: creditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:05:37' prior: 51047144!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier priceList aSalesBook |
	
	priceList := Dictionary new.
	
	priceList add: 'book'->1.
	cart := Cart acceptingItemsOf: priceList keys.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self should: [ (cashier checkout: cart withCreditCard: self expiredCreditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier expiredCreditCardErrorDescription.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:05:41'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:05:41'!
ERROR!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:05:41'!
ERROR!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:05:41'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:05:41'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:05:41'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:05:41'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:05:54' prior: 51047205!
test01CanNotCheckoutEmptyCart

	|cart cashier priceList aSalesBook |

	priceList := Dictionary new.
	cart := Cart acceptingItemsOf: priceList keys.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier emptyCartErrorDescription. 
			self assert: aSalesBook isEmpty.]! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:06:02' prior: 51047242!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier priceList aSalesBook |
	
	cart := Cart acceptingItemsOf: (Array with: 'book').
	cart add: 'book'.
	priceList := Dictionary new.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: priceList salesBook: aSalesBook.
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier itemNotInPriceListErrorDescription. 
			self assert: aSalesBook isEmpty]! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:06:03'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:06:03'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:06:03'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:06:03'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:06:03'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:06:03'!
PASSED!

!methodRemoval: CashierTest #assertCashier:checkout:with:raisesErrorMessage:assertingSalesBookIsNotModified: stamp: 'ET 6/16/2021 18:06:12'!
assertCashier: aCashier checkout: aCart  with: aCreditCard raisesErrorMessage: anErrorMessage assertingSalesBookIsNotModified: aSalesBook
	self should: [aCashier checkout: aCart  withCreditCard: aCreditCard]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = anErrorMessage.
			self assert: aSalesBook isEmpty ]	.
		
		
		!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:10:59'!
createCart

	^Cart acceptingItemsOf: self createPriceList keys.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:11:30' prior: 51047415!
createCart

	^Cart acceptingItemsOf: self defaultPriceList keys.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:12:36'!
defaultPriceList

	^Dictionary with: self itemInStore -> self itemInStorePrice.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:12:56'!
itemInStore

	^'book in store'.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:13:19'!
itemInStorePrice

	^1.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:14:09' prior: 51047339!
test01CanNotCheckoutEmptyCart

	|cart cashier aSalesBook |

	cart := self createCart.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: self defaultPriceList salesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier emptyCartErrorDescription. 
			self assert: aSalesBook isEmpty.]! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:14:14'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:14:14'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:14:14'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:14:14'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:14:14'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:14:14'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:14:14'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:14:53' prior: 51047358!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier aSalesBook |
	
	cart := self createCart.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: Dictionary new salesBook: aSalesBook.
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier itemNotInPriceListErrorDescription. 
			self assert: aSalesBook isEmpty]! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:14:57'!
FAILURE!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:15:40'!
FAILURE!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:16:22' prior: 51047421!
createCart

	^Cart acceptingItemsOf: self defaultPriceList keys.! !
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:16:46' prior: 51047482!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier aSalesBook |
	
	cart := self createCart.
	cart add: self itemInStore.
	
	aSalesBook := OrderedCollection new.
	
	cashier := self newCashierWithPriceList: Dictionary new salesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier itemNotInPriceListErrorDescription. 
			self assert: aSalesBook isEmpty]! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:16:50'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:16:50'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:16:50'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:16:50'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:16:50'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:16:50'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:16:50'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:17:55' prior: 51046090!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook |
	
	cart := self createCart.
	cart add: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: self defaultPriceList salesBook: aSalesBook.
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: self itemInStorePrice equals: aSalesBook first.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:18:00'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:18:00'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:18:00'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:18:00'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:18:00'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:18:00'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:18:00'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:19:19' prior: 51046044!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook |

	cart := self createCart.
	cart add: 2 of: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: self defaultPriceList salesBook: aSalesBook.
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 2 * self itemInStore equals: aSalesBook first.! !

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:19:22'!
ERROR!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:19:34' prior: 51047600!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook |

	cart := self createCart.
	cart add: 2 of: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: self defaultPriceList salesBook: aSalesBook.
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 2 * self itemInStorePrice equals: aSalesBook first.! !

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:19:35'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:19:35'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:19:35'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:19:35'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:19:35'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:19:35'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:19:35'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:19:59' prior: 51047292!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier aSalesBook |
	
	cart := self createCart.
	cart add: 'book'.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: self defaultPriceList salesBook: aSalesBook.
	
	self should: [ (cashier checkout: cart withCreditCard: self expiredCreditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier expiredCreditCardErrorDescription.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:20:10'!
ERROR!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:20:33'!
ERROR!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:20:47' prior: 51047667!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier aSalesBook |
	
	cart := self createCart.
	cart add: self itemInStore.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithPriceList: self defaultPriceList salesBook: aSalesBook.
	
	self should: [ (cashier checkout: cart withCreditCard: self expiredCreditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier expiredCreditCardErrorDescription.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:20:47'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:20:47'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:20:47'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:20:47'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:20:47'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:20:47'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:20:47'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:21:38'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:21:38'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:21:38'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:21:38'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:21:38'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:21:38'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:21:38'!
PASSED!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:23:59' prior: 51047262!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier aSalesBook aMerchantProcessor messageError |

	cart := self createCart.
	cart add: 'book'.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: self defaultPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
	
	
	self should: [ (cashier checkout: cart withCreditCard: self validCreditCard )]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:24:28'!
ERROR!
!CashierTest methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 18:24:40' prior: 51047763!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier aSalesBook aMerchantProcessor messageError |

	cart := self createCart.
	cart add: self itemInStore.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	cashier := Cashier with: self defaultPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor.
	
	
	self should: [ (cashier checkout: cart withCreditCard: self validCreditCard )]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:24:40'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:24:40'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:24:41'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:24:41'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:24:41'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:24:41'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:24:41'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/16/2021 18:25:39'!
newCashierWithsalesBook: aSalesBook
	
	^Cashier with: self defaultPriceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
		
		! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:25:42'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:25:42'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:25:42'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:25:42'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:25:42'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:25:42'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/16/2021 18:25:49'!
newCashierWithSalesBook: aSalesBook
	
	^Cashier with: self defaultPriceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
		
		! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/16/2021 18:26:03' prior: 51047440!
test01CanNotCheckoutEmptyCart

	|cart cashier aSalesBook |

	cart := self createCart.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier emptyCartErrorDescription. 
			self assert: aSalesBook isEmpty.]! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:26:04'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:26:04'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:26:04'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:26:04'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:26:04'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:26:04'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:26:04'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/16/2021 18:27:08' prior: 51047557!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook |
	
	cart := self createCart.
	cart add: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	self assert: 1 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: self itemInStorePrice equals: aSalesBook first.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:27:09'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:27:09'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:27:10'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:27:10'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:27:10'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:27:10'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:27:10'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/16/2021 18:27:16' prior: 51047623!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook |

	cart := self createCart.
	cart add: 2 of: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	self assert: 2 equals:  (cashier checkout: cart withCreditCard: self validCreditCard).
	self assert: 1 equals: aSalesBook size.
	self assert: 2 * self itemInStorePrice equals: aSalesBook first.! !

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:27:16'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:27:16'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:27:16'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:27:16'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:27:16'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:27:16'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:27:16'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/16/2021 18:27:26' prior: 51047694!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier aSalesBook |
	
	cart := self createCart.
	cart add: self itemInStore.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	self should: [ (cashier checkout: cart withCreditCard: self expiredCreditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier expiredCreditCardErrorDescription.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:27:26'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:27:26'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:27:26'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:27:26'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:27:26'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:27:26'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:27:26'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/16/2021 18:28:26' prior: 51047793!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier aSalesBook messageError |

	cart := self createCart.
	cart add: self itemInStore.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: self defaultPriceList registerSalesOn: aSalesBook merchantProcessor: (self createMerchantProcessorThatRaisesError: messageError).
	
	
	self should: [ (cashier checkout: cart withCreditCard: self validCreditCard )]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/16/2021 18:29:03'!
createMerchantProcessorThatRaisesError: messageError
	|aMerchantProcessor|
	aMerchantProcessor := MerchantProcessorSimulator new.
	aMerchantProcessor raiseErrorOnCharge: messageError.
	^aMerchantProcessor

		
		
		! !

!methodRemoval: CashierTest #newCashierWithsalesBook: stamp: 'ET 6/16/2021 18:29:12'!
newCashierWithsalesBook: aSalesBook
	
	^Cashier with: self defaultPriceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
		
		!
!CashierTest methodsFor: 'support' stamp: 'ET 6/16/2021 18:35:23' prior: 51047872!
newCashierWithSalesBook: aSalesBook
	
	^self newCashierWithPriceList: self defaultPriceList salesBook: aSalesBook.
		
		! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 18:35:24'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 18:35:24'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 18:35:24'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 18:35:24'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 18:35:24'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 18:35:24'!
PASSED!

----SNAPSHOT----(16 June 2021 18:43:31) CuisUniversity-4532.image priorSource: 22816683!

----STARTUP---- (16 June 2021 20:21:50) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!


!CreditCardTest methodsFor: 'tests' stamp: 'ET 6/16/2021 20:44:18'!
test04ExpiredCreditCardIsExpired

	self assertCreditCardInstanceCreationRaisesErrorWhenOwnedBy: '    ' withNumber: '1234567890123456'.! !
!CreditCardTest methodsFor: 'tests' stamp: 'ET 6/16/2021 20:45:02' prior: 51048272!
test04ExpiredCreditCardIsExpired

	CreditCard owner: 'Juan'  number: '1234567890123456' expiration: GregorianMonthOfYear current previous.! !
!CreditCardTest methodsFor: 'tests' stamp: 'ET 6/16/2021 20:45:47' prior: 51048279!
test04ExpiredCreditCardIsExpired

	| creditCard |
	creditCard := CreditCard owner: 'Juan'  number: '1234567890123456' expiration: GregorianMonthOfYear current previous.
	
	
	self assert: (creditCard isExpiredOn: Date today).
	! !

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:45:52'!
ERROR!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 20:46:01'!
isExpiredOn: aDate 
	self shouldBeImplemented.! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 20:47:33' prior: 51048300!
isExpiredOn: aDate 
	
	^(GregorianMonthOfYear year: aDate year month: aDate month) < gregorianMonthOfYear.! !

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:47:36'!
ERROR!

aDate year!

aDate year!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 20:49:04' prior: 51048305!
isExpiredOn: aDate 
	
	^(GregorianMonthOfYear yearNumber: aDate yearNumber monthNumber: aDate monthNumber) < gregorianMonthOfYear.! !

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:49:06'!
ERROR!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 20:51:07' prior: 51048316!
isExpiredOn: aDate 
	
	^(GregorianMonthOfYear yearNumber: aDate yearNumber monthNumber: aDate monthIndex) < gregorianMonthOfYear.! !

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:51:09'!
FAILURE!
!CreditCardTest methodsFor: 'tests' stamp: 'ET 6/16/2021 20:51:20' prior: 51048287!
test04ExpiredCreditCardIsExpired

	| creditCard |
	creditCard := CreditCard owner: 'Juan'  number: '1234567890123456' expiration: GregorianMonthOfYear current next.
	
	
	self assert: (creditCard isExpiredOn: Date today).
	! !

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:51:22'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 20:51:22'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/16/2021 20:51:22'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 20:51:22'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:51:22'!
PASSED!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 20:51:37' prior: 51048327!
isExpiredOn: aDate 
	
	^true.! !

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:51:41'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 20:51:41'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/16/2021 20:51:41'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 20:51:41'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:51:41'!
PASSED!
!CreditCardTest methodsFor: 'tests' stamp: 'ET 6/16/2021 20:52:35'!
test05NonExpiredCreditCardIsNotExpired

	| creditCard |
	creditCard := CreditCard owner: 'Juan'  number: '1234567890123456' expiration: GregorianMonthOfYear current previous.
	
	
	self deny: (creditCard isExpiredOn: Date today).
	! !
!CreditCardTest methodsFor: 'tests' stamp: 'ET 6/16/2021 20:53:01' prior: 51048386!
test05NonExpiredCreditCardIsNotExpired

	| creditCard |
	creditCard := CreditCard owner: 'Juan'  number: '1234567890123456' expiration: GregorianMonthOfYear current next.
	
	
	self deny: (creditCard isExpiredOn: Date today).
	! !
!CreditCardTest methodsFor: 'tests' stamp: 'ET 6/16/2021 20:53:07' prior: 51048337!
test04ExpiredCreditCardIsExpired

	| creditCard |
	creditCard := CreditCard owner: 'Juan'  number: '1234567890123456' expiration: GregorianMonthOfYear current previous.
	
	
	self assert: (creditCard isExpiredOn: Date today).
	! !

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:53:08'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 20:53:08'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/16/2021 20:53:08'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 20:53:08'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:53:08'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/16/2021 20:53:08'!
FAILURE!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/16/2021 20:53:08'!
FAILURE!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 20:53:32' prior: 51048365!
isExpiredOn: aDate 
	
	^(GregorianMonthOfYear yearNumber: aDate yearNumber monthNumber: aDate monthIndex) > gregorianMonthOfYear.! !

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/16/2021 20:53:43'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:55:34'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 20:55:34'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/16/2021 20:55:34'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 20:55:34'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:55:34'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/16/2021 20:55:34'!
PASSED!
!Cashier methodsFor: 'assertions' stamp: 'ET 6/16/2021 20:56:27' prior: 51046684!
assertCreditCardIsNotExpired: aCreditCard
	
	(aCreditCard isExpiredOn: Date today) ifTrue: [self error: self class expiredCreditCardErrorDescription].! !

!methodRemoval: CreditCard #expirationDate stamp: 'ET 6/16/2021 20:56:34'!
expirationDate

	^gregorianMonthOfYear!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/16/2021 20:56:39'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/16/2021 20:56:39'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/16/2021 20:56:39'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/16/2021 20:56:39'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/16/2021 20:56:39'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/16/2021 20:56:39'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 20:56:43'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/16/2021 20:56:43'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/16/2021 20:56:43'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/16/2021 20:56:43'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/16/2021 20:56:43'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/16/2021 20:56:43'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/16/2021 20:56:43'!
PASSED!

!classDefinition: #CreditCard category: 'TusLibros' stamp: 'ET 6/16/2021 20:57:10'!
Object subclass: #CreditCard
	instanceVariableNames: 'ownerString creditCardNumberString expirationMonthOfYear'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CreditCard methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 20:57:10' prior: 51048441!
isExpiredOn: aDate 
	
	^(GregorianMonthOfYear yearNumber: aDate yearNumber monthNumber: aDate monthIndex) > expirationMonthOfYear.! !
!CreditCard methodsFor: 'as yet unclassified' stamp: 'ET 6/16/2021 20:57:10' prior: 51044592!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear 

	ownerString := anOwnerString.
	creditCardNumberString := aCreditCardNumberString.
	expirationMonthOfYear := aGregorianMonthOfYear.! !



----STARTUP---- (17 June 2021 09:59:31) as /home/julian/facu/ingenieria1/ambientesCuis/TusLibros2/CuisUniversity-4532.image!


----End fileIn of /home/julian/facu/ingenieria1/ejsIS1/20-TusLibros/TusLibros.st----!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/17/2021 10:00:28'!
PASSED!

----End fileIn of /home/julian/facu/ingenieria1/ambientesCuis/TusLibros2/Packages/TerseGuide.pck.st----!

2021 / 06!

2021\06!

2021/06!

2021/6!

2021/6/01!

1/6/2021!

1/6/2021!

1/6/2021!

1/6/2021!

1 / 6 / 2021!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/17/2021 10:16:07'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/17/2021 10:16:07'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/17/2021 10:16:07'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/17/2021 10:16:07'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/17/2021 10:16:07'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/17/2021 10:16:07'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/17/2021 10:16:07'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/17/2021 10:21:25'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/17/2021 10:21:25'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/17/2021 10:21:25'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/17/2021 10:21:25'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/17/2021 10:21:25'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/17/2021 10:21:25'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/17/2021 10:21:25'!
PASSED!

Dictionary with: self itemInStore -> self itemInStorePrice.!

Dictionary with: 'book' -> 123.50!

self includes: 'book'!

self includes: 123.50!

self includesKey: 'book'!

TestCase subclass: #XxxTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #XxxTest category: 'TusLibros' stamp: 'JA 6/17/2021 20:39:20'!
TestCase subclass: #XxxTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosMarket category: 'TusLibros' stamp: 'JA 6/17/2021 20:53:36'!
Object subclass: #TusLibrosMarket
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #ClientAuthenticatorSimulator category: 'TusLibros' stamp: 'JA 6/17/2021 20:53:48'!
Object subclass: #ClientAuthenticatorSimulator
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!XxxTest methodsFor: 'nil' stamp: 'JA 6/17/2021 20:53:20'!
test01

	| tusLibrosMarket |
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: ClientAuthenticatorSimulator new.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | self assert: 'Username or password invalid'  equals: exception messageText.
			self assert: tusLibrosMarket hasCarts.
		]
	
	
	
		! !

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 20:54:13'!
ERROR!
!TusLibrosMarket class methodsFor: 'instance creation' stamp: 'JA 6/17/2021 20:54:28'!
withClientAuthenticator: aClientAuthenticatorSimulator 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithClientAuthenticator: aClientAuthenticatorSimulator ! !
!TusLibrosMarket class methodsFor: 'instance creation' stamp: 'JA 6/17/2021 20:54:52' prior: 50863036!
withClientAuthenticator: aClientAuthenticator
	^self new initializeWithClientAuthenticator: aClientAuthenticator! !

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 20:54:53'!
ERROR!

!classDefinition: #TusLibrosMarket category: 'TusLibros' stamp: 'JA 6/17/2021 20:55:05'!
Object subclass: #TusLibrosMarket
	instanceVariableNames: 'clientAuthenticator'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosMarket methodsFor: 'initialization' stamp: 'JA 6/17/2021 20:55:05'!
initializeWithClientAuthenticator: aClientAuthenticator 
	self shouldBeImplemented.
	clientAuthenticator := aClientAuthenticator.! !
!TusLibrosMarket methodsFor: 'initialization' stamp: 'JA 6/17/2021 20:55:14' prior: 50863063!
initializeWithClientAuthenticator: aClientAuthenticator 
	clientAuthenticator := aClientAuthenticator.! !

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 20:55:16'!
ERROR!
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 20:55:26'!
createCartFor: aSmallInteger authenticatedWith: aString 
	self shouldBeImplemented.! !
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 20:57:32' prior: 50863079!
createCartFor: aUserId authenticatedWith: aPassword
	self error: 'Username or password invalid'.! !

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 20:57:33'!
ERROR!
!TusLibrosMarket methodsFor: '*Cuis-University-Model' stamp: 'JA 6/17/2021 20:57:42'!
hasCarts
	self shouldBeImplemented.! !
!TusLibrosMarket methodsFor: '*Cuis-University-Model' stamp: 'JA 6/17/2021 20:58:10' prior: 50863093!
hasCarts
	^ false! !

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 20:58:11'!
FAILURE!
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 20:58:25' prior: 50863018!
test01

	| tusLibrosMarket |
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: ClientAuthenticatorSimulator new.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | self assert: 'Username or password invalid'  equals: exception messageText.
			self deny: tusLibrosMarket hasCarts.
		]
	
	
	
		! !

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 20:58:25'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 20:58:25'!
PASSED!
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:02:39'!
test02

	| tusLibrosMarket aCartId |
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: ClientAuthenticatorSimulator new.
	
	aCartId := tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'.
			
	self assert: (tusLibrosMarket hasCartIdentified: aCartId).

	
	
	
		! !

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:02:45'!
ERROR!
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:04:09' prior: 50863085!
createCartFor: aUserId authenticatedWith: aPassword
	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	self error: 'Username or password invalid'.! !

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:04:13'!
ERROR!
!ClientAuthenticatorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:04:23'!
athenticateUser: aSmallInteger withPassword: aString 
	self shouldBeImplemented.! !

!classDefinition: #ClientAuthenticatorSimulator category: 'TusLibros' stamp: 'JA 6/17/2021 21:05:15'!
Object subclass: #ClientAuthenticatorSimulator
	instanceVariableNames: 'raiseAuthenticationError'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!ClientAuthenticatorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:05:12' prior: 50863150!
athenticateUser: aSmallInteger withPassword: aString 
	raiseAuthenticationError ifNotNil: [self error: 'Username or password invalid'].! !

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:05:22'!
ERROR!

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 21:07:10'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:07:10'!
ERROR!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:07:10'!
ERROR!

!classDefinition: #ClientAuthenticatorSimulator category: 'TusLibros' stamp: 'JA 6/17/2021 21:08:07'!
Object subclass: #ClientAuthenticatorSimulator
	instanceVariableNames: 'raiseAuthenticationError authenticationErrorMessage'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!ClientAuthenticatorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:08:05' prior: 50863165!
athenticateUser: aSmallInteger withPassword: aString 
	authenticationErrorMessage ifNotNil: [self error: authenticationErrorMessage].! !
!ClientAuthenticatorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:08:47'!
raseAuthenticationErrorWithMessage: anErrorMessage
	authenticationErrorMessage := anErrorMessage .! !
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:09:13' prior: 50863104!
test01

	| tusLibrosMarket |
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: ClientAuthenticatorSimulator new.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | | errorMessage |
	errorMessage _ 'Username or password invalid'.
	self assert: errorMessage  equals: exception messageText.
			self deny: tusLibrosMarket hasCarts.
		]
	
	
	
		! !
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:10:12' prior: 50863206!
test01

	| tusLibrosMarket errorMessage |
	errorMessage _ 'Username or password invalid'.
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: ClientAuthenticatorSimulator new.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: tusLibrosMarket hasCarts.
		]
	
	
	
		! !
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:10:29' prior: 50863224!
test01

	| tusLibrosMarket errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: clientAuthenticatorSimulator.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: tusLibrosMarket hasCarts.
		]
	
	
	
		! !
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:11:06' prior: 50863242!
test01

	| tusLibrosMarket errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: clientAuthenticatorSimulator.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: tusLibrosMarket hasCarts.
		]
	
	
	
		! !
!ClientAuthenticatorSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:11:34'!
raiseAuthenticationErrorWithMessage: anErrorMessage
	authenticationErrorMessage := anErrorMessage .! !

!methodRemoval: ClientAuthenticatorSimulator #raseAuthenticationErrorWithMessage: stamp: 'JA 6/17/2021 21:11:34'!
raseAuthenticationErrorWithMessage: anErrorMessage
	authenticationErrorMessage := anErrorMessage .!
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:12:00' prior: 50863263!
test01

	| tusLibrosMarket errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: clientAuthenticatorSimulator.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: tusLibrosMarket hasCarts.
		]
	
	
	
		! !

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 21:12:01'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 21:12:01'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:12:01'!
ERROR!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:12:01'!
ERROR!
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:14:25' prior: 50863124!
test02

	| tusLibrosMarket aCartId |
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: ClientAuthenticatorSimulator new.
	
	aCartId := tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: tusLibrosMarket hasCarts.
	self assert: (tusLibrosMarket hasCartIdentified: aCartId).

	
	
	
		! !
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:14:43' prior: 50863139!
createCartFor: aUserId authenticatedWith: aPassword
	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	! !

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:14:47'!
FAILURE!

!classDefinition: #TusLibrosMarket category: 'TusLibros' stamp: 'JA 6/17/2021 21:18:06'!
Object subclass: #TusLibrosMarket
	instanceVariableNames: 'clientAuthenticator carts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TusLibrosMarket category: 'TusLibros' stamp: 'JA 6/17/2021 21:18:09'!
Object subclass: #TusLibrosMarket
	instanceVariableNames: 'clientAuthenticator carts itemCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:18:01' prior: 50863343!
createCartFor: aUserId authenticatedWith: aPassword
	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	
	carts add: (Cart acceptingItemsOf: itemCatalog)
	
	
	! !

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:18:13'!
ERROR!

!classDefinition: #TusLibrosMarket category: 'TusLibros' stamp: 'JA 6/17/2021 21:21:07'!
Object subclass: #TusLibrosMarket
	instanceVariableNames: 'clientAuthenticator carts itemCatalog catalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TusLibrosMarket methodsFor: 'initialization' stamp: 'JA 6/17/2021 21:20:42'!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	catalog := aCatalog! !
!TusLibrosMarket class methodsFor: 'instance creation' stamp: 'JA 6/17/2021 21:22:56'!
withClientAuthenticator: aClientAuthenticator catalog: catalog 
	^self new initializeWithClientAuthenticator: aClientAuthenticator! !
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:22:56' prior: 50863329!
test02

	| tusLibrosMarket aCartId |
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	aCartId := tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: tusLibrosMarket hasCarts.
	self assert: (tusLibrosMarket hasCartIdentified: aCartId).

	
	
	
		! !
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:22:56' prior: 50863297!
test01

	| tusLibrosMarket errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: clientAuthenticatorSimulator catalog: OrderedCollection new.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: tusLibrosMarket hasCarts.
		]
	
	
	
		! !

!methodRemoval: TusLibrosMarket class #withClientAuthenticator: stamp: 'JA 6/17/2021 21:22:56'!
withClientAuthenticator: aClientAuthenticator
	^self new initializeWithClientAuthenticator: aClientAuthenticator!
!TusLibrosMarket class methodsFor: 'instance creation' stamp: 'JA 6/17/2021 21:23:23' prior: 50863397!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog 
	^self new initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog! !

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:23:40'!
FAILURE!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:24:24'!
FAILURE!
!TusLibrosMarket methodsFor: '*Cuis-University-Model' stamp: 'JA 6/17/2021 21:25:00' prior: 50863098!
hasCarts
	^ carts isEmpty not.! !

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:25:05'!
ERROR!
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:25:15'!
hasCartIdentified: aTusLibrosMarket 
	self shouldBeImplemented.! !
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:25:34' prior: 50863469!
hasCartIdentified: aTusLibrosMarket 
	^ true! !

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:25:35'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 21:25:35'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:25:35'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:25:40'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 21:25:40'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:25:40'!
PASSED!
!XxxTest methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:27:23'!
test03

	| tusLibrosMarket |
	tusLibrosMarket := TusLibrosMarket withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	
	self deny: tusLibrosMarket hasCarts.
	self deny: (tusLibrosMarket hasCartIdentified: 1).

	
	
	
		! !

!testRun: #XxxTest #test03 stamp: 'JA 6/17/2021 21:27:30'!
FAILURE!
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:31:00' prior: 50863475!
hasCartIdentified: aTusLibrosMarket 
 	carts at: aTusLibrosMarket ifAbsent: [^ false].
	^true! !

!testRun: #XxxTest #test03 stamp: 'JA 6/17/2021 21:31:02'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 21:31:02'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:31:02'!
ERROR!

!testRun: #XxxTest #test03 stamp: 'JA 6/17/2021 21:31:02'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:31:02'!
ERROR!

!testRun: #XxxTest #test03 stamp: 'JA 6/17/2021 21:31:58'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 21:31:58'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:31:58'!
ERROR!

!testRun: #XxxTest #test03 stamp: 'JA 6/17/2021 21:31:58'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:31:58'!
ERROR!

!testRun: #XxxTest #test03 stamp: 'JA 6/17/2021 21:32:31'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 21:32:31'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:32:31'!
ERROR!

!testRun: #XxxTest #test03 stamp: 'JA 6/17/2021 21:32:31'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:32:31'!
ERROR!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:32:56'!
ERROR!

!testRun: #XxxTest #test03 stamp: 'JA 6/17/2021 21:35:51'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 21:35:51'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:35:51'!
ERROR!

!testRun: #XxxTest #test03 stamp: 'JA 6/17/2021 21:35:51'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:35:51'!
ERROR!
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:38:37' prior: 50863506!
hasCartIdentified: aTusLibrosMarket 
 	carts at: aTusLibrosMarket ifAbsent: [^ false].
	^true! !
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:38:54' prior: 50863557!
hasCartIdentified: aCartId 
 	carts at: aCartId ifAbsent: [^ false].
	^true! !

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:38:55'!
ERROR!
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:39:48' prior: 50863564!
hasCartIdentified: aCartId 
 	carts at: aCartId ifAbsent: [^ false].
	^true.! !

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:39:50'!
ERROR!
!TusLibrosMarket methodsFor: 'as yet unclassified' stamp: 'JA 6/17/2021 21:44:00' prior: 50863369!
createCartFor: aUserId authenticatedWith: aPassword
	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	
	carts add: (Cart acceptingItemsOf: itemCatalog).
	^ 1
	
	! !

!testRun: #XxxTest #test01 stamp: 'JA 6/17/2021 21:44:05'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/17/2021 21:44:05'!
PASSED!

!testRun: #XxxTest #test03 stamp: 'JA 6/17/2021 21:44:05'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/18/2021 09:22:34'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/18/2021 09:22:34'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/18/2021 09:22:34'!
PASSED!

!testRun: #XxxTest #test03 stamp: 'JA 6/18/2021 09:22:34'!
PASSED!

!testRun: #XxxTest #test01 stamp: 'JA 6/18/2021 09:23:28'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/18/2021 09:23:28'!
PASSED!

!testRun: #XxxTest #test03 stamp: 'JA 6/18/2021 09:23:28'!
PASSED!

!methodRemoval: TusLibrosMarket #initializeWithClientAuthenticator: stamp: 'JA 6/18/2021 09:23:39'!
initializeWithClientAuthenticator: aClientAuthenticator 
	clientAuthenticator := aClientAuthenticator.!

!testRun: #XxxTest #test01 stamp: 'JA 6/18/2021 09:23:44'!
PASSED!

!testRun: #XxxTest #test02 stamp: 'JA 6/18/2021 09:23:44'!
PASSED!

!testRun: #XxxTest #test03 stamp: 'JA 6/18/2021 09:23:44'!
PASSED!

----QUIT----(18 June 2021 09:25:55) CuisUniversity-4532.image priorSource: 16885703!

----STARTUP---- (18 June 2021 09:27:08) as /home/julian/facu/ingenieria1/ambientesCuis/TusLibros2/CuisUniversity-4532.image!


----QUIT----(18 June 2021 09:27:16) CuisUniversity-4532.image priorSource: 17023100!

!classRenamed: #TusLibrosMarket as: #Store stamp: 'ET 6/22/2021 00:42:54'!
Smalltalk renameClassNamed: #TusLibrosMarket as: #Store!
!XxxTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:42:55' prior: 51055326!
test02

	| tusLibrosMarket aCartId |
	tusLibrosMarket := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	aCartId := tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: tusLibrosMarket hasCarts.
	self assert: (tusLibrosMarket hasCartIdentified: aCartId).

	
	
	
		! !
!XxxTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:42:55' prior: 51055340!
test03

	| tusLibrosMarket |
	tusLibrosMarket := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	
	self deny: tusLibrosMarket hasCarts.
	self deny: (tusLibrosMarket hasCartIdentified: 1).

	
	
	
		! !
!XxxTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:42:55' prior: 51055302!
test01

	| tusLibrosMarket errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	tusLibrosMarket := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: OrderedCollection new.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: tusLibrosMarket hasCarts.
		]
	
	
	
		! !

!classRenamed: #XxxTest as: #StoreTest stamp: 'ET 6/22/2021 00:43:03'!
Smalltalk renameClassNamed: #XxxTest as: #StoreTest!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:43:25'!
test01CanNotCreateCartWhenCredentialsCantBeAuthenticated

	| tusLibrosMarket errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	tusLibrosMarket := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: OrderedCollection new.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: tusLibrosMarket hasCarts.
		]
	
	
	
		! !

!methodRemoval: StoreTest #test01 stamp: 'ET 6/22/2021 00:43:25'!
test01

	| tusLibrosMarket errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	tusLibrosMarket := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: OrderedCollection new.
	
	
	self should: [
		tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: tusLibrosMarket hasCarts.
		]
	
	
	
		!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:43:38'!
test02StoreHasNewCreatedCart

	| tusLibrosMarket aCartId |
	tusLibrosMarket := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	aCartId := tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: tusLibrosMarket hasCarts.
	self assert: (tusLibrosMarket hasCartIdentified: aCartId).

	
	
	
		! !

!methodRemoval: StoreTest #test02 stamp: 'ET 6/22/2021 00:43:38'!
test02

	| tusLibrosMarket aCartId |
	tusLibrosMarket := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	aCartId := tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: tusLibrosMarket hasCarts.
	self assert: (tusLibrosMarket hasCartIdentified: aCartId).

	
	
	
		!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:43:50'!
test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts

	| tusLibrosMarket |
	tusLibrosMarket := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	
	self deny: tusLibrosMarket hasCarts.
	self deny: (tusLibrosMarket hasCartIdentified: 1).

	
	
	
		! !

!methodRemoval: StoreTest #test03 stamp: 'ET 6/22/2021 00:43:50'!
test03

	| tusLibrosMarket |
	tusLibrosMarket := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	
	self deny: tusLibrosMarket hasCarts.
	self deny: (tusLibrosMarket hasCartIdentified: 1).

	
	
	
		!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:43:55' prior: 51055836!
test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts

	| tusLibrosMarket |
	tusLibrosMarket := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	
	self deny: tusLibrosMarket hasCarts.
	self deny: (tusLibrosMarket hasCartIdentified: -1).

	
	
	
		! !

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/22/2021 00:43:56'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/22/2021 00:43:56'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/22/2021 00:43:56'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/22/2021 00:43:56'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:46:36'!
test04NewCreatedCartIsEmpty

	| tusLibrosMarket aCartId |
	tusLibrosMarket := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	aCartId := tusLibrosMarket createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: (tusLibrosMarket listCart: aCartId) isEmpty.
	
	
	
		! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/22/2021 00:46:39'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:46:48'!
listCart: aSmallInteger 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:47:08' prior: 51055901!
listCart: cartID
	^carts at: cartID.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/22/2021 00:47:11'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/22/2021 00:47:11'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/22/2021 00:47:11'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/22/2021 00:47:11'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/22/2021 00:47:11'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:49:15'!
test05CanNotListNonIdentifiedCart

	| tusLibrosMarket aCartId |
	tusLibrosMarket := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.

	self should: [tusLibrosMarket listCart: aCartId]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]
	
	
	
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:49:29' prior: 51055926!
test05CanNotListNonIdentifiedCart

	| tusLibrosMarket |
	tusLibrosMarket := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.

	self should: [tusLibrosMarket listCart: -1]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]
	
	
	
		! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/22/2021 00:49:33'!
ERROR!
!Store class methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:49:50'!
invalidCartIDErrorDescription
	self shouldBeImplemented.! !
!Store class methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:50:04' prior: 51055958!
invalidCartIDErrorDescription
	^'Cart ID is not in the system'! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/22/2021 00:50:06'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:50:44' prior: 51055906!
listCart: cartID
	
	self assertCartIDIsValid: cartID.

	^carts at: cartID.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/22/2021 00:50:47'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:50:51'!
assertCartIDIsValid: aSmallInteger 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:51:28' prior: 51055979!
assertCartIDIsValid: cartID
	
	(self hasCartIdentified: cartID) ifFalse: [self error: self class invalidCartIDErrorDescription ]! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/22/2021 00:51:30'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/22/2021 00:51:30'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/22/2021 00:51:30'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/22/2021 00:51:30'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/22/2021 00:51:30'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/22/2021 00:51:30'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:52:06' prior: 51055761!
test01CanNotCreateCartWhenCredentialsCantBeAuthenticated

	| store errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: OrderedCollection new.
	
	
	self should: [
		store createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: store hasCarts.
		]
	
	
	
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:52:20' prior: 51055809!
test02StoreHasNewCreatedCart

	| store aCartId |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	aCartId := store createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: store hasCarts.
	self assert: (store hasCartIdentified: aCartId).

	
	
	
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:52:28' prior: 51055859!
test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts

	| store |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	
	self deny: store hasCarts.
	self deny: (store hasCartIdentified: -1).

	
	
	
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:52:35' prior: 51055885!
test04NewCreatedCartIsEmpty

	| store aCartId |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	aCartId := store createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: (store listCart: aCartId) isEmpty.
	
	
	
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:52:47' prior: 51055941!
test05CanNotListNonIdentifiedCart

	| store |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.

	self should: [store listCart: -1]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]
	
	
	
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:58:36'!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: cartID1 ~= cartID2.
	self assert: (store listCart: cartID1) ~= (store listCart: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 00:58:38'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 00:59:25' prior: 51056084!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.

	self deny: cartID1 == cartID2.
	self deny: (store listCart: cartID1) == (store listCart: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 00:59:27'!
FAILURE!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 00:59:35'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 01:00:04' prior: 51056104!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.

	self deny: cartID1 = cartID2.
	self deny: (store listCart: cartID1) == (store listCart: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 01:00:06'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 01:00:19' prior: 51056127!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.

	self deny: (store listCart: cartID1) == (store listCart: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 01:00:20'!
FAILURE!

(store listCart: cartID1)!

(store listCart: cartID2)!

(store listCart: cartID1) == (store listCart: cartID2)!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 01:01:29' prior: 51056147!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.

	self deny: (store listCart: cartID1) = (store listCart: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 01:01:31'!
FAILURE!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 01:01:54' prior: 51056169!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.

	self deny: (store listCart: cartID1) == (store listCart: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 01:01:55'!
FAILURE!

(store listCart: cartID1)!

| cartID1 store |
store:= Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.!

| cartID1 store cart |
store:= Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

cart := store listCart: cartID1.!

| cartID1 store cart |
store:= Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

cart := store listCart: cartID1.

cart class!

| cartID1 store cart |
store:= Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

cart := store listCart: cartID1.

cart class!

| cartID1 store cart |
store:= Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

cart := store listCart: cartID1.

cart == self.!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 01:04:29' prior: 51056188!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.

	self deny: (store listCart: cartID1) = (store listCart: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 01:04:31'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 01:05:19' prior: 51055668!
createCartFor: aUserId authenticatedWith: aPassword
	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	
	carts add: (Cart acceptingItemsOf: itemCatalog).
	^carts size.
	
	! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 01:05:21'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/22/2021 01:05:21'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/22/2021 01:05:21'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/22/2021 01:05:21'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/22/2021 01:05:21'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/22/2021 01:05:21'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 01:05:21'!
PASSED!
!Store methodsFor: 'initialization' stamp: 'ET 6/22/2021 01:05:52' prior: 51055659!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog! !

Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'ET 6/22/2021 01:05:58'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/22/2021 01:07:48' prior: 51056243!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: OrderedCollection new.
	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.
	
	self deny: cartID1 = cartID2.
	self assert: (store hasCartIdentified: cartID1).
	self assert: (store hasCartIdentified: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 01:07:50'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/22/2021 01:07:50'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/22/2021 01:07:50'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/22/2021 01:07:50'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/22/2021 01:07:50'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/22/2021 01:07:50'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/22/2021 01:07:50'!
PASSED!

----STARTUP---- (23 June 2021 08:08:48) as /home/jaicardo/Descargas/Cuis/CuisUniversity-4532.image!


----End fileIn of /home/jaicardo/Descargas/Cuis/ejsIS1/20-TusLibros-iteracion-3/TusLibros.st----!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:09:07'!
PASSED!

Object subclass: #TestObjects
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #TestObjects category: 'TusLibros' stamp: 'JA 6/23/2021 08:10:21'!
Object subclass: #TestObjects
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!TestObjects methodsFor: 'nil' stamp: 'JA 6/23/2021 08:10:29'!
defaultCatalog
	
	^ Array with: self itemSellByTheStore! !
!TestObjects methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:10:56'!
itemSellByTheStore
	
	^ 'validBook'! !
!CartTest methodsFor: 'support' stamp: 'JA 6/23/2021 08:12:31' prior: 50860155!
defaultCatalog
	^ TestObjects new defaultCatalog .
	"^ Array with: self itemSellByTheStore."! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:12:37'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:12:37'!
PASSED!
!CartTest methodsFor: 'support' stamp: 'JA 6/23/2021 08:12:51' prior: 50860976!
defaultCatalog
	^ TestObjects new defaultCatalog.! !
!CartTest methodsFor: 'support' stamp: 'JA 6/23/2021 08:13:31' prior: 50860164!
itemSellByTheStore
	
	
	^ TestObjects new itemSellByTheStore .! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 08:13:31'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 08:13:31'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 08:13:31'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 08:13:31'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 08:13:31'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 08:13:31'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 08:13:31'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 08:13:31'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:13:38'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:13:38'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:16:40' prior: 50860417!
test01CanNotCreateCartWhenCredentialsCantBeAuthenticated

	| store errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: TestObjects new defaultCatalog .
	
	
	self should: [
		store createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: store hasCarts.
		]
	
	
	
		! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:16:41'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:16:41'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:16:41'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:16:41'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:16:41'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:16:41'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:16:41'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:17:09' prior: 50860441!
test02StoreHasNewCreatedCart

	| store aCartId |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog.
	
	aCartId := store createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: store hasCarts.
	self assert: (store hasCartIdentified: aCartId).

	
	
	
		! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:17:10'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:17:10'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:17:10'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:17:10'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:17:10'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:17:10'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:17:10'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:17:16' prior: 50860454!
test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts

	| store |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog.
	
	
	self deny: store hasCarts.
	self deny: (store hasCartIdentified: -1).

	
	
	
		! !

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:17:20'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:17:20'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:17:20'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:17:20'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:17:20'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:17:20'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:17:20'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:17:27' prior: 50860465!
test04NewCreatedCartIsEmpty

	| store aCartId |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog.
	
	aCartId := store createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: (store listCart: aCartId) isEmpty.
	
	
	
		! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:17:28'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:17:28'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:17:28'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:17:28'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:17:28'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:17:28'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:17:28'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:17:35' prior: 50860477!
test05CanNotListNonIdentifiedCart

	| store |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog.

	self should: [store listCart: -1]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]
	
	
	
		! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:17:38'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:17:38'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:17:38'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:17:38'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:17:38'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:17:38'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:17:38'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:17:46' prior: 50860490!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog.
	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.
	
	self deny: cartID1 = cartID2.
	self assert: (store hasCartIdentified: cartID1).
	self assert: (store hasCartIdentified: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:17:48'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:17:48'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:17:48'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:17:48'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:17:48'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:17:48'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:17:48'!
PASSED!
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:22:35'!
testStore
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog.! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 08:24:40' prior: 50861232!
test02StoreHasNewCreatedCart

	| store aCartId |
	store := self testStore .
	
	aCartId := store createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: store hasCarts.
	self assert: (store hasCartIdentified: aCartId).

	
	
	
		! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:24:42'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:24:42'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:24:42'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:24:42'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:24:42'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:24:42'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:24:42'!
PASSED!

!testRun: #StoreTest #testStore stamp: 'JA 6/23/2021 08:24:42'!
PASSED!
!StoreTest methodsFor: 'support' stamp: 'JA 6/23/2021 08:25:05'!
store
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:25:05' prior: 50861421!
test02StoreHasNewCreatedCart

	| store aCartId |
	store := self store .
	
	aCartId := store createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: store hasCarts.
	self assert: (store hasCartIdentified: aCartId).

	
	
	
		! !

!methodRemoval: StoreTest #testStore stamp: 'JA 6/23/2021 08:25:05'!
testStore
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog.!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:25:21'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:25:21'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:25:21'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:25:21'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:25:21'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:25:21'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:25:21'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:25:25'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:25:25'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 08:25:49' prior: 50861268!
test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts

	| store |
	store := self store .
	
	
	self deny: store hasCarts.
	self deny: (store hasCartIdentified: -1).

	
	
	
		! !

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:25:50'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:25:50'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:25:50'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:25:50'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:25:50'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:25:50'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:25:50'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 08:26:01' prior: 50861303!
test04NewCreatedCartIsEmpty

	| store aCartId |
	store := self store .
	
	aCartId := store createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: (store listCart: aCartId) isEmpty.
	
	
	
		! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:26:03'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:26:03'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:26:03'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:26:03'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:26:03'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:26:03'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:26:03'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 08:26:11' prior: 50861338!
test05CanNotListNonIdentifiedCart

	| store |
	store := self store .

	self should: [store listCart: -1]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]
	
	
	
		! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:26:12'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:26:12'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:26:12'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:26:12'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:26:12'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:26:12'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:26:12'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 08:26:18' prior: 50861374!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := self store .
	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.
	
	self deny: cartID1 = cartID2.
	self assert: (store hasCartIdentified: cartID1).
	self assert: (store hasCartIdentified: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:26:19'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:26:19'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:26:19'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:26:19'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:26:19'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:26:19'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:26:19'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 08:30:01'!
test07CartIsInvalidBefore30Min

	| store cartID1 |
	store := self store .	
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	

	self deny: (store hasCartIdentified: cartID1).


	
	
	
		! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:30:09'!
FAILURE!

!classDefinition: #Store category: 'TusLibros' stamp: 'JA 6/23/2021 08:38:28'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'JA 6/23/2021 08:38:31'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:38:25' prior: 50860837!
hasCartIdentified: aCartId 
	|currentCart|
 	currentCart := carts at: aCartId ifAbsent: [^ false].
	(lastTimeCartUsed at: aCartId + 30 minutes) < clock now.
	^true.! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:40:51' prior: 50861743!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	^ (lastTimeCartUsed at: aCartId + 30 minutes) < clock now.
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:41:42' prior: 50860828!
createCartFor: aUserId authenticatedWith: aPassword
	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	
	carts add: (Cart acceptingItemsOf: itemCatalog).
	lastTimeCartUsed add: clock now.
	^carts size.
	
	! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:41:53'!
ERROR!

FixedGregorianDate now!

GregorianDateTime now !
!Store class methodsFor: 'instance creation' stamp: 'JA 6/23/2021 08:47:57'!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock  
	^self new initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:47:57' prior: 50861184!
test01CanNotCreateCartWhenCredentialsCantBeAuthenticated

	| store errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: TestObjects new defaultCatalog clock: GregorianDateTime now .
	
	
	self should: [
		store createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: store hasCarts.
		]
	
	
	
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:47:57' prior: 50861455!
store
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: GregorianDateTime now.! !

!methodRemoval: Store class #withClientAuthenticator:catalog: stamp: 'JA 6/23/2021 08:47:57'!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog 
	^self new initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:48:14'!
ERROR!
!Store class methodsFor: 'instance creation' stamp: 'JA 6/23/2021 08:48:47' prior: 50861775!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock  
	^self new initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock! !
!Store class methodsFor: 'instance creation' stamp: 'JA 6/23/2021 08:49:31' prior: 50861828!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock  
	^self new initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog! !
!Store class methodsFor: 'instance creation' stamp: 'JA 6/23/2021 08:51:37' prior: 50861837!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock  
	^self new initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock.! !
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 08:52:04'!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:52:11'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:52:11'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:52:11'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:52:11'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:52:11'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:52:11'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:52:11'!
ERROR!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:52:55'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:52:55'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:52:55'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:52:55'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:52:55'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:52:55'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:52:55'!
ERROR!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:53:01'!
ERROR!

GregorianDateTime now!

GregorianDateTime now!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:54:28'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:55:00'!
ERROR!
!StoreTest methodsFor: 'support' stamp: 'JA 6/23/2021 08:55:21' prior: 50861809!
store
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: GregorianDateTime.! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:55:31'!
ERROR!
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 08:56:00' prior: 50861854!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:56:05'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:56:05'!
ERROR!

30minutes!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:56:55' prior: 50861752!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	^ (lastTimeCartUsed at: aCartId + 30minutes) < clock now.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:56:57'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:56:57'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:56:57'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:56:57'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:56:57'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:56:57'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:56:57'!
ERROR!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:57:04'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:57:04'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:57:04'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:57:04'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:57:04'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:57:04'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:57:04'!
ERROR!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:57:08'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 08:57:32' prior: 50861946!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	^ ((lastTimeCartUsed at: aCartId) + 30minutes) < clock now.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 08:57:33'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:57:33'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 08:57:33'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 08:57:33'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 08:57:33'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 08:57:33'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 08:57:33'!
ERROR!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 08:57:36'!
ERROR!

GregorianDateTime now + 30 minutes!

GregorianDateTime now + 3minutes!

pp:=GregorianDateTime now.!

pp next: 30 minutes!

pp next: 30!

pp next: 30 minutes!

FixedGregorianDate now!

GregorianDateTime now!

GregorianDateTime now + 30 minutes!

----End fileIn of /home/jaicardo/Descargas/Cuis/Packages/TerseGuide.pck.st----!

Time now!

Date now!

Date dateAndTimeNow !

Date dateAndTimeNow  + 30 minutes!

pp next: TimeUnits minutes!

TimeUnits minutes with:30!

TimeUnits minute with:30!

 30 minutes !

pp next: (TimeUnits minute with:30)!

pp next: 30 minutes!

pp next: (30 minutes)!

pp next: (30minutes)!

pp next: (TimeUnits minute with:30)!

pp!

TimeUnits minute with:30!

30 minutes!

TimeUnits minute with:30!

self + 30 minutes!

self + 30 minute!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:20:37'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:20:37'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:20:37'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:20:37'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:20:37'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:20:37'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:20:37'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:21:58' prior: 50862000!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with:30)) < clock now.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:21:59'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:21:59'!
FAILURE!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:21:59'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:21:59'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:21:59'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:21:59'!
FAILURE!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:21:59'!
PASSED!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:22:32' prior: 50865001!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with:30)) > clock now.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:22:33'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:22:33'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:22:33'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:22:33'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:22:33'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:22:33'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:22:33'!
FAILURE!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:22:33'!
FAILURE!

!classDefinition: #ClockSimulator category: 'TusLibros' stamp: 'JA 6/23/2021 09:25:01'!
Object subclass: #ClockSimulator
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:24:49' prior: 50861714!
test07CartIsInvalidBefore30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= ClockSimulator new.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	

	self deny: (store hasCartIdentified: cartID1).


	
	
	
		! !
!ClockSimulator class methodsFor: 'nil' stamp: 'JA 6/23/2021 09:26:51'!
with: aDateTime
	^ self new initializeWith: aDateTime.! !

!classDefinition: #ClockSimulator category: 'TusLibros' stamp: 'JA 6/23/2021 09:27:14'!
Object subclass: #ClockSimulator
	instanceVariableNames: 'dateTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!ClockSimulator methodsFor: 'nil' stamp: 'JA 6/23/2021 09:27:11'!
initializeWith: aDateTime
	dateTime := aDateTime .! !
!ClockSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:27:24'!
set: aDateTime
	dateTime := aDateTime .! !
!ClockSimulator methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:27:43'!
now
	^ dateTime ! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:29:45' prior: 50865071!
test07CartIsInvalidBefore30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= ClockSimulator with: (GregorianDateTime date: 2021/01/01 timeOfDay: 00:00:00).
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	

	self deny: (store hasCartIdentified: cartID1).


	
	
	
		! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:29:47'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:30:12'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:31:15'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:31:20'!
ERROR!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:32:43'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:32:43'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:32:43'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:32:43'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:32:43'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:32:43'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:32:43'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:32:43'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:32:53'!
ERROR!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:38:17' prior: 50865109!
test07CartIsInvalidBefore30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= ClockSimulator with: (GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:00:00).
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	

	self deny: (store hasCartIdentified: cartID1).


	
	
	
		! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:38:19'!
FAILURE!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:39:31' prior: 50865165!
test07CartIsInvalidBefore30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= ClockSimulator with: (GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:00:00).
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: (GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:31:00).

	self deny: (store hasCartIdentified: cartID1).


	
	
	
		! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:39:33'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:39:33'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:39:33'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:39:33'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:39:33'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:39:33'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:39:33'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:39:33'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:40:30'!
dateForTesting

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:00:00! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:40:30' prior: 50865187!
test07CartIsInvalidBefore30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= ClockSimulator with: (self dateForTesting).
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: (GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:31:00).

	self deny: (store hasCartIdentified: cartID1).


	
	
	
		! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:41:43'!
dateForTestingDelayed31Minutes

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:31:00! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:41:43' prior: 50865243!
test07CartIsInvalidBefore30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= ClockSimulator with: (self dateForTesting).
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: (self dateForTestingDelayed31Minutes).

	self deny: (store hasCartIdentified: cartID1).


	
	
	
		! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:41:58' prior: 50865271!
test07CartIsInvalidBefore30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= ClockSimulator with: self dateForTesting.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.

	self deny: (store hasCartIdentified: cartID1).


	
	
	
		! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:42:02'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:42:02'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:42:02'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:42:02'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:42:02'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:42:02'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:42:02'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:42:02'!
PASSED!
!StoreTest methodsFor: 'support' stamp: 'JA 6/23/2021 09:43:49' prior: 50861918!
store
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: (ClockSimulator with: self dateForTesting).! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:43:52'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:43:52'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:43:52'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:43:52'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:43:52'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:43:52'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:43:52'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:45:12'!
clockSimulator

	^ ClockSimulator with: self dateForTesting! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:45:12' prior: 50865288!
test07CartIsInvalidBefore30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.

	self deny: (store hasCartIdentified: cartID1).


	
	
	
		! !
!StoreTest methodsFor: 'support' stamp: 'JA 6/23/2021 09:45:52' prior: 50865330!
store
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: self clockSimulator.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:45:56'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:45:56'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:45:56'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:45:56'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:45:56'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:45:56'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:45:56'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 09:46:52' prior: 50865365!
test07CartIsInvalidBefore30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.

	self deny: (store hasCartIdentified: cartID1).
		! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:46:55'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:46:55'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:46:55'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:46:55'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:46:55'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:46:55'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:46:55'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:46:55'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:47:14'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:48:16'!
PASSED!

----QUIT----(23 June 2021 09:48:30) CuisUniversity-4532.image priorSource: 16909028!

----STARTUP---- (23 June 2021 09:51:15) as /home/jaicardo/Descargas/Cuis/CuisUniversity-4532.image!


!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:52:15'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:52:15'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:52:15'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:52:15'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:52:15'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:52:15'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:52:15'!
PASSED!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:53:37'!
expiredCart: aCartId

	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with:30)) > clock now! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:53:37' prior: 50865031!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	^ self expiredCart: aCartId.
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:54:08' prior: 50865660!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	^ self expiredCart: aCartId not.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:54:08'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:54:08'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:54:08'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:54:08'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:54:08'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:54:08'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:54:08'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:54:18' prior: 50865653!
expiredCart: aCartId

	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with:30)) < clock now! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:54:19'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:54:19'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:54:19'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:54:19'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:54:19'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:54:19'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:54:19'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:55:14' prior: 50865696!
expiredCart: aCartId

	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with:30)) < clock now! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:55:15'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:55:15'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:55:15'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:55:15'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:55:15'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:55:15'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:55:15'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:55:31' prior: 50865725!
expiredCart: aCartId

	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with:30)) <= clock now! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:55:32'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:55:32'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:55:32'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:55:32'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:55:32'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:55:32'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:55:32'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:55:37' prior: 50865754!
expiredCart: aCartId

	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with:30)) >= clock now! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:55:38'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:55:38'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:55:38'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:55:38'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:55:38'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:55:38'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:55:38'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:56:40' prior: 50865783!
expiredCart: aCartId

	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with:30)) > clock now! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:56:42'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:56:42'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:56:42'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:56:42'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:56:42'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:56:42'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:56:42'!
ERROR!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:56:45'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:56:54' prior: 50865812!
expiredCart: aCartId

	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with:30)) <= clock now! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:57:04' prior: 50865843!
expiredCart: aCartId

	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with:30)) < clock now! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:57:27' prior: 50865667!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	^ (self expiredCart: aCartId) not.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:57:28'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:57:28'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:57:28'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:57:28'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:57:28'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:57:28'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:57:28'!
PASSED!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:58:02' prior: 50865850!
expiredCart: aCartId

	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with: 30)) < clock now! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:58:46'!
maxInactiveTimeInMinutes

	^ 30! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:58:46' prior: 50865886!
expiredCart: aCartId

	^ ((lastTimeCartUsed at: aCartId) next: (TimeUnits minute with: self maxInactiveTimeInMinutes)) < clock now! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:59:09' prior: 50865892!
maxInactiveTimeInMinutes

	^ 50! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:59:10'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:59:10'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:59:10'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:59:10'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:59:10'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:59:10'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:59:10'!
FAILURE!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:59:10'!
FAILURE!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:59:15'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:59:15'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:59:15'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:59:15'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:59:15'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:59:15'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:59:15'!
FAILURE!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:59:15'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 09:59:25' prior: 50865903!
maxInactiveTimeInMinutes

	^ 30! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 09:59:28'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 09:59:28'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 09:59:28'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 09:59:28'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 09:59:28'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 09:59:28'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 09:59:28'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 10:00:39'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 10:00:39'!
PASSED!
!Behavior method!
defaultCatalog
	^ [
	(Array
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) with:
		([
		(self coverAll:
			{33 to: 36}) itemSellByTheStore ] valueCoveringAll:
			{38 to: 55}) ] valueCoveringAll:
		{27 to: 31}.! !
!Behavior method!
itemSellByTheStore
	^ 'validBook' coverAll:
		{25 to: 35}.! !
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWith:
			(aPriceList
				cover: (112 to: 121)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (140 to: 149)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessor
				cover: (170 to: 187)
				declaredAt: (65 to: 82)) ] valueCoveringAll:
		{96 to: 110. 123 to: 138. 151 to: 168}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	(priceList _ aPriceList
		cover: (111 to: 120)
		declaredAt: (17 to: 26))
		cover: (98 to: 106)
		declaredAt: (98 to: 106).
	(salesBook _ aSalesBook
		cover: (137 to: 146)
		declaredAt: (45 to: 54))
		cover: (124 to: 132)
		declaredAt: (124 to: 132).
	(merchantProcessor _ aMerchantProcessor
		cover: (171 to: 188)
		declaredAt: (75 to: 92))
		cover: (150 to: 166)
		declaredAt: (150 to: 166).! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{89 to: 121}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (128 to: 134)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (159 to: 164)
			declaredAt: (150 to: 155)) isDigit ] valueCoveringAll:
			{166 to: 172} ]] valueCoveringAll:
		{136 to: 146}) ifFalse: [
		[
		(self coverAll:
			{187 to: 190}) error:
			([
			(self coverAll:
				{199 to: 202}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{204 to: 236}) ] valueCoveringAll:
			{192 to: 197} ]] valueCoveringAll:
		{177 to: 184}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{103 to: 135}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(expirationMonthOfYear _ aGregorianMonthOfYear
		cover: (209 to: 229)
		declaredAt: (76 to: 96))
		cover: (184 to: 204)
		declaredAt: (184 to: 204).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice |
	[
	(self coverAll:
		{61 to: 64}) assertCartIsNotEmpty:
		(aCart
			cover: (88 to: 92)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{66 to: 86}.
	[
	(self coverAll:
		{96 to: 99}) assertCreditCardIsNotExpired:
		(aCreditCard
			cover: (131 to: 141)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{101 to: 129}.
	(totalPrice _ 0 coverAll:
		{159 to: 159})
		cover: (145 to: 154)
		declaredAt: (48 to: 57).
	[
	(aCart
		cover: (163 to: 167)
		declaredAt: (11 to: 15)) do: [ :anElement |
		(totalPrice _ [
		([
		(totalPrice
			cover: (187 to: 196)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (214 to: 222)
				declaredAt: (214 to: 222)) ] valueCoveringAll:
			{212 to: 212})
			at:
				(anElement
					cover: (228 to: 236)
					declaredAt: (175 to: 183))
			ifAbsent: [
				[
				(self coverAll:
					{249 to: 252}) raiseItemNotInPriceListError ] valueCoveringAll:
					{254 to: 281} ]] valueCoveringAll:
			{224 to: 226. 238 to: 246})
			cover: (201 to: 210)
			declaredAt: (48 to: 57) ]] valueCoveringAll:
		{169 to: 171}.
	[
	(merchantProcessor
		cover: (288 to: 304)
		declaredAt: (288 to: 304))
		charge:
			(totalPrice
				cover: (314 to: 323)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (330 to: 340)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{306 to: 312. 326 to: 328}.
	[
	(salesBook
		cover: (345 to: 353)
		declaredAt: (345 to: 353)) add:
		(totalPrice
			cover: (360 to: 369)
			declaredAt: (48 to: 57)) ] valueCoveringAll:
		{355 to: 358}.
	^ totalPrice
		cover: (375 to: 384)
		declaredAt: (48 to: 57).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) emptyCartErrorDescription ] valueCoveringAll:
				{80 to: 104}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
emptyCartErrorDescription
	^ 'The cart is empty' coverAll:
		{29 to: 47}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
assertCreditCardIsNotExpired: aCreditCard
	[
	([
	(aCreditCard
		cover: (47 to: 57)
		declaredAt: (31 to: 41)) isExpiredOn:
		([
		(Date
			cover: (72 to: 75)
			declaredAt: (72 to: 75)) today ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{59 to: 70}) ifTrue: [
		[
		(self coverAll:
			{93 to: 96}) error:
			([
			([
			(self coverAll:
				{105 to: 108}) class ] valueCoveringAll:
				{110 to: 114}) expiredCreditCardErrorDescription ] valueCoveringAll:
				{116 to: 148}) ] valueCoveringAll:
			{98 to: 103} ]] valueCoveringAll:
		{84 to: 90}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	([
	(GregorianMonthOfYear
		cover: (26 to: 45)
		declaredAt: (26 to: 45))
		yearNumber:
			([
			(aDate
				cover: (59 to: 63)
				declaredAt: (14 to: 18)) yearNumber ] valueCoveringAll:
				{65 to: 74})
		monthNumber:
			([
			(aDate
				cover: (89 to: 93)
				declaredAt: (14 to: 18)) monthIndex ] valueCoveringAll:
				{95 to: 104}) ] valueCoveringAll:
		{47 to: 57. 76 to: 87}) >
		(expirationMonthOfYear
			cover: (109 to: 129)
			declaredAt: (109 to: 129)) ] valueCoveringAll:
		{107 to: 107}.! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
raiseItemNotInPriceListError
	^ [
	(self coverAll:
		{34 to: 37}) error:
		([
		([
		(self coverAll:
			{46 to: 49}) class ] valueCoveringAll:
			{51 to: 55}) itemNotInPriceListErrorDescription ] valueCoveringAll:
			{57 to: 90}) ] valueCoveringAll:
		{39 to: 44}.! !
!Behavior method!
itemNotInPriceListErrorDescription
	^ 'An item in the cart is not in the price list' coverAll:
		{38 to: 83}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
expiredCreditCardErrorDescription
	^ 'The credit card is expired' coverAll:
		{37 to: 64}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
invalidCreditCardErrorDescription
	^ 'Los datos de la tarjeta de crdito son invlidos' coverAll:
		{37 to: 86}.! !

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
raiseAuthenticationErrorWithMessage: anErrorMessage
	(authenticationErrorMessage _ anErrorMessage
		cover: (84 to: 97)
		declaredAt: (38 to: 51))
		cover: (54 to: 79)
		declaredAt: (54 to: 79).! !
!Behavior method!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock
	^ [
	([
	(self coverAll:
		{83 to: 86}) new ] valueCoveringAll:
		{88 to: 90})
		initializeWithClientAuthenticator:
			(aClientAuthenticator
				cover: (127 to: 146)
				declaredAt: (26 to: 45))
		catalog:
			(aCatalog
				cover: (157 to: 164)
				declaredAt: (56 to: 63))
		clock:
			(aClock
				cover: (173 to: 178)
				declaredAt: (72 to: 77)) ] valueCoveringAll:
		{92 to: 125. 148 to: 155. 166 to: 171}.! !
!Behavior method!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock
	(clientAuthenticator _ aClientAuthenticator
		cover: (113 to: 132)
		declaredAt: (36 to: 55))
		cover: (90 to: 108)
		declaredAt: (90 to: 108).
	(carts _ [
	(OrderedCollection
		cover: (145 to: 161)
		declaredAt: (145 to: 161)) new ] valueCoveringAll:
		{163 to: 165})
		cover: (136 to: 140)
		declaredAt: (136 to: 140).
	(itemCatalog _ aCatalog
		cover: (184 to: 191)
		declaredAt: (66 to: 73))
		cover: (169 to: 179)
		declaredAt: (169 to: 179).
	(clock _ aClock
		cover: (204 to: 209)
		declaredAt: (82 to: 87))
		cover: (195 to: 199)
		declaredAt: (195 to: 199).
	(lastTimeCartUsed _ [
	(OrderedCollection
		cover: (232 to: 248)
		declaredAt: (145 to: 161)) new ] valueCoveringAll:
		{250 to: 252})
		cover: (213 to: 228)
		declaredAt: (213 to: 228).! !
!Behavior method!
createCartFor: aUserId authenticatedWith: aPassword
	[
	(clientAuthenticator
		cover: (54 to: 72)
		declaredAt: (54 to: 72))
		athenticateUser:
			(aUserId
				cover: (91 to: 97)
				declaredAt: (16 to: 22))
		withPassword:
			(aPassword
				cover: (113 to: 121)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{74 to: 89. 99 to: 111}.
	[
	(carts
		cover: (128 to: 132)
		declaredAt: (128 to: 132)) add:
		([
		(Cart
			cover: (140 to: 143)
			declaredAt: (140 to: 143)) acceptingItemsOf:
			(itemCatalog
				cover: (163 to: 173)
				declaredAt: (163 to: 173)) ] valueCoveringAll:
			{145 to: 161}) ] valueCoveringAll:
		{134 to: 137}.
	[
	(lastTimeCartUsed
		cover: (178 to: 193)
		declaredAt: (178 to: 193)) add:
		([
		(clock
			cover: (200 to: 204)
			declaredAt: (200 to: 204)) now ] valueCoveringAll:
			{206 to: 208}) ] valueCoveringAll:
		{195 to: 198}.
	^ [
	(carts
		cover: (213 to: 217)
		declaredAt: (128 to: 132)) size ] valueCoveringAll:
		{219 to: 222}.! !
!Behavior method!
athenticateUser: aSmallInteger withPassword: aString
	[
	(authenticationErrorMessage
		cover: (56 to: 81)
		declaredAt: (56 to: 81)) ifNotNil: [
		[
		(self coverAll:
			{94 to: 97}) error:
			(authenticationErrorMessage
				cover: (106 to: 131)
				declaredAt: (56 to: 81)) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{83 to: 91}.! !
!Behavior method!
hasCarts
	^ [
	([
	(carts
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}) not ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
with: aDateTime
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) initializeWith:
		(aDateTime
			cover: (45 to: 53)
			declaredAt: (7 to: 15)) ] valueCoveringAll:
		{29 to: 43}.! !
!Behavior method!
initializeWith: aDateTime
	(dateTime _ aDateTime
		cover: (40 to: 48)
		declaredAt: (17 to: 25))
		cover: (28 to: 35)
		declaredAt: (28 to: 35).! !
!Behavior method!
now
	^ dateTime
		cover: (8 to: 15)
		declaredAt: (8 to: 15).! !
!Behavior method!
hasCartIdentified: aCartId
	[
	(carts
		cover: (33 to: 37)
		declaredAt: (33 to: 37))
		at:
			(aCartId
				cover: (43 to: 49)
				declaredAt: (20 to: 26))
		ifAbsent: [ ^ false coverAll:
				{64 to: 68} ]] valueCoveringAll:
		{39 to: 41. 51 to: 59}.
	^ [
	([
	(self coverAll:
		{76 to: 79}) expiredCart:
		(aCartId
			cover: (94 to: 100)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{81 to: 92}) not ] valueCoveringAll:
		{103 to: 105}.! !
!Behavior method!
expiredCart: aCartId
	^ [
	([
	([
	(lastTimeCartUsed
		cover: (28 to: 43)
		declaredAt: (28 to: 43)) at:
		(aCartId
			cover: (49 to: 55)
			declaredAt: (14 to: 20)) ] valueCoveringAll:
		{45 to: 47}) next:
		([
		([
		(TimeUnits
			cover: (65 to: 73)
			declaredAt: (65 to: 73)) minute ] valueCoveringAll:
			{75 to: 80}) with:
			([
			(self coverAll:
				{88 to: 91}) maxInactiveTimeInMinutes ] valueCoveringAll:
				{93 to: 116}) ] valueCoveringAll:
			{82 to: 86}) ] valueCoveringAll:
		{58 to: 62}) <
		([
		(clock
			cover: (122 to: 126)
			declaredAt: (122 to: 126)) now ] valueCoveringAll:
			{128 to: 130}) ] valueCoveringAll:
		{120 to: 120}.! !
!Behavior method!
maxInactiveTimeInMinutes
	^ 30 coverAll:
		{30 to: 31}.! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
listCart: cartID
	[
	(self coverAll:
		{21 to: 24}) assertCartIDIsValid:
		(cartID
			cover: (47 to: 52)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{26 to: 45}.
	^ [
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(cartID
			cover: (68 to: 73)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{64 to: 66}.! !
!Behavior method!
assertCartIDIsValid: cartID
	[
	([
	(self coverAll:
		{33 to: 36}) hasCartIdentified:
		(cartID
			cover: (57 to: 62)
			declaredAt: (22 to: 27)) ] valueCoveringAll:
		{38 to: 55}) ifFalse: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) invalidCartIDErrorDescription ] valueCoveringAll:
				{98 to: 126}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{65 to: 72}.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
invalidCartIDErrorDescription
	^ 'Cart ID is not in the system' coverAll:
		{33 to: 62}.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 10:00:53'!
PASSED!
!Behavior method!
set: aDateTime
	(dateTime _ aDateTime
		cover: (29 to: 37)
		declaredAt: (6 to: 14))
		cover: (17 to: 24)
		declaredAt: (17 to: 24).! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 10:00:53'!
PASSED!

!methodRemoval: Store #initializeWithClientAuthenticator:catalog: stamp: 'JA 6/23/2021 10:01:14'!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog!
!Behavior method!
defaultCatalog
	^ [
	(Array
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) with:
		([
		(self coverAll:
			{33 to: 36}) itemSellByTheStore ] valueCoveringAll:
			{38 to: 55}) ] valueCoveringAll:
		{27 to: 31}.! !
!Behavior method!
itemSellByTheStore
	^ 'validBook' coverAll:
		{25 to: 35}.! !
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 10:01:24'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 10:01:24'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 10:01:24'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWith:
			(aPriceList
				cover: (112 to: 121)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (140 to: 149)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessor
				cover: (170 to: 187)
				declaredAt: (65 to: 82)) ] valueCoveringAll:
		{96 to: 110. 123 to: 138. 151 to: 168}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	(priceList _ aPriceList
		cover: (111 to: 120)
		declaredAt: (17 to: 26))
		cover: (98 to: 106)
		declaredAt: (98 to: 106).
	(salesBook _ aSalesBook
		cover: (137 to: 146)
		declaredAt: (45 to: 54))
		cover: (124 to: 132)
		declaredAt: (124 to: 132).
	(merchantProcessor _ aMerchantProcessor
		cover: (171 to: 188)
		declaredAt: (75 to: 92))
		cover: (150 to: 166)
		declaredAt: (150 to: 166).! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{89 to: 121}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (128 to: 134)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (159 to: 164)
			declaredAt: (150 to: 155)) isDigit ] valueCoveringAll:
			{166 to: 172} ]] valueCoveringAll:
		{136 to: 146}) ifFalse: [
		[
		(self coverAll:
			{187 to: 190}) error:
			([
			(self coverAll:
				{199 to: 202}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{204 to: 236}) ] valueCoveringAll:
			{192 to: 197} ]] valueCoveringAll:
		{177 to: 184}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{103 to: 135}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(expirationMonthOfYear _ aGregorianMonthOfYear
		cover: (209 to: 229)
		declaredAt: (76 to: 96))
		cover: (184 to: 204)
		declaredAt: (184 to: 204).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice |
	[
	(self coverAll:
		{61 to: 64}) assertCartIsNotEmpty:
		(aCart
			cover: (88 to: 92)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{66 to: 86}.
	[
	(self coverAll:
		{96 to: 99}) assertCreditCardIsNotExpired:
		(aCreditCard
			cover: (131 to: 141)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{101 to: 129}.
	(totalPrice _ 0 coverAll:
		{159 to: 159})
		cover: (145 to: 154)
		declaredAt: (48 to: 57).
	[
	(aCart
		cover: (163 to: 167)
		declaredAt: (11 to: 15)) do: [ :anElement |
		(totalPrice _ [
		([
		(totalPrice
			cover: (187 to: 196)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (214 to: 222)
				declaredAt: (214 to: 222)) ] valueCoveringAll:
			{212 to: 212})
			at:
				(anElement
					cover: (228 to: 236)
					declaredAt: (175 to: 183))
			ifAbsent: [
				[
				(self coverAll:
					{249 to: 252}) raiseItemNotInPriceListError ] valueCoveringAll:
					{254 to: 281} ]] valueCoveringAll:
			{224 to: 226. 238 to: 246})
			cover: (201 to: 210)
			declaredAt: (48 to: 57) ]] valueCoveringAll:
		{169 to: 171}.
	[
	(merchantProcessor
		cover: (288 to: 304)
		declaredAt: (288 to: 304))
		charge:
			(totalPrice
				cover: (314 to: 323)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (330 to: 340)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{306 to: 312. 326 to: 328}.
	[
	(salesBook
		cover: (345 to: 353)
		declaredAt: (345 to: 353)) add:
		(totalPrice
			cover: (360 to: 369)
			declaredAt: (48 to: 57)) ] valueCoveringAll:
		{355 to: 358}.
	^ totalPrice
		cover: (375 to: 384)
		declaredAt: (48 to: 57).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) emptyCartErrorDescription ] valueCoveringAll:
				{80 to: 104}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
emptyCartErrorDescription
	^ 'The cart is empty' coverAll:
		{29 to: 47}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
assertCreditCardIsNotExpired: aCreditCard
	[
	([
	(aCreditCard
		cover: (47 to: 57)
		declaredAt: (31 to: 41)) isExpiredOn:
		([
		(Date
			cover: (72 to: 75)
			declaredAt: (72 to: 75)) today ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{59 to: 70}) ifTrue: [
		[
		(self coverAll:
			{93 to: 96}) error:
			([
			([
			(self coverAll:
				{105 to: 108}) class ] valueCoveringAll:
				{110 to: 114}) expiredCreditCardErrorDescription ] valueCoveringAll:
				{116 to: 148}) ] valueCoveringAll:
			{98 to: 103} ]] valueCoveringAll:
		{84 to: 90}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	([
	(GregorianMonthOfYear
		cover: (26 to: 45)
		declaredAt: (26 to: 45))
		yearNumber:
			([
			(aDate
				cover: (59 to: 63)
				declaredAt: (14 to: 18)) yearNumber ] valueCoveringAll:
				{65 to: 74})
		monthNumber:
			([
			(aDate
				cover: (89 to: 93)
				declaredAt: (14 to: 18)) monthIndex ] valueCoveringAll:
				{95 to: 104}) ] valueCoveringAll:
		{47 to: 57. 76 to: 87}) >
		(expirationMonthOfYear
			cover: (109 to: 129)
			declaredAt: (109 to: 129)) ] valueCoveringAll:
		{107 to: 107}.! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
raiseItemNotInPriceListError
	^ [
	(self coverAll:
		{34 to: 37}) error:
		([
		([
		(self coverAll:
			{46 to: 49}) class ] valueCoveringAll:
			{51 to: 55}) itemNotInPriceListErrorDescription ] valueCoveringAll:
			{57 to: 90}) ] valueCoveringAll:
		{39 to: 44}.! !
!Behavior method!
itemNotInPriceListErrorDescription
	^ 'An item in the cart is not in the price list' coverAll:
		{38 to: 83}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 10:01:24'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
expiredCreditCardErrorDescription
	^ 'The credit card is expired' coverAll:
		{37 to: 64}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
invalidCreditCardErrorDescription
	^ 'Los datos de la tarjeta de crdito son invlidos' coverAll:
		{37 to: 86}.! !

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 10:01:24'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 10:01:24'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 10:01:24'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 10:01:24'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
raiseAuthenticationErrorWithMessage: anErrorMessage
	(authenticationErrorMessage _ anErrorMessage
		cover: (84 to: 97)
		declaredAt: (38 to: 51))
		cover: (54 to: 79)
		declaredAt: (54 to: 79).! !
!Behavior method!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock
	^ [
	([
	(self coverAll:
		{83 to: 86}) new ] valueCoveringAll:
		{88 to: 90})
		initializeWithClientAuthenticator:
			(aClientAuthenticator
				cover: (127 to: 146)
				declaredAt: (26 to: 45))
		catalog:
			(aCatalog
				cover: (157 to: 164)
				declaredAt: (56 to: 63))
		clock:
			(aClock
				cover: (173 to: 178)
				declaredAt: (72 to: 77)) ] valueCoveringAll:
		{92 to: 125. 148 to: 155. 166 to: 171}.! !
!Behavior method!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock
	(clientAuthenticator _ aClientAuthenticator
		cover: (113 to: 132)
		declaredAt: (36 to: 55))
		cover: (90 to: 108)
		declaredAt: (90 to: 108).
	(carts _ [
	(OrderedCollection
		cover: (145 to: 161)
		declaredAt: (145 to: 161)) new ] valueCoveringAll:
		{163 to: 165})
		cover: (136 to: 140)
		declaredAt: (136 to: 140).
	(itemCatalog _ aCatalog
		cover: (184 to: 191)
		declaredAt: (66 to: 73))
		cover: (169 to: 179)
		declaredAt: (169 to: 179).
	(clock _ aClock
		cover: (204 to: 209)
		declaredAt: (82 to: 87))
		cover: (195 to: 199)
		declaredAt: (195 to: 199).
	(lastTimeCartUsed _ [
	(OrderedCollection
		cover: (232 to: 248)
		declaredAt: (145 to: 161)) new ] valueCoveringAll:
		{250 to: 252})
		cover: (213 to: 228)
		declaredAt: (213 to: 228).! !
!Behavior method!
createCartFor: aUserId authenticatedWith: aPassword
	[
	(clientAuthenticator
		cover: (54 to: 72)
		declaredAt: (54 to: 72))
		athenticateUser:
			(aUserId
				cover: (91 to: 97)
				declaredAt: (16 to: 22))
		withPassword:
			(aPassword
				cover: (113 to: 121)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{74 to: 89. 99 to: 111}.
	[
	(carts
		cover: (128 to: 132)
		declaredAt: (128 to: 132)) add:
		([
		(Cart
			cover: (140 to: 143)
			declaredAt: (140 to: 143)) acceptingItemsOf:
			(itemCatalog
				cover: (163 to: 173)
				declaredAt: (163 to: 173)) ] valueCoveringAll:
			{145 to: 161}) ] valueCoveringAll:
		{134 to: 137}.
	[
	(lastTimeCartUsed
		cover: (178 to: 193)
		declaredAt: (178 to: 193)) add:
		([
		(clock
			cover: (200 to: 204)
			declaredAt: (200 to: 204)) now ] valueCoveringAll:
			{206 to: 208}) ] valueCoveringAll:
		{195 to: 198}.
	^ [
	(carts
		cover: (213 to: 217)
		declaredAt: (128 to: 132)) size ] valueCoveringAll:
		{219 to: 222}.! !
!Behavior method!
athenticateUser: aSmallInteger withPassword: aString
	[
	(authenticationErrorMessage
		cover: (56 to: 81)
		declaredAt: (56 to: 81)) ifNotNil: [
		[
		(self coverAll:
			{94 to: 97}) error:
			(authenticationErrorMessage
				cover: (106 to: 131)
				declaredAt: (56 to: 81)) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{83 to: 91}.! !
!Behavior method!
hasCarts
	^ [
	([
	(carts
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}) not ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
with: aDateTime
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) initializeWith:
		(aDateTime
			cover: (45 to: 53)
			declaredAt: (7 to: 15)) ] valueCoveringAll:
		{29 to: 43}.! !
!Behavior method!
initializeWith: aDateTime
	(dateTime _ aDateTime
		cover: (40 to: 48)
		declaredAt: (17 to: 25))
		cover: (28 to: 35)
		declaredAt: (28 to: 35).! !
!Behavior method!
now
	^ dateTime
		cover: (8 to: 15)
		declaredAt: (8 to: 15).! !
!Behavior method!
hasCartIdentified: aCartId
	[
	(carts
		cover: (33 to: 37)
		declaredAt: (33 to: 37))
		at:
			(aCartId
				cover: (43 to: 49)
				declaredAt: (20 to: 26))
		ifAbsent: [ ^ false coverAll:
				{64 to: 68} ]] valueCoveringAll:
		{39 to: 41. 51 to: 59}.
	^ [
	([
	(self coverAll:
		{76 to: 79}) expiredCart:
		(aCartId
			cover: (94 to: 100)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{81 to: 92}) not ] valueCoveringAll:
		{103 to: 105}.! !
!Behavior method!
expiredCart: aCartId
	^ [
	([
	([
	(lastTimeCartUsed
		cover: (28 to: 43)
		declaredAt: (28 to: 43)) at:
		(aCartId
			cover: (49 to: 55)
			declaredAt: (14 to: 20)) ] valueCoveringAll:
		{45 to: 47}) next:
		([
		([
		(TimeUnits
			cover: (65 to: 73)
			declaredAt: (65 to: 73)) minute ] valueCoveringAll:
			{75 to: 80}) with:
			([
			(self coverAll:
				{88 to: 91}) maxInactiveTimeInMinutes ] valueCoveringAll:
				{93 to: 116}) ] valueCoveringAll:
			{82 to: 86}) ] valueCoveringAll:
		{58 to: 62}) <
		([
		(clock
			cover: (122 to: 126)
			declaredAt: (122 to: 126)) now ] valueCoveringAll:
			{128 to: 130}) ] valueCoveringAll:
		{120 to: 120}.! !
!Behavior method!
maxInactiveTimeInMinutes
	^ 30 coverAll:
		{30 to: 31}.! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 10:01:24'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
listCart: cartID
	[
	(self coverAll:
		{21 to: 24}) assertCartIDIsValid:
		(cartID
			cover: (47 to: 52)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{26 to: 45}.
	^ [
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(cartID
			cover: (68 to: 73)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{64 to: 66}.! !
!Behavior method!
assertCartIDIsValid: cartID
	[
	([
	(self coverAll:
		{33 to: 36}) hasCartIdentified:
		(cartID
			cover: (57 to: 62)
			declaredAt: (22 to: 27)) ] valueCoveringAll:
		{38 to: 55}) ifFalse: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) invalidCartIDErrorDescription ] valueCoveringAll:
				{98 to: 126}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{65 to: 72}.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
invalidCartIDErrorDescription
	^ 'Cart ID is not in the system' coverAll:
		{33 to: 62}.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 10:01:24'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
set: aDateTime
	(dateTime _ aDateTime
		cover: (29 to: 37)
		declaredAt: (6 to: 14))
		cover: (17 to: 24)
		declaredAt: (17 to: 24).! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 10:01:24'!
PASSED!
!Behavior method!
defaultCatalog
	^ [
	(Array
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) with:
		([
		(self coverAll:
			{33 to: 36}) itemSellByTheStore ] valueCoveringAll:
			{38 to: 55}) ] valueCoveringAll:
		{27 to: 31}.! !
!Behavior method!
itemSellByTheStore
	^ 'validBook' coverAll:
		{25 to: 35}.! !
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 10:01:54'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 10:01:54'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 10:01:54'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 10:01:54'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 10:01:54'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 10:01:54'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 10:01:54'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 10:01:54'!
PASSED!
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWith:
			(aPriceList
				cover: (112 to: 121)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (140 to: 149)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessor
				cover: (170 to: 187)
				declaredAt: (65 to: 82)) ] valueCoveringAll:
		{96 to: 110. 123 to: 138. 151 to: 168}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	(priceList _ aPriceList
		cover: (111 to: 120)
		declaredAt: (17 to: 26))
		cover: (98 to: 106)
		declaredAt: (98 to: 106).
	(salesBook _ aSalesBook
		cover: (137 to: 146)
		declaredAt: (45 to: 54))
		cover: (124 to: 132)
		declaredAt: (124 to: 132).
	(merchantProcessor _ aMerchantProcessor
		cover: (171 to: 188)
		declaredAt: (75 to: 92))
		cover: (150 to: 166)
		declaredAt: (150 to: 166).! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{89 to: 121}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (128 to: 134)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (159 to: 164)
			declaredAt: (150 to: 155)) isDigit ] valueCoveringAll:
			{166 to: 172} ]] valueCoveringAll:
		{136 to: 146}) ifFalse: [
		[
		(self coverAll:
			{187 to: 190}) error:
			([
			(self coverAll:
				{199 to: 202}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{204 to: 236}) ] valueCoveringAll:
			{192 to: 197} ]] valueCoveringAll:
		{177 to: 184}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{103 to: 135}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(expirationMonthOfYear _ aGregorianMonthOfYear
		cover: (209 to: 229)
		declaredAt: (76 to: 96))
		cover: (184 to: 204)
		declaredAt: (184 to: 204).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice |
	[
	(self coverAll:
		{61 to: 64}) assertCartIsNotEmpty:
		(aCart
			cover: (88 to: 92)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{66 to: 86}.
	[
	(self coverAll:
		{96 to: 99}) assertCreditCardIsNotExpired:
		(aCreditCard
			cover: (131 to: 141)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{101 to: 129}.
	(totalPrice _ 0 coverAll:
		{159 to: 159})
		cover: (145 to: 154)
		declaredAt: (48 to: 57).
	[
	(aCart
		cover: (163 to: 167)
		declaredAt: (11 to: 15)) do: [ :anElement |
		(totalPrice _ [
		([
		(totalPrice
			cover: (187 to: 196)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (214 to: 222)
				declaredAt: (214 to: 222)) ] valueCoveringAll:
			{212 to: 212})
			at:
				(anElement
					cover: (228 to: 236)
					declaredAt: (175 to: 183))
			ifAbsent: [
				[
				(self coverAll:
					{249 to: 252}) raiseItemNotInPriceListError ] valueCoveringAll:
					{254 to: 281} ]] valueCoveringAll:
			{224 to: 226. 238 to: 246})
			cover: (201 to: 210)
			declaredAt: (48 to: 57) ]] valueCoveringAll:
		{169 to: 171}.
	[
	(merchantProcessor
		cover: (288 to: 304)
		declaredAt: (288 to: 304))
		charge:
			(totalPrice
				cover: (314 to: 323)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (330 to: 340)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{306 to: 312. 326 to: 328}.
	[
	(salesBook
		cover: (345 to: 353)
		declaredAt: (345 to: 353)) add:
		(totalPrice
			cover: (360 to: 369)
			declaredAt: (48 to: 57)) ] valueCoveringAll:
		{355 to: 358}.
	^ totalPrice
		cover: (375 to: 384)
		declaredAt: (48 to: 57).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) emptyCartErrorDescription ] valueCoveringAll:
				{80 to: 104}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
emptyCartErrorDescription
	^ 'The cart is empty' coverAll:
		{29 to: 47}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 10:01:55'!
PASSED!
!Behavior method!
assertCreditCardIsNotExpired: aCreditCard
	[
	([
	(aCreditCard
		cover: (47 to: 57)
		declaredAt: (31 to: 41)) isExpiredOn:
		([
		(Date
			cover: (72 to: 75)
			declaredAt: (72 to: 75)) today ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{59 to: 70}) ifTrue: [
		[
		(self coverAll:
			{93 to: 96}) error:
			([
			([
			(self coverAll:
				{105 to: 108}) class ] valueCoveringAll:
				{110 to: 114}) expiredCreditCardErrorDescription ] valueCoveringAll:
				{116 to: 148}) ] valueCoveringAll:
			{98 to: 103} ]] valueCoveringAll:
		{84 to: 90}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	([
	(GregorianMonthOfYear
		cover: (26 to: 45)
		declaredAt: (26 to: 45))
		yearNumber:
			([
			(aDate
				cover: (59 to: 63)
				declaredAt: (14 to: 18)) yearNumber ] valueCoveringAll:
				{65 to: 74})
		monthNumber:
			([
			(aDate
				cover: (89 to: 93)
				declaredAt: (14 to: 18)) monthIndex ] valueCoveringAll:
				{95 to: 104}) ] valueCoveringAll:
		{47 to: 57. 76 to: 87}) >
		(expirationMonthOfYear
			cover: (109 to: 129)
			declaredAt: (109 to: 129)) ] valueCoveringAll:
		{107 to: 107}.! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
raiseItemNotInPriceListError
	^ [
	(self coverAll:
		{34 to: 37}) error:
		([
		([
		(self coverAll:
			{46 to: 49}) class ] valueCoveringAll:
			{51 to: 55}) itemNotInPriceListErrorDescription ] valueCoveringAll:
			{57 to: 90}) ] valueCoveringAll:
		{39 to: 44}.! !
!Behavior method!
itemNotInPriceListErrorDescription
	^ 'An item in the cart is not in the price list' coverAll:
		{38 to: 83}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 10:01:55'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 10:01:55'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 10:01:55'!
PASSED!
!Behavior method!
expiredCreditCardErrorDescription
	^ 'The credit card is expired' coverAll:
		{37 to: 64}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 10:01:55'!
PASSED!
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 10:01:55'!
PASSED!
!Behavior method!
invalidCreditCardErrorDescription
	^ 'Los datos de la tarjeta de crdito son invlidos' coverAll:
		{37 to: 86}.! !

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 10:01:55'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 10:01:55'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 10:01:55'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 10:01:55'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 10:01:55'!
PASSED!
!Behavior method!
raiseAuthenticationErrorWithMessage: anErrorMessage
	(authenticationErrorMessage _ anErrorMessage
		cover: (84 to: 97)
		declaredAt: (38 to: 51))
		cover: (54 to: 79)
		declaredAt: (54 to: 79).! !
!Behavior method!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock
	^ [
	([
	(self coverAll:
		{83 to: 86}) new ] valueCoveringAll:
		{88 to: 90})
		initializeWithClientAuthenticator:
			(aClientAuthenticator
				cover: (127 to: 146)
				declaredAt: (26 to: 45))
		catalog:
			(aCatalog
				cover: (157 to: 164)
				declaredAt: (56 to: 63))
		clock:
			(aClock
				cover: (173 to: 178)
				declaredAt: (72 to: 77)) ] valueCoveringAll:
		{92 to: 125. 148 to: 155. 166 to: 171}.! !
!Behavior method!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock
	(clientAuthenticator _ aClientAuthenticator
		cover: (113 to: 132)
		declaredAt: (36 to: 55))
		cover: (90 to: 108)
		declaredAt: (90 to: 108).
	(carts _ [
	(OrderedCollection
		cover: (145 to: 161)
		declaredAt: (145 to: 161)) new ] valueCoveringAll:
		{163 to: 165})
		cover: (136 to: 140)
		declaredAt: (136 to: 140).
	(itemCatalog _ aCatalog
		cover: (184 to: 191)
		declaredAt: (66 to: 73))
		cover: (169 to: 179)
		declaredAt: (169 to: 179).
	(clock _ aClock
		cover: (204 to: 209)
		declaredAt: (82 to: 87))
		cover: (195 to: 199)
		declaredAt: (195 to: 199).
	(lastTimeCartUsed _ [
	(OrderedCollection
		cover: (232 to: 248)
		declaredAt: (145 to: 161)) new ] valueCoveringAll:
		{250 to: 252})
		cover: (213 to: 228)
		declaredAt: (213 to: 228).! !
!Behavior method!
createCartFor: aUserId authenticatedWith: aPassword
	[
	(clientAuthenticator
		cover: (54 to: 72)
		declaredAt: (54 to: 72))
		athenticateUser:
			(aUserId
				cover: (91 to: 97)
				declaredAt: (16 to: 22))
		withPassword:
			(aPassword
				cover: (113 to: 121)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{74 to: 89. 99 to: 111}.
	[
	(carts
		cover: (128 to: 132)
		declaredAt: (128 to: 132)) add:
		([
		(Cart
			cover: (140 to: 143)
			declaredAt: (140 to: 143)) acceptingItemsOf:
			(itemCatalog
				cover: (163 to: 173)
				declaredAt: (163 to: 173)) ] valueCoveringAll:
			{145 to: 161}) ] valueCoveringAll:
		{134 to: 137}.
	[
	(lastTimeCartUsed
		cover: (178 to: 193)
		declaredAt: (178 to: 193)) add:
		([
		(clock
			cover: (200 to: 204)
			declaredAt: (200 to: 204)) now ] valueCoveringAll:
			{206 to: 208}) ] valueCoveringAll:
		{195 to: 198}.
	^ [
	(carts
		cover: (213 to: 217)
		declaredAt: (128 to: 132)) size ] valueCoveringAll:
		{219 to: 222}.! !
!Behavior method!
athenticateUser: aSmallInteger withPassword: aString
	[
	(authenticationErrorMessage
		cover: (56 to: 81)
		declaredAt: (56 to: 81)) ifNotNil: [
		[
		(self coverAll:
			{94 to: 97}) error:
			(authenticationErrorMessage
				cover: (106 to: 131)
				declaredAt: (56 to: 81)) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{83 to: 91}.! !
!Behavior method!
hasCarts
	^ [
	([
	(carts
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}) not ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 10:01:55'!
PASSED!
!Behavior method!
with: aDateTime
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) initializeWith:
		(aDateTime
			cover: (45 to: 53)
			declaredAt: (7 to: 15)) ] valueCoveringAll:
		{29 to: 43}.! !
!Behavior method!
initializeWith: aDateTime
	(dateTime _ aDateTime
		cover: (40 to: 48)
		declaredAt: (17 to: 25))
		cover: (28 to: 35)
		declaredAt: (28 to: 35).! !
!Behavior method!
now
	^ dateTime
		cover: (8 to: 15)
		declaredAt: (8 to: 15).! !
!Behavior method!
hasCartIdentified: aCartId
	[
	(carts
		cover: (33 to: 37)
		declaredAt: (33 to: 37))
		at:
			(aCartId
				cover: (43 to: 49)
				declaredAt: (20 to: 26))
		ifAbsent: [ ^ false coverAll:
				{64 to: 68} ]] valueCoveringAll:
		{39 to: 41. 51 to: 59}.
	^ [
	([
	(self coverAll:
		{76 to: 79}) expiredCart:
		(aCartId
			cover: (94 to: 100)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{81 to: 92}) not ] valueCoveringAll:
		{103 to: 105}.! !
!Behavior method!
expiredCart: aCartId
	^ [
	([
	([
	(lastTimeCartUsed
		cover: (28 to: 43)
		declaredAt: (28 to: 43)) at:
		(aCartId
			cover: (49 to: 55)
			declaredAt: (14 to: 20)) ] valueCoveringAll:
		{45 to: 47}) next:
		([
		([
		(TimeUnits
			cover: (65 to: 73)
			declaredAt: (65 to: 73)) minute ] valueCoveringAll:
			{75 to: 80}) with:
			([
			(self coverAll:
				{88 to: 91}) maxInactiveTimeInMinutes ] valueCoveringAll:
				{93 to: 116}) ] valueCoveringAll:
			{82 to: 86}) ] valueCoveringAll:
		{58 to: 62}) <
		([
		(clock
			cover: (122 to: 126)
			declaredAt: (122 to: 126)) now ] valueCoveringAll:
			{128 to: 130}) ] valueCoveringAll:
		{120 to: 120}.! !
!Behavior method!
maxInactiveTimeInMinutes
	^ 30 coverAll:
		{30 to: 31}.! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 10:01:55'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 10:01:55'!
PASSED!
!Behavior method!
listCart: cartID
	[
	(self coverAll:
		{21 to: 24}) assertCartIDIsValid:
		(cartID
			cover: (47 to: 52)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{26 to: 45}.
	^ [
	(carts
		cover: (58 to: 62)
		declaredAt: (58 to: 62)) at:
		(cartID
			cover: (68 to: 73)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{64 to: 66}.! !
!Behavior method!
assertCartIDIsValid: cartID
	[
	([
	(self coverAll:
		{33 to: 36}) hasCartIdentified:
		(cartID
			cover: (57 to: 62)
			declaredAt: (22 to: 27)) ] valueCoveringAll:
		{38 to: 55}) ifFalse: [
		[
		(self coverAll:
			{75 to: 78}) error:
			([
			([
			(self coverAll:
				{87 to: 90}) class ] valueCoveringAll:
				{92 to: 96}) invalidCartIDErrorDescription ] valueCoveringAll:
				{98 to: 126}) ] valueCoveringAll:
			{80 to: 85} ]] valueCoveringAll:
		{65 to: 72}.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 10:01:55'!
PASSED!
!Behavior method!
invalidCartIDErrorDescription
	^ 'Cart ID is not in the system' coverAll:
		{33 to: 62}.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 10:01:55'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 10:01:55'!
PASSED!
!Behavior method!
set: aDateTime
	(dateTime _ aDateTime
		cover: (29 to: 37)
		declaredAt: (6 to: 14))
		cover: (17 to: 24)
		declaredAt: (17 to: 24).! !

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 10:01:55'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 10:02:29'!
PASSED!

----QUIT----(23 June 2021 10:02:43) CuisUniversity-4532.image priorSource: 17087185!

----STARTUP---- (23 June 2021 17:09:47) as /home/julian/facu/ingenieria1/ambientesCuis/TusLibros2/CuisUniversity-4532.image!


----End fileIn of /home/julian/facu/ingenieria1/ejsIS1/20-TusLibros-iteracion-3/TusLibros.st----!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 17:10:23'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 17:10:23'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 17:13:07'!
test07CartIsInvalidAfter30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.

	self deny: (store hasCartIdentified: cartID1).
		! !

!methodRemoval: StoreTest #test07CartIsInvalidBefore30Min stamp: 'JA 6/23/2021 17:13:07'!
test07CartIsInvalidBefore30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.

	self deny: (store hasCartIdentified: cartID1).
		!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 17:13:11'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 17:13:11'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 17:13:11'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 17:13:11'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 17:13:11'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 17:13:11'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 17:13:11'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 17:13:11'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 17:35:44'!
test08

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.
	store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.
	
	self deny: (store hasCartIdentified: cartID1).
		! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 17:36:35' prior: 50865849!
test08

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.
	
	
	self should: [store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 17:36:36'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 17:36:50'!
addToCart: aSmallInteger bookISBN: aSmallInteger2 bookQuantity: aSmallInteger3 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 17:39:26' prior: 50865890!
addToCart: aCartID bookISBN: aBookISBN bookQuantity: aBookQuantity

	self assertCartIDIsValid: aCartID 	! !

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 17:39:29'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 17:39:29'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 17:39:29'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 17:39:29'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 17:39:29'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 17:39:29'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 17:39:29'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 17:39:29'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 17:39:29'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 17:39:55'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 17:39:55'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 17:39:55'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 17:39:55'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 17:39:55'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 17:39:55'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 17:39:55'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 17:39:55'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 17:39:55'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 17:49:31'!
test09

	| store cartID1 cartList |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	store addToCart: cartID1 bookISBN: '123456789' bookQuantity: 10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList at: #(123456789)).
	! !

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 17:49:43'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 17:51:29' prior: 50865653!
listCart: cartID
	
	self assertCartIDIsValid: cartID.

	^ (carts at: cartID) list.! !

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 17:51:31'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 17:51:51'!
list
	self shouldBeImplemented.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 17:53:09' prior: 50865979!
list
	^ items copy! !

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 17:53:11'!
ERROR!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:04:40' prior: 50865956!
test09

	| store cartID1 cartList |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	store addToCart: cartID1 bookISBN: '123456789' bookQuantity: 10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList at: 0).
	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:12:21' prior: 50865989!
test09

	| store cartID1 cartList |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	store addToCart: cartID1 bookISBN: '123456789' bookQuantity: 10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList size).
	! !

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:12:23'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 18:16:51' prior: 50865897!
addToCart: aCartID bookISBN: aBookISBN bookQuantity: aBookQuantity

	self assertCartIDIsValid: aCartID 	.
	
	(carts at: aCartID) add: aBookQuantity of: aBookISBN.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 18:16:56'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 18:16:56'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 18:16:56'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 18:16:56'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 18:16:56'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 18:16:56'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 18:16:56'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 18:16:56'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:16:56'!
ERROR!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:16:56'!
ERROR!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:19:04' prior: 50866001!
test09

	| store cartID1 cartList |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList size).
	! !

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:19:06'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 18:19:06'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 18:19:06'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 18:19:06'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 18:19:06'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 18:19:06'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 18:19:06'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 18:19:06'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 18:19:06'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:19:06'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:21:09' prior: 50866052!
test09

	| store cartID1 cartList |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: cartList occurrencesOf: 1.
	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:21:25' prior: 50866093!
test09

	| store cartID1 cartList validBook |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	validBook _ TestObjects new itemSellByTheStore.
	store addToCart: cartID1 bookISBN: validBook bookQuantity:10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: cartList occurrencesOf: 1.
	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:21:41' prior: 50866107!
test09

	| store cartID1 cartList validBook |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	validBook _ TestObjects new itemSellByTheStore.
	store addToCart: cartID1 bookISBN: validBook bookQuantity:10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: (cartList occurrencesOf: validBook ).
	! !

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:21:42'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 18:21:42'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 18:21:42'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 18:21:42'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 18:21:42'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 18:21:42'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 18:21:42'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 18:21:42'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 18:21:42'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:21:42'!
PASSED!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 18:24:57' prior: 50865971!
listCart: cartID
	
	| cartList |
	self assertCartIDIsValid: cartID.
	cartList := OrderedCollection new.
	^ (carts at: cartID) do: [:book | cartList add:book].! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 18:25:16' prior: 50866166!
listCart: cartID
	
	| cartList |
	self assertCartIDIsValid: cartID.
	cartList := OrderedCollection new.
	(carts at: cartID) do: [:book | cartList add:book].
	^ cartList.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 18:25:16'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 18:25:16'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 18:25:16'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 18:25:16'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 18:25:16'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 18:25:16'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 18:25:16'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 18:25:16'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:25:16'!
PASSED!

!methodRemoval: Cart #list stamp: 'JA 6/23/2021 18:25:34'!
list
	^ items copy!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:34:00'!
test10

	| store purchases |
	store := self store .
	
	purchases := store listPurchasesOf: 123 password: 123.
	self assert: purchases isEmpty.
	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:35:02' prior: 50866211!
test10

	| store purchases |
	store := self store .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: purchases isEmpty.
	! !

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 18:35:04'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 18:35:16'!
listPurchasesOf: aSmallInteger password: aString 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 18:35:49' prior: 50866229!
listPurchasesOf: aSmallInteger password: aString 
	^ OrderedCollection new.
	! !

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 18:35:51'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 18:35:51'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 18:35:51'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 18:35:51'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 18:35:51'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 18:35:51'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 18:35:51'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 18:35:51'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 18:35:51'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:35:51'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 18:35:51'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:38:28'!
test11

	| store clientAuthenticatorSimulator errorMessage |
	store := self store .	
	
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: TestObjects new defaultCatalog clock: GregorianDateTime now .
	
	
	self should: [
		store listPurchasesOf: 123 password: 'passwd'.
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
			self assert: errorMessage  equals: exception messageText.
			self deny: store hasCarts.
		]
	
	
	
			! !

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 18:38:41'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 18:39:53' prior: 50866235!
listPurchasesOf: aUserId password: aPassword

	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 

	^ OrderedCollection new.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 18:39:54'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 18:39:54'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 18:39:54'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 18:39:54'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 18:39:54'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 18:39:54'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 18:39:54'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 18:39:54'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:39:54'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 18:39:54'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 18:39:54'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:40:25' prior: 50866271!
test11

	| store clientAuthenticatorSimulator errorMessage |
	store := self store .		
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: TestObjects new defaultCatalog clock: GregorianDateTime now .
	
	
	self should: [
		store listPurchasesOf: 123 password: 'passwd'.
	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 	
		self assert: errorMessage  equals: exception messageText.
		self deny: store hasCarts.
	]
	
	
	
			! !

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 18:40:26'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 18:40:26'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:45:14'!
test12

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	
	store checkoutCart: cartID1 creditCard:123.
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: purchases isEmpty.
	! !
!TestObjects methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 18:45:50'!
validCreditCard

	^ CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next! !
!CashierTest methodsFor: 'support' stamp: 'JA 6/23/2021 18:46:19' prior: 50865061!
validCreditCard
	^ TestObjects new validCreditCard .
	"^ CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next"! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/23/2021 18:46:24'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/23/2021 18:46:24'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/23/2021 18:46:24'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/23/2021 18:46:24'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/23/2021 18:46:24'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/23/2021 18:46:24'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:46:56' prior: 50866393!
test12

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: purchases isEmpty.
	! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 18:47:20'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 18:47:27'!
checkoutCart: aSmallInteger creditCard: aCreditCard 
	self shouldBeImplemented.! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 18:56:41' prior: 50866443!
test12

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases size.
	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 19:03:39' prior: 50866466!
test12

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases size.
	self assert: 100 equals: purchases totalAmount.	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 19:04:00' prior: 50866482!
test12

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases size.
	self assert: 100 equals: purchases totalAmount.	! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:07:04' prior: 50866460!
checkoutCart: aCartId creditCard: aCreditCard 
	| aPriceList aSalesBook cashier |
	aPriceList := itemCatalog asBag.
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: aPriceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard .
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 19:07:14'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:07:14'!
ERROR!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:07:14'!
ERROR!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:08:17'!
ERROR!
!Cashier methodsFor: 'checkout' stamp: 'JA 6/23/2021 19:10:08' prior: 50865362!
checkout: aCart withCreditCard: aCreditCard 
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	self assertCreditCardIsNotExpired: aCreditCard.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + (priceList at: anElement ifAbsent: [self raiseItemNotInPriceListError]).].
	merchantProcessor charge: totalPrice  on: aCreditCard .
	salesBook add: totalPrice .
	^totalPrice.! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:10:20'!
ERROR!
!Cashier methodsFor: 'checkout' stamp: 'JA 6/23/2021 19:11:35' prior: 50866567!
checkout: aCart withCreditCard: aCreditCard 
	|totalPrice|
	self assertCartIsNotEmpty: aCart.
	self assertCreditCardIsNotExpired: aCreditCard.
	totalPrice := 0.
	aCart do: [:anElement | totalPrice := totalPrice + priceList at: anElement ifAbsent: [self raiseItemNotInPriceListError].].
	merchantProcessor charge: totalPrice  on: aCreditCard .
	salesBook add: totalPrice .
	^totalPrice.! !
!TestObjects methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:13:52'!
defaultPriceList

	^Dictionary with: self itemInStore -> self itemInStorePrice.! !
!TestObjects methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:14:46' prior: 50866599!
defaultPriceList

	^Dictionary with: self itemSellByTheStore -> self itemInStorePrice.! !
!TestObjects methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:15:05'!
itemInStorePrice
	^ 10! !
!Store class methodsFor: 'instance creation' stamp: 'JA 6/23/2021 19:18:04'!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: priceList   
	^self new initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:18:04' prior: 50865254!
store
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: self clockSimulator priceList: TestObjects new defaultPriceList.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:18:04' prior: 50865792!
test07CartIsInvalidAfter30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.

	self deny: (store hasCartIdentified: cartID1).
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:18:04' prior: 50866336!
test11

	| store clientAuthenticatorSimulator errorMessage |
	store := self store .		
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: TestObjects new defaultCatalog clock: GregorianDateTime now priceList: TestObjects new defaultPriceList .
	
	
	self should: [
		store listPurchasesOf: 123 password: 'passwd'.
	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 	
		self assert: errorMessage  equals: exception messageText.
		self deny: store hasCarts.
	]
	
	
	
			! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:18:04' prior: 50865143!
test01CanNotCreateCartWhenCredentialsCantBeAuthenticated

	| store errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: TestObjects new defaultCatalog clock: GregorianDateTime now priceList: TestObjects new defaultPriceList .
	
	
	self should: [
		store createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: store hasCarts.
		]
	
	
	
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:18:04' prior: 50865867!
test08

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.
	
	
	self should: [store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!methodRemoval: Store class #withClientAuthenticator:catalog:clock: stamp: 'JA 6/23/2021 19:18:04'!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock  
	^self new initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock.!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:18:12'!
ERROR!
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 19:19:23'!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: priceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.! !
!Store class methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:19:23' prior: 50866615!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: priceList   
	^self new initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: priceList.! !

!methodRemoval: Store #initializeWithClientAuthenticator:catalog:clock: stamp: 'JA 6/23/2021 19:19:24'!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.!
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 19:20:56' prior: 50866738!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	! !

!classDefinition: #Store category: 'TusLibros' stamp: 'JA 6/23/2021 19:21:01'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 19:20:59' prior: 50866771!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 19:21:09'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:21:09'!
ERROR!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:21:09'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:21:38' prior: 50866516!
checkoutCart: aCartId creditCard: aCreditCard 
	| aSalesBook cashier |
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard .
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 19:21:42'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:21:42'!
FAILURE!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:21:42'!
FAILURE!

!classDefinition: #Store category: 'TusLibros' stamp: 'JA 6/23/2021 19:27:52'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:27:50' prior: 50865626!
createCartFor: aUserId authenticatedWith: aPassword
	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	
	carts add: (Cart acceptingItemsOf: itemCatalog).
	cartOwner add: aUserId.
	lastTimeCartUsed add: clock now.
	^carts size.
	
	! !
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 19:28:10' prior: 50866791!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:31:38' prior: 50866839!
checkoutCart: aCartId creditCard: aCreditCard 
	| aSalesBook cashier userID |
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard .
	userID := cartOwner at:aCartId. 
	"userPurchases at: userID add: "! !

!classDefinition: #Store category: 'TusLibros' stamp: 'JA 6/23/2021 19:33:31'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:33:27' prior: 50866921!
checkoutCart: aCartId creditCard: aCreditCard 
	| aSalesBook cashier userID |
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard .
	userID := cartOwner at:aCartId. 
	(userPurchases at: userID) add: (self listCart: aCartId).! !
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 19:33:52' prior: 50866907!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.
	userPurchases  := Dictionary new.! !
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 19:34:02' prior: 50866961!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.
	userPurchases  := OrderedCollection new.! !
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 19:34:29' prior: 50866976!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.
	userPurchases  := Dictionary new.! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:37:56' prior: 50866945!
checkoutCart: aCartId creditCard: aCreditCard 
	| aSalesBook cashier userID |
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard .
	userID := cartOwner at:aCartId. 
	"
	userPurchases includesKey: userID ifFalse: [userPurchases add: userID-> ]
	(userPurchases at: userID) add: (self listCart: aCartId)."! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:41:37' prior: 50867006!
checkoutCart: aCartId creditCard: aCreditCard 
	| aSalesBook cashier userID |
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard .
	userID := cartOwner at:aCartId. 
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 19:41:39'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:41:39'!
FAILURE!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:41:39'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:43:24' prior: 50866298!
listPurchasesOf: aUserId password: aPassword

	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 

	^ userPurchases at: aUserId .
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 19:44:13' prior: 50867078!
listPurchasesOf: aUserId password: aPassword

	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	(userPurchases includesKey: aUserId ) ifFalse: [userPurchases add: aUserId ->(OrderedCollection new)].				
	^ userPurchases at: aUserId .
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 19:44:14'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:44:14'!
ERROR!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:44:14'!
ERROR!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 19:46:05' prior: 50866499!
test12

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases size.
	self assert: 10 equals: (purchases occurrencesOf: TestObjects new itemSellByTheStore).
	"self assert: 100 equals: purchases totalAmount.	"! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 19:46:08'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 19:46:08'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 20:17:14' prior: 50867132!
test12

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases list size.
	self assert: 10 equals: (purchases list occurrencesOf: TestObjects new itemSellByTheStore).
	self assert: 100 equals: purchases totalAmount.	! !

!classDefinition: #PurchaseList category: 'TusLibros' stamp: 'JA 6/23/2021 20:19:02'!
Object subclass: #PurchaseList
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:18:52' prior: 50867086!
listPurchasesOf: aUserId password: aPassword

	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	(userPurchases includesKey: aUserId ) ifFalse: [userPurchases add: aUserId ->(OrderedCollection new)].				
	^ PurchaseList withItems: (userPurchases at: aUserId) AndPriceList: priceList .
	
	"^ userPurchases at: aUserId ."
	! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:19:15'!
ERROR!
!PurchaseList class methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:19:27'!
withItems: anOrderedCollection AndPriceList: aDictionary 
	self shouldBeImplemented.! !
!PurchaseList class methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:20:47' prior: 50867230!
withItems: anItemList AndPriceList: aPriceList
	self new initializeWithItems: anItemList andPriceList: aPriceList .! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:20:54'!
ERROR!

!classDefinition: #PurchaseList category: 'TusLibros' stamp: 'JA 6/23/2021 20:21:02'!
Object subclass: #PurchaseList
	instanceVariableNames: 'itemList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #PurchaseList category: 'TusLibros' stamp: 'JA 6/23/2021 20:21:02'!
Object subclass: #PurchaseList
	instanceVariableNames: 'itemList priceList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!PurchaseList methodsFor: 'initialization' stamp: 'JA 6/23/2021 20:21:02'!
initializeWithItems: anItemList andPriceList: aPriceList 
	self shouldBeImplemented.
	itemList := anItemList.
	priceList := aPriceList.! !
!PurchaseList methodsFor: 'initialization' stamp: 'JA 6/23/2021 20:21:10' prior: 50867259!
initializeWithItems: anItemList andPriceList: aPriceList 
	
	itemList := anItemList.
	priceList := aPriceList.! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:21:13'!
ERROR!
!PurchaseList class methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:21:41' prior: 50867236!
withItems: anItemList AndPriceList: aPriceList
	^ self new initializeWithItems: anItemList andPriceList: aPriceList .! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:21:48'!
ERROR!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:21:48'!
ERROR!
!PurchaseList methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:21:57'!
list
	self shouldBeImplemented.! !
!PurchaseList methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:22:34' prior: 50867287!
list
	^ itemList copy.! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:22:55'!
ERROR!
!PurchaseList methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:23:03'!
totalAmount
	self shouldBeImplemented.! !
!PurchaseList methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:25:26' prior: 50867298!
totalAmount
	(itemList collect: [:item| priceList at: item ifAbsent: []]) sum.! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:25:27'!
FAILURE!
!PurchaseList methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:25:56' prior: 50867303!
totalAmount
	^ (itemList collect: [:item| priceList at: item ifAbsent: []]) sum.! !
!PurchaseList methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:26:41' prior: 50867311!
totalAmount
	^ (itemList collect: [:item| priceList at: item ifAbsent: []]) sum ifEmpty: 0.! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:26:45'!
ERROR!
!PurchaseList methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:27:20' prior: 50867317!
totalAmount
	^ itemList sum: [:item| priceList at: item ifAbsent: []]  ifEmpty: 0.! !

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:27:26'!
ERROR!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:27:26'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:27:26'!
ERROR!
!PurchaseList methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:27:45'!
isEmpty
	self shouldBeImplemented.! !
!PurchaseList methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:28:21' prior: 50867369!
isEmpty
	^ itemList isEmpty .! !

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:28:23'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 20:28:26'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:28:26'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 20:29:04' prior: 50866219!
test10

	| store purchases |
	store := self store .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: purchases isEmpty.
	self assert: 0 equals: purchases totalAmount .
	! !

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 20:29:05'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:29:05'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 20:31:23'!
test13

	| store |
	store := self store .
	
	
	store checkoutCart: -1 creditCard: TestObjects new validCreditCard .
	
	! !

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 20:31:30'!
ERROR!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 20:33:40' prior: 50867459!
test13

	| store |
	store := self store .
	
	self should:  [store checkoutCart: -1 creditCard: TestObjects new validCreditCard .]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:exception | self assert: Store invalidCartIDErrorDescription equals: exception messageText]
	
	
	! !

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 20:33:41'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:34:52' prior: 50867024!
checkoutCart: aCartId creditCard: aCreditCard 
	| aSalesBook cashier userID |
	self assertCartIDIsValid: aCartId .
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard .
	userID := cartOwner at:aCartId. 
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).! !

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 20:34:53'!
PASSED!

a := OrderedCollection with:1 with:2 with:3.!

a!

a removeAt: 2.!

a!

a at:2!

a at:1 !

a at:3!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 20:50:10'!
test14

	| store cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
		
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	self should: [
		store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .	]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:exception | self assert: Store cannotCheckoutACartTwice equals: exception messageText ]
	! !

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 20:50:18'!
FAILURE!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 20:51:34' prior: 50867543!
test14

	| store cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
		
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	self should: [
		store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .	]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:exception | self assert: Store invalidCartIDErrorDescription equals: exception messageText ]
		! !

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 20:51:36'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:52:30' prior: 50867483!
checkoutCart: aCartId creditCard: aCreditCard 
	| aSalesBook cashier userID |
	self assertCartIDIsValid: aCartId .
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard .
	userID := cartOwner at:aCartId. 
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).
	
	self invalidateCartId: aCartId.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:52:41'!
ERROR!

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 20:52:41'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 20:52:41'!
ERROR!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:52:46'!
ERROR!

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 20:52:46'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 20:52:46'!
ERROR!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 20:52:48'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:52:57'!
invalidateCartId: aSmallInteger 
	self shouldBeImplemented.! !

!classDefinition: #Store category: 'TusLibros' stamp: 'JA 6/23/2021 20:54:13'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases invalidCarts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:54:10' prior: 50867685!
invalidateCartId: aCartID
	invalidCarts add: aCartID.! !

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 20:54:17'!
ERROR!
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 20:54:54' prior: 50866991!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.
	userPurchases  := Dictionary new.
	invalidCarts  := OrderedCollection new.! !

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 20:55:04'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 20:57:27' prior: 50865619!
assertCartIDIsValid: cartID
	
	((self hasCartIdentified: cartID) 
	and: [(invalidCarts includes: cartID) not]) 
	ifFalse: [self error: self class invalidCartIDErrorDescription ]! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 20:57:28'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 20:58:37'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 20:58:37'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 20:59:58'!
test15

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	store addToCart: cartID2 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:00:10'!
ERROR!

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:00:55'!
ERROR!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:01:12' prior: 50867811!
test15

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	store addToCart: cartID2 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:01:13'!
FAILURE!

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:12:40'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 21:12:49' prior: 50867214!
listPurchasesOf: aUserId password: aPassword

	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	(userPurchases includesKey: aUserId ) ifFalse: [userPurchases add: aUserId ->(OrderedCollection new)].				
	^ PurchaseList withItems: (userPurchases at: aUserId) AndPriceList: priceList .
	! !

!classDefinition: #Store category: 'TusLibros' stamp: 'JA 6/23/2021 21:13:55'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases invalidCarts currentTransactionID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 21:13:53' prior: 50867587!
checkoutCart: aCartId creditCard: aCreditCard 
	| aSalesBook cashier userID |
	self assertCartIDIsValid: aCartId .
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: aSalesBook merchantProcessor: MerchantProcessorSimulator new.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard .
	userID := cartOwner at:aCartId. 
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).
	
	self invalidateCartId: aCartId.
	
	currentTransactionID := currentTransactionID + 1.
	^ currentTransactionID.! !
!Store methodsFor: 'initialization' stamp: 'JA 6/23/2021 21:14:09' prior: 50867707!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	itemCatalog := aCatalog.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.
	userPurchases  := Dictionary new.
	invalidCarts  := OrderedCollection new.
	currentTransactionID  := 0.! !

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:14:12'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:14:12'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:22:56'!
test16

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed25Minutes.
	store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.
	aClockSimulator set: self dateForTestingDelayed31Minutes.
	
	self should: [store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:26:32' prior: 50867971!
test16

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed25Minutes.
	store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.
	aClockSimulator set: self dateForTestingDelayed31Minutes.
	store listCart: cartID1.
	aClockSimulator set: self dateForTestingDelayed62Minutes.
	
	self should: [store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:26:38'!
ERROR!
!StoreTest methodsFor: 'support' stamp: 'JA 6/23/2021 21:27:08'!
dateForTestingDelayed25Minutes

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:25:00! !
!StoreTest methodsFor: 'support' stamp: 'JA 6/23/2021 21:27:25'!
dateForTestingDelayed62Minutes

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 01:02:00! !

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:27:31'!
ERROR!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:29:11' prior: 50867997!
test16

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed25Minutes.
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	aClockSimulator set: self dateForTestingDelayed31Minutes.
	store listCart: cartID1.
	aClockSimulator set: self dateForTestingDelayed62Minutes.
	
	self should: [store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:29:13'!
ERROR!

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:29:22'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 21:30:33' prior: 50866015!
addToCart: aCartID bookISBN: aBookISBN bookQuantity: aBookQuantity

	self assertCartIDIsValid: aCartID 	.
	
	(carts at: aCartID) add: aBookQuantity of: aBookISBN.
	
	lastTimeCartUsed at:aCartID put: clock now.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:30:35'!
PASSED!

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:30:51'!
PASSED!

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:30:51'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:35:16' prior: 50868045!
test16

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed25Minutes.
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	aClockSimulator set: self dateForTestingDelayed31Minutes.
	store listCart: cartID1.
	aClockSimulator set: self dateForTestingDelayed56Minutes.
	store listCart: cartID1.
	aClockSimulator set: self dateForTestingDelayed87Minutes.
	
	self should: [store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'support' stamp: 'JA 6/23/2021 21:36:45'!
dateForTestingDelayed56Minutes

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:56:00! !
!StoreTest methodsFor: 'support' stamp: 'JA 6/23/2021 21:37:03'!
dateForTestingDelayed87Minutes

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 01:27:00! !

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:37:11'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 21:38:25' prior: 50866174!
listCart: cartID
	
	| cartList |
	self assertCartIDIsValid: cartID.
	cartList := OrderedCollection new.
	(carts at: cartID) do: [:book | cartList add:book].
	
	lastTimeCartUsed at: cartID put: clock now.
	
	^ cartList.! !

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:38:29'!
ERROR!

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:38:33'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test08 stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test09 stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test10 stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test11 stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test12 stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test13 stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:40:03'!
PASSED!

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:40:03'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:41:44'!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.
	
	
	self should: [store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!methodRemoval: StoreTest #test08 stamp: 'JA 6/23/2021 21:41:44'!
test08

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed31Minutes.
	
	
	self should: [store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:43:14'!
test09ItemsAddedToCartAreListed

	| store cartID1 cartList validBook |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	validBook _ TestObjects new itemSellByTheStore.
	store addToCart: cartID1 bookISBN: validBook bookQuantity:10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: (cartList occurrencesOf: validBook ).
	! !

!methodRemoval: StoreTest #test09 stamp: 'JA 6/23/2021 21:43:14'!
test09

	| store cartID1 cartList validBook |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	validBook _ TestObjects new itemSellByTheStore.
	store addToCart: cartID1 bookISBN: validBook bookQuantity:10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: (cartList occurrencesOf: validBook ).
	!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:45:15'!
test10PurchaseListOfUserWithoutPurchasesIsEmpty

	| store purchases |
	store := self store .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: purchases isEmpty.
	self assert: 0 equals: purchases totalAmount .
	! !

!methodRemoval: StoreTest #test10 stamp: 'JA 6/23/2021 21:45:15'!
test10

	| store purchases |
	store := self store .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: purchases isEmpty.
	self assert: 0 equals: purchases totalAmount .
	!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:46:51'!
test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated

	| store clientAuthenticatorSimulator errorMessage |
	store := self store .		
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: TestObjects new defaultCatalog clock: GregorianDateTime now priceList: TestObjects new defaultPriceList .
	
	
	self should: [
		store listPurchasesOf: 123 password: 'passwd'.
	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 	
		self assert: errorMessage  equals: exception messageText.
		self deny: store hasCarts.
	]
	
	
	
			! !

!methodRemoval: StoreTest #test11 stamp: 'JA 6/23/2021 21:46:51'!
test11

	| store clientAuthenticatorSimulator errorMessage |
	store := self store .		
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator catalog: TestObjects new defaultCatalog clock: GregorianDateTime now priceList: TestObjects new defaultPriceList .
	
	
	self should: [
		store listPurchasesOf: 123 password: 'passwd'.
	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 	
		self assert: errorMessage  equals: exception messageText.
		self deny: store hasCarts.
	]
	
	
	
			!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:49:19'!
test12CheckoutUpdatesPurchaseListOfUserWithTheSales

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases list size.
	self assert: 10 equals: (purchases list occurrencesOf: TestObjects new itemSellByTheStore).
	self assert: 100 equals: purchases totalAmount.	! !

!methodRemoval: StoreTest #test12 stamp: 'JA 6/23/2021 21:49:19'!
test12

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases list size.
	self assert: 10 equals: (purchases list occurrencesOf: TestObjects new itemSellByTheStore).
	self assert: 100 equals: purchases totalAmount.	!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:51:43'!
test13CannotCheckoutWithInvalidCartID

	| store |
	store := self store .
	
	self should:  [store checkoutCart: -1 creditCard: TestObjects new validCreditCard .]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:exception | self assert: Store invalidCartIDErrorDescription equals: exception messageText]
	
	
	! !

!methodRemoval: StoreTest #test13 stamp: 'JA 6/23/2021 21:51:43'!
test13

	| store |
	store := self store .
	
	self should:  [store checkoutCart: -1 creditCard: TestObjects new validCreditCard .]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:exception | self assert: Store invalidCartIDErrorDescription equals: exception messageText]
	
	
	!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:53:28'!
PASSED!

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:53:28'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:54:07' prior: 50867565!
test14

	| store cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
		
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	self deny: (store hasCartIdentified: cartID1).! !

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:54:08'!
FAILURE!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:54:23'!
FAILURE!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 21:57:16' prior: 50865643!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	(invalidCarts includes: aCartId) ifTrue:[^ false].
	^ (self expiredCart: aCartId) not.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:57:17'!
PASSED!

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:57:17'!
PASSED!
!Store methodsFor: 'as yet unclassified' stamp: 'JA 6/23/2021 21:57:33' prior: 50867726!
assertCartIDIsValid: cartID
	
	(self hasCartIdentified: cartID)
	ifFalse: [self error: self class invalidCartIDErrorDescription ]! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test14 stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test15 stamp: 'JA 6/23/2021 21:57:34'!
PASSED!

!testRun: #StoreTest #test16 stamp: 'JA 6/23/2021 21:57:34'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:58:05'!
test14CheckoutInvalidatesCartId

	| store cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
		
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	self deny: (store hasCartIdentified: cartID1).! !

!methodRemoval: StoreTest #test14 stamp: 'JA 6/23/2021 21:58:05'!
test14

	| store cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
		
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	self deny: (store hasCartIdentified: cartID1).!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:58:49'!
test15CheckoutCartReturnsUniqueTransactionIDs

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	store addToCart: cartID2 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !

!methodRemoval: StoreTest #test15 stamp: 'JA 6/23/2021 21:58:49'!
test15

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.
	store addToCart: cartID2 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/23/2021 21:59:37'!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed25Minutes.
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	aClockSimulator set: self dateForTestingDelayed31Minutes.
	store listCart: cartID1.
	aClockSimulator set: self dateForTestingDelayed56Minutes.
	store listCart: cartID1.
	aClockSimulator set: self dateForTestingDelayed87Minutes.
	
	self should: [store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!methodRemoval: StoreTest #test16 stamp: 'JA 6/23/2021 21:59:37'!
test16

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator set: self dateForTestingDelayed25Minutes.
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	aClockSimulator set: self dateForTestingDelayed31Minutes.
	store listCart: cartID1.
	aClockSimulator set: self dateForTestingDelayed56Minutes.
	store listCart: cartID1.
	aClockSimulator set: self dateForTestingDelayed87Minutes.
	
	self should: [store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/23/2021 21:59:46'!
PASSED!

00:25:00!

00:25:00!

00:25:00!

TimeUnits hour with: 1!

1 hour.!

1 minute!

(TimeUnits minute with: 0).!

(TimeUnits minute with: 60).!

(TimeUnits minute with: 61).!
!ClockSimulator methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:24:58'!
addMinutes: anAmountOfMinutes
	dateTime := dateTime next: (TimeUnits minute with: anAmountOfMinutes).! !

GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:56:00!

GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:56:00.!

GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:00:00.!

x := GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:00:00.!

x next: (TimeUnits minute with: 3).!

x next: (TimeUnits minute with: 3).!

x next: (TimeUnits minute with: 60).!

x next: (TimeUnits minute with: 612).!

x next: (TimeUnits minute with: 62).!

x next: (TimeUnits minute with: 62).!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 00:30:26' prior: 51061863!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 25.
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	aClockSimulator set: self dateForTestingDelayed31Minutes.
	store listCart: cartID1.
	aClockSimulator set: self dateForTestingDelayed56Minutes.
	store listCart: cartID1.
	aClockSimulator set: self dateForTestingDelayed87Minutes.
	
	self should: [store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:30:27'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:30:28'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:30:28'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:30:28'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:30:28'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:30:28'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:30:28'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 00:30:33' prior: 51062568!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 25.
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	aClockSimulator addMinutes: 31.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31 + 25.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31 + 25 + 31.
	
	self should: [store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:30:34'!
ERROR!

aClockSimulator!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 00:32:15' prior: 51062655!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:32:15'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:32:15'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 00:33:04' prior: 51062689!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.								
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 00:34:09' prior: 51061698!
test07CartIsInvalidAfter30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.

	self deny: (store hasCartIdentified: cartID1).
		! !

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:34:14'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:34:14'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 00:34:25' prior: 51061715!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new catalog: TestObjects new defaultCatalog clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.
	
	
	self should: [store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:34:25'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:34:25'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:34:25'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:34:25'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:34:25'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:34:25'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:34:25'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:34:25'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:34:26'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:34:26'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:34:26'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:34:26'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:34:26'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:34:26'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:34:26'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:34:26'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:34:26'!
PASSED!
!Behavior method!
defaultCatalog
	^ [
	(Array
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) with:
		([
		(self coverAll:
			{33 to: 36}) itemSellByTheStore ] valueCoveringAll:
			{38 to: 55}) ] valueCoveringAll:
		{27 to: 31}.! !
!Behavior method!
itemSellByTheStore
	^ 'validBook' coverAll:
		{25 to: 35}.! !
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/24/2021 00:34:36'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/24/2021 00:34:36'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/24/2021 00:34:36'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWith:
			(aPriceList
				cover: (112 to: 121)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (140 to: 149)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessor
				cover: (170 to: 187)
				declaredAt: (65 to: 82)) ] valueCoveringAll:
		{96 to: 110. 123 to: 138. 151 to: 168}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	(priceList _ aPriceList
		cover: (111 to: 120)
		declaredAt: (17 to: 26))
		cover: (98 to: 106)
		declaredAt: (98 to: 106).
	(salesBook _ aSalesBook
		cover: (137 to: 146)
		declaredAt: (45 to: 54))
		cover: (124 to: 132)
		declaredAt: (124 to: 132).
	(merchantProcessor _ aMerchantProcessor
		cover: (171 to: 188)
		declaredAt: (75 to: 92))
		cover: (150 to: 166)
		declaredAt: (150 to: 166).! !
!Behavior method!
validCreditCard
	^ [
	(CreditCard
		cover: (21 to: 30)
		declaredAt: (21 to: 30))
		owner:
			('owner' coverAll:
				{39 to: 45})
		number:
			('1234567891011121' coverAll:
				{55 to: 72})
		expiration:
			([
			([
			(GregorianMonthOfYear
				cover: (86 to: 105)
				declaredAt: (86 to: 105)) current ] valueCoveringAll:
				{107 to: 113}) next ] valueCoveringAll:
				{115 to: 118}) ] valueCoveringAll:
		{32 to: 37. 47 to: 53. 74 to: 84}.! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{89 to: 121}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (128 to: 134)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (159 to: 164)
			declaredAt: (150 to: 155)) isDigit ] valueCoveringAll:
			{166 to: 172} ]] valueCoveringAll:
		{136 to: 146}) ifFalse: [
		[
		(self coverAll:
			{187 to: 190}) error:
			([
			(self coverAll:
				{199 to: 202}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{204 to: 236}) ] valueCoveringAll:
			{192 to: 197} ]] valueCoveringAll:
		{177 to: 184}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{103 to: 135}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(expirationMonthOfYear _ aGregorianMonthOfYear
		cover: (209 to: 229)
		declaredAt: (76 to: 96))
		cover: (184 to: 204)
		declaredAt: (184 to: 204).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice |
	[
	(self coverAll:
		{61 to: 64}) assertCartIsNotEmpty:
		(aCart
			cover: (88 to: 92)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{66 to: 86}.
	[
	(self coverAll:
		{96 to: 99}) assertCreditCardIsNotExpired:
		(aCreditCard
			cover: (131 to: 141)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{101 to: 129}.
	(totalPrice _ 0 coverAll:
		{159 to: 159})
		cover: (145 to: 154)
		declaredAt: (48 to: 57).
	[
	(aCart
		cover: (163 to: 167)
		declaredAt: (11 to: 15)) do: [ :anElement |
		(totalPrice _ [
		([
		(totalPrice
			cover: (187 to: 196)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (214 to: 222)
				declaredAt: (214 to: 222)) ] valueCoveringAll:
			{212 to: 212})
			at:
				(anElement
					cover: (228 to: 236)
					declaredAt: (175 to: 183))
			ifAbsent: [
				[
				(self coverAll:
					{249 to: 252}) raiseItemNotInPriceListError ] valueCoveringAll:
					{254 to: 281} ]] valueCoveringAll:
			{224 to: 226. 238 to: 246})
			cover: (201 to: 210)
			declaredAt: (48 to: 57) ]] valueCoveringAll:
		{169 to: 171}.
	[
	(merchantProcessor
		cover: (288 to: 304)
		declaredAt: (288 to: 304))
		charge:
			(totalPrice
				cover: (314 to: 323)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (330 to: 340)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{306 to: 312. 326 to: 328}.
	[
	(salesBook
		cover: (345 to: 353)
		declaredAt: (345 to: 353)) add:
		(totalPrice
			cover: (360 to: 369)
			declaredAt: (48 to: 57)) ] valueCoveringAll:
		{355 to: 358}.
	^ totalPrice
		cover: (375 to: 384)
		declaredAt: (48 to: 57).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) emptyCartErrorDescription ] valueCoveringAll:
				{80 to: 104}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
emptyCartErrorDescription
	^ 'The cart is empty' coverAll:
		{29 to: 47}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
assertCreditCardIsNotExpired: aCreditCard
	[
	([
	(aCreditCard
		cover: (47 to: 57)
		declaredAt: (31 to: 41)) isExpiredOn:
		([
		(Date
			cover: (72 to: 75)
			declaredAt: (72 to: 75)) today ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{59 to: 70}) ifTrue: [
		[
		(self coverAll:
			{93 to: 96}) error:
			([
			([
			(self coverAll:
				{105 to: 108}) class ] valueCoveringAll:
				{110 to: 114}) expiredCreditCardErrorDescription ] valueCoveringAll:
				{116 to: 148}) ] valueCoveringAll:
			{98 to: 103} ]] valueCoveringAll:
		{84 to: 90}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	([
	(GregorianMonthOfYear
		cover: (26 to: 45)
		declaredAt: (26 to: 45))
		yearNumber:
			([
			(aDate
				cover: (59 to: 63)
				declaredAt: (14 to: 18)) yearNumber ] valueCoveringAll:
				{65 to: 74})
		monthNumber:
			([
			(aDate
				cover: (89 to: 93)
				declaredAt: (14 to: 18)) monthIndex ] valueCoveringAll:
				{95 to: 104}) ] valueCoveringAll:
		{47 to: 57. 76 to: 87}) >
		(expirationMonthOfYear
			cover: (109 to: 129)
			declaredAt: (109 to: 129)) ] valueCoveringAll:
		{107 to: 107}.! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
raiseItemNotInPriceListError
	^ [
	(self coverAll:
		{34 to: 37}) error:
		([
		([
		(self coverAll:
			{46 to: 49}) class ] valueCoveringAll:
			{51 to: 55}) itemNotInPriceListErrorDescription ] valueCoveringAll:
			{57 to: 90}) ] valueCoveringAll:
		{39 to: 44}.! !
!Behavior method!
itemNotInPriceListErrorDescription
	^ 'An item in the cart is not in the price list' coverAll:
		{38 to: 83}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 00:34:36'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
expiredCreditCardErrorDescription
	^ 'The credit card is expired' coverAll:
		{37 to: 64}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
invalidCreditCardErrorDescription
	^ 'Los datos de la tarjeta de crdito son invlidos' coverAll:
		{37 to: 86}.! !

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/24/2021 00:34:36'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/24/2021 00:34:36'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/24/2021 00:34:36'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/24/2021 00:34:36'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
raiseAuthenticationErrorWithMessage: anErrorMessage
	(authenticationErrorMessage _ anErrorMessage
		cover: (84 to: 97)
		declaredAt: (38 to: 51))
		cover: (54 to: 79)
		declaredAt: (54 to: 79).! !
!Behavior method!
defaultPriceList
	^ [
	(Dictionary
		cover: (21 to: 30)
		declaredAt: (21 to: 30)) with:
		([
		([
		(self coverAll:
			{38 to: 41}) itemSellByTheStore ] valueCoveringAll:
			{43 to: 60}) ->
			([
			(self coverAll:
				{65 to: 68}) itemInStorePrice ] valueCoveringAll:
				{70 to: 85}) ] valueCoveringAll:
			{62 to: 63}) ] valueCoveringAll:
		{32 to: 36}.! !
!Behavior method!
itemInStorePrice
	^ 10 coverAll:
		{21 to: 22}.! !
!Behavior method!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: priceList
	^ [
	([
	(self coverAll:
		{105 to: 108}) new ] valueCoveringAll:
		{110 to: 112})
		initializeWithClientAuthenticator:
			(aClientAuthenticator
				cover: (149 to: 168)
				declaredAt: (26 to: 45))
		catalog:
			(aCatalog
				cover: (179 to: 186)
				declaredAt: (56 to: 63))
		clock:
			(aClock
				cover: (195 to: 200)
				declaredAt: (72 to: 77))
		priceList:
			(priceList
				cover: (213 to: 221)
				declaredAt: (90 to: 98)) ] valueCoveringAll:
		{114 to: 147. 170 to: 177. 188 to: 193. 202 to: 211}.! !
!Behavior method!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList
	(clientAuthenticator _ aClientAuthenticator
		cover: (136 to: 155)
		declaredAt: (36 to: 55))
		cover: (113 to: 131)
		declaredAt: (113 to: 131).
	(carts _ [
	(OrderedCollection
		cover: (168 to: 184)
		declaredAt: (168 to: 184)) new ] valueCoveringAll:
		{186 to: 188})
		cover: (159 to: 163)
		declaredAt: (159 to: 163).
	(itemCatalog _ aCatalog
		cover: (207 to: 214)
		declaredAt: (66 to: 73))
		cover: (192 to: 202)
		declaredAt: (192 to: 202).
	(clock _ aClock
		cover: (227 to: 232)
		declaredAt: (82 to: 87))
		cover: (218 to: 222)
		declaredAt: (218 to: 222).
	(lastTimeCartUsed _ [
	(OrderedCollection
		cover: (255 to: 271)
		declaredAt: (168 to: 184)) new ] valueCoveringAll:
		{273 to: 275})
		cover: (236 to: 251)
		declaredAt: (236 to: 251).
	(priceList _ aPriceList
		cover: (292 to: 301)
		declaredAt: (100 to: 109))
		cover: (279 to: 287)
		declaredAt: (279 to: 287).
	(cartOwner _ [
	(OrderedCollection
		cover: (318 to: 334)
		declaredAt: (168 to: 184)) new ] valueCoveringAll:
		{336 to: 338})
		cover: (305 to: 313)
		declaredAt: (305 to: 313).
	(userPurchases _ [
	(Dictionary
		cover: (360 to: 369)
		declaredAt: (360 to: 369)) new ] valueCoveringAll:
		{371 to: 373})
		cover: (342 to: 354)
		declaredAt: (342 to: 354).
	(invalidCarts _ [
	(OrderedCollection
		cover: (394 to: 410)
		declaredAt: (168 to: 184)) new ] valueCoveringAll:
		{412 to: 414})
		cover: (377 to: 388)
		declaredAt: (377 to: 388).
	(currentTransactionID _ 0 coverAll:
		{443 to: 443})
		cover: (418 to: 437)
		declaredAt: (418 to: 437).! !
!Behavior method!
createCartFor: aUserId authenticatedWith: aPassword
	[
	(clientAuthenticator
		cover: (54 to: 72)
		declaredAt: (54 to: 72))
		athenticateUser:
			(aUserId
				cover: (91 to: 97)
				declaredAt: (16 to: 22))
		withPassword:
			(aPassword
				cover: (113 to: 121)
				declaredAt: (43 to: 51)) ] valueCoveringAll:
		{74 to: 89. 99 to: 111}.
	[
	(carts
		cover: (128 to: 132)
		declaredAt: (128 to: 132)) add:
		([
		(Cart
			cover: (140 to: 143)
			declaredAt: (140 to: 143)) acceptingItemsOf:
			(itemCatalog
				cover: (163 to: 173)
				declaredAt: (163 to: 173)) ] valueCoveringAll:
			{145 to: 161}) ] valueCoveringAll:
		{134 to: 137}.
	[
	(cartOwner
		cover: (178 to: 186)
		declaredAt: (178 to: 186)) add:
		(aUserId
			cover: (193 to: 199)
			declaredAt: (16 to: 22)) ] valueCoveringAll:
		{188 to: 191}.
	[
	(lastTimeCartUsed
		cover: (203 to: 218)
		declaredAt: (203 to: 218)) add:
		([
		(clock
			cover: (225 to: 229)
			declaredAt: (225 to: 229)) now ] valueCoveringAll:
			{231 to: 233}) ] valueCoveringAll:
		{220 to: 223}.
	^ [
	(carts
		cover: (238 to: 242)
		declaredAt: (128 to: 132)) size ] valueCoveringAll:
		{244 to: 247}.! !
!Behavior method!
athenticateUser: aSmallInteger withPassword: aString
	[
	(authenticationErrorMessage
		cover: (56 to: 81)
		declaredAt: (56 to: 81)) ifNotNil: [
		[
		(self coverAll:
			{94 to: 97}) error:
			(authenticationErrorMessage
				cover: (106 to: 131)
				declaredAt: (56 to: 81)) ] valueCoveringAll:
			{99 to: 104} ]] valueCoveringAll:
		{83 to: 91}.! !
!Behavior method!
hasCarts
	^ [
	([
	(carts
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}) not ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:34:36'!
PASSED!
!Behavior method!
with: aDateTime
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) initializeWith:
		(aDateTime
			cover: (45 to: 53)
			declaredAt: (7 to: 15)) ] valueCoveringAll:
		{29 to: 43}.! !
!Behavior method!
initializeWith: aDateTime
	(dateTime _ aDateTime
		cover: (40 to: 48)
		declaredAt: (17 to: 25))
		cover: (28 to: 35)
		declaredAt: (28 to: 35).! !
!Behavior method!
now
	^ dateTime
		cover: (8 to: 15)
		declaredAt: (8 to: 15).! !
!Behavior method!
hasCartIdentified: aCartId
	[
	(carts
		cover: (33 to: 37)
		declaredAt: (33 to: 37))
		at:
			(aCartId
				cover: (43 to: 49)
				declaredAt: (20 to: 26))
		ifAbsent: [ ^ false coverAll:
				{64 to: 68} ]] valueCoveringAll:
		{39 to: 41. 51 to: 59}.
	[
	([
	(invalidCarts
		cover: (74 to: 85)
		declaredAt: (74 to: 85)) includes:
		(aCartId
			cover: (97 to: 103)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{87 to: 95}) ifTrue: [ ^ false coverAll:
			{116 to: 120} ]] valueCoveringAll:
		{106 to: 112}.
	^ [
	([
	(self coverAll:
		{128 to: 131}) expiredCart:
		(aCartId
			cover: (146 to: 152)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{133 to: 144}) not ] valueCoveringAll:
		{155 to: 157}.! !
!Behavior method!
expiredCart: aCartId
	^ [
	([
	([
	(lastTimeCartUsed
		cover: (28 to: 43)
		declaredAt: (28 to: 43)) at:
		(aCartId
			cover: (49 to: 55)
			declaredAt: (14 to: 20)) ] valueCoveringAll:
		{45 to: 47}) next:
		([
		([
		(TimeUnits
			cover: (65 to: 73)
			declaredAt: (65 to: 73)) minute ] valueCoveringAll:
			{75 to: 80}) with:
			([
			(self coverAll:
				{88 to: 91}) maxInactiveTimeInMinutes ] valueCoveringAll:
				{93 to: 116}) ] valueCoveringAll:
			{82 to: 86}) ] valueCoveringAll:
		{58 to: 62}) <
		([
		(clock
			cover: (122 to: 126)
			declaredAt: (122 to: 126)) now ] valueCoveringAll:
			{128 to: 130}) ] valueCoveringAll:
		{120 to: 120}.! !
!Behavior method!
maxInactiveTimeInMinutes
	^ 30 coverAll:
		{30 to: 31}.! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:34:37'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:34:37'!
PASSED!
!Behavior method!
listCart: cartID
	| cartList |
	[
	(self coverAll:
		{35 to: 38}) assertCartIDIsValid:
		(cartID
			cover: (61 to: 66)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{40 to: 59}.
	(cartList _ [
	(OrderedCollection
		cover: (82 to: 98)
		declaredAt: (82 to: 98)) new ] valueCoveringAll:
		{100 to: 102})
		cover: (70 to: 77)
		declaredAt: (23 to: 30).
	[
	([
	(carts
		cover: (107 to: 111)
		declaredAt: (107 to: 111)) at:
		(cartID
			cover: (117 to: 122)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{113 to: 115}) do: [ :book |
		[
		(cartList
			cover: (138 to: 145)
			declaredAt: (23 to: 30)) add:
			(book
				cover: (151 to: 154)
				declaredAt: (131 to: 134)) ] valueCoveringAll:
			{147 to: 150} ]] valueCoveringAll:
		{125 to: 127}.
	[
	(lastTimeCartUsed
		cover: (161 to: 176)
		declaredAt: (161 to: 176))
		at:
			(cartID
				cover: (182 to: 187)
				declaredAt: (11 to: 16))
		put:
			([
			(clock
				cover: (194 to: 198)
				declaredAt: (194 to: 198)) now ] valueCoveringAll:
				{200 to: 202}) ] valueCoveringAll:
		{178 to: 180. 189 to: 192}.
	^ cartList
		cover: (210 to: 217)
		declaredAt: (23 to: 30).! !
!Behavior method!
assertCartIDIsValid: cartID
	[
	([
	(self coverAll:
		{33 to: 36}) hasCartIdentified:
		(cartID
			cover: (57 to: 62)
			declaredAt: (22 to: 27)) ] valueCoveringAll:
		{38 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) invalidCartIDErrorDescription ] valueCoveringAll:
				{99 to: 127}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:34:37'!
PASSED!
!Behavior method!
invalidCartIDErrorDescription
	^ 'Cart ID is not in the system' coverAll:
		{33 to: 62}.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:34:37'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:34:37'!
PASSED!
!Behavior method!
addMinutes: anAmountOfMinutes
	(dateTime _ [
	(dateTime
		cover: (32 to: 39)
		declaredAt: (32 to: 39)) next:
		([
		([
		(TimeUnits
			cover: (60 to: 68)
			declaredAt: (60 to: 68)) minute ] valueCoveringAll:
			{70 to: 75}) with:
			(anAmountOfMinutes
				cover: (83 to: 99)
				declaredAt: (13 to: 29)) ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{53 to: 57})
		cover: (44 to: 51)
		declaredAt: (32 to: 39).! !

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:34:37'!
PASSED!
!Behavior method!
addToCart: aCartID bookISBN: aBookISBN bookQuantity: aBookQuantity
	[
	(self coverAll:
		{70 to: 73}) assertCartIDIsValid:
		(aCartID
			cover: (96 to: 102)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{75 to: 94}.
	[
	([
	(carts
		cover: (111 to: 115)
		declaredAt: (111 to: 115)) at:
		(aCartID
			cover: (121 to: 127)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{117 to: 119})
		add:
			(aBookQuantity
				cover: (135 to: 147)
				declaredAt: (54 to: 66))
		of:
			(aBookISBN
				cover: (153 to: 161)
				declaredAt: (30 to: 38)) ] valueCoveringAll:
		{130 to: 133. 149 to: 151}.
	[
	(lastTimeCartUsed
		cover: (167 to: 182)
		declaredAt: (167 to: 182))
		at:
			(aCartID
				cover: (187 to: 193)
				declaredAt: (12 to: 18))
		put:
			([
			(clock
				cover: (200 to: 204)
				declaredAt: (200 to: 204)) now ] valueCoveringAll:
				{206 to: 208}) ] valueCoveringAll:
		{184 to: 186. 195 to: 198}.! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:34:37'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:34:37'!
PASSED!
!Behavior method!
listPurchasesOf: aUserId password: aPassword
	[
	(clientAuthenticator
		cover: (48 to: 66)
		declaredAt: (48 to: 66))
		athenticateUser:
			(aUserId
				cover: (85 to: 91)
				declaredAt: (18 to: 24))
		withPassword:
			(aPassword
				cover: (107 to: 115)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{68 to: 83. 93 to: 105}.
	[
	([
	(userPurchases
		cover: (121 to: 133)
		declaredAt: (121 to: 133)) includesKey:
		(aUserId
			cover: (148 to: 154)
			declaredAt: (18 to: 24)) ] valueCoveringAll:
		{135 to: 146}) ifFalse: [
		[
		(userPurchases
			cover: (168 to: 180)
			declaredAt: (121 to: 133)) add:
			([
			(aUserId
				cover: (187 to: 193)
				declaredAt: (18 to: 24)) ->
				([
				(OrderedCollection
					cover: (198 to: 214)
					declaredAt: (198 to: 214)) new ] valueCoveringAll:
					{216 to: 218}) ] valueCoveringAll:
				{195 to: 196}) ] valueCoveringAll:
			{182 to: 185} ]] valueCoveringAll:
		{158 to: 165}.
	^ [
	(PurchaseList
		cover: (230 to: 241)
		declaredAt: (230 to: 241))
		withItems:
			([
			(userPurchases
				cover: (255 to: 267)
				declaredAt: (121 to: 133)) at:
				(aUserId
					cover: (273 to: 279)
					declaredAt: (18 to: 24)) ] valueCoveringAll:
				{269 to: 271})
		AndPriceList:
			(priceList
				cover: (296 to: 304)
				declaredAt: (296 to: 304)) ] valueCoveringAll:
		{243 to: 252. 282 to: 294}.! !
!Behavior method!
withItems: anItemList AndPriceList: aPriceList
	^ [
	([
	(self coverAll:
		{51 to: 54}) new ] valueCoveringAll:
		{56 to: 58})
		initializeWithItems:
			(anItemList
				cover: (81 to: 90)
				declaredAt: (12 to: 21))
		andPriceList:
			(aPriceList
				cover: (106 to: 115)
				declaredAt: (37 to: 46)) ] valueCoveringAll:
		{60 to: 79. 92 to: 104}.! !
!Behavior method!
initializeWithItems: anItemList andPriceList: aPriceList
	(itemList _ anItemList
		cover: (74 to: 83)
		declaredAt: (22 to: 31))
		cover: (62 to: 69)
		declaredAt: (62 to: 69).
	(priceList _ aPriceList
		cover: (100 to: 109)
		declaredAt: (47 to: 56))
		cover: (87 to: 95)
		declaredAt: (87 to: 95).! !
!Behavior method!
isEmpty
	^ [
	(itemList
		cover: (12 to: 19)
		declaredAt: (12 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !
!Behavior method!
totalAmount
	^ [
	(itemList
		cover: (16 to: 23)
		declaredAt: (16 to: 23))
		sum: [ :item |
			[
			(priceList
				cover: (38 to: 46)
				declaredAt: (38 to: 46))
				at:
					(item
						cover: (52 to: 55)
						declaredAt: (32 to: 35))
				ifAbsent: [ ]] valueCoveringAll:
				{48 to: 50. 57 to: 65} ]
		ifEmpty:
			(0 coverAll:
				{81 to: 81}) ] valueCoveringAll:
		{25 to: 28. 72 to: 79}.! !

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:34:37'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:34:37'!
PASSED!
!Behavior method!
checkoutCart: aCartId creditCard: aCreditCard
	| aSalesBook cashier userID |
	[
	(self coverAll:
		{80 to: 83}) assertCartIDIsValid:
		(aCartId
			cover: (106 to: 112)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{85 to: 104}.
	(aSalesBook _ [
	(OrderedCollection
		cover: (131 to: 147)
		declaredAt: (131 to: 147)) new ] valueCoveringAll:
		{149 to: 151})
		cover: (117 to: 126)
		declaredAt: (51 to: 60).
	(cashier _ [
	(Cashier
		cover: (166 to: 172)
		declaredAt: (166 to: 172))
		with:
			(priceList
				cover: (180 to: 188)
				declaredAt: (180 to: 188))
		registerSalesOn:
			(aSalesBook
				cover: (207 to: 216)
				declaredAt: (51 to: 60))
		merchantProcessor:
			([
			(MerchantProcessorSimulator
				cover: (237 to: 262)
				declaredAt: (237 to: 262)) new ] valueCoveringAll:
				{264 to: 266}) ] valueCoveringAll:
		{174 to: 178. 190 to: 205. 218 to: 235})
		cover: (155 to: 161)
		declaredAt: (62 to: 68).
	[
	(cashier
		cover: (272 to: 278)
		declaredAt: (62 to: 68))
		checkout:
			([
			(carts
				cover: (291 to: 295)
				declaredAt: (291 to: 295)) at:
				(aCartId
					cover: (301 to: 307)
					declaredAt: (15 to: 21)) ] valueCoveringAll:
				{297 to: 299})
		withCreditCard:
			(aCreditCard
				cover: (327 to: 337)
				declaredAt: (35 to: 45)) ] valueCoveringAll:
		{280 to: 288. 311 to: 325}.
	(userID _ [
	(cartOwner
		cover: (352 to: 360)
		declaredAt: (352 to: 360)) at:
		(aCartId
			cover: (365 to: 371)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{362 to: 364})
		cover: (342 to: 347)
		declaredAt: (70 to: 75).
	[
	([
	(userPurchases
		cover: (379 to: 391)
		declaredAt: (379 to: 391)) includesKey:
		(userID
			cover: (406 to: 411)
			declaredAt: (70 to: 75)) ] valueCoveringAll:
		{393 to: 404}) ifFalse: [
		[
		(userPurchases
			cover: (424 to: 436)
			declaredAt: (379 to: 391)) add:
			([
			(userID
				cover: (443 to: 448)
				declaredAt: (70 to: 75)) ->
				([
				(OrderedCollection
					cover: (452 to: 468)
					declaredAt: (131 to: 147)) new ] valueCoveringAll:
					{470 to: 472}) ] valueCoveringAll:
				{449 to: 450}) ] valueCoveringAll:
			{438 to: 441} ]] valueCoveringAll:
		{414 to: 421}.
	[
	([
	(userPurchases
		cover: (479 to: 491)
		declaredAt: (379 to: 391)) at:
		(userID
			cover: (497 to: 502)
			declaredAt: (70 to: 75)) ] valueCoveringAll:
		{493 to: 495}) addAll:
		([
		(self coverAll:
			{514 to: 517}) listCart:
			(aCartId
				cover: (529 to: 535)
				declaredAt: (15 to: 21)) ] valueCoveringAll:
			{519 to: 527}) ] valueCoveringAll:
		{505 to: 511}.
	[
	(self coverAll:
		{542 to: 545}) invalidateCartId:
		(aCartId
			cover: (565 to: 571)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{547 to: 563}.
	(currentTransactionID _ [
	(currentTransactionID
		cover: (577 to: 596)
		declaredAt: (577 to: 596)) +
		(1 coverAll:
			{624 to: 624}) ] valueCoveringAll:
		{622 to: 622})
		cover: (601 to: 620)
		declaredAt: (577 to: 596).
	^ currentTransactionID
		cover: (630 to: 649)
		declaredAt: (577 to: 596).! !
!Behavior method!
invalidateCartId: aCartID
	[
	(invalidCarts
		cover: (28 to: 39)
		declaredAt: (28 to: 39)) add:
		(aCartID
			cover: (46 to: 52)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{41 to: 44}.! !
!Behavior method!
list
	^ [
	(itemList
		cover: (9 to: 16)
		declaredAt: (9 to: 16)) copy ] valueCoveringAll:
		{18 to: 21}.! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:34:37'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:34:37'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:34:37'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:34:37'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:34:37'!
PASSED!

!methodRemoval: StoreTest #dateForTestingDelayed87Minutes stamp: 'ET 6/24/2021 00:35:12'!
dateForTestingDelayed87Minutes

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 01:27:00!

!methodRemoval: StoreTest #dateForTestingDelayed62Minutes stamp: 'ET 6/24/2021 00:35:16'!
dateForTestingDelayed62Minutes

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 01:02:00!

!methodRemoval: StoreTest #dateForTestingDelayed56Minutes stamp: 'ET 6/24/2021 00:35:20'!
dateForTestingDelayed56Minutes

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:56:00!

!methodRemoval: StoreTest #dateForTestingDelayed31Minutes stamp: 'ET 6/24/2021 00:35:24'!
dateForTestingDelayed31Minutes

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:31:00!

!methodRemoval: StoreTest #dateForTestingDelayed25Minutes stamp: 'ET 6/24/2021 00:35:27'!
dateForTestingDelayed25Minutes

	^ GregorianDateTime date: (FixedGregorianDate yearNumber: 2004 month: GregorianMonth january dayNumber: 1) timeOfDay: 00:25:00!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:35:31'!
PASSED!

!methodRemoval: ClockSimulator #set: stamp: 'ET 6/24/2021 00:35:59'!
set: aDateTime
	dateTime := aDateTime .!

----SNAPSHOT----(24 June 2021 00:43:08) CuisUniversity-4532.image priorSource: 23260928!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:45:41' prior: 51062410!
createCartFor: aUserId authenticatedWith: aPassword
	clientAuthenticator athenticateUser: aUserId withPassword: aPassword. 
	
	carts add: (Cart acceptingItemsOf: priceList keys).
	cartOwner add: aUserId.
	lastTimeCartUsed add: clock now.
	^carts size.
	
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:46:25'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:46:25'!
PASSED!
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 00:46:38' prior: 51062354!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.
	userPurchases  := Dictionary new.
	invalidCarts  := OrderedCollection new.
	currentTransactionID  := 0.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:46:39'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:46:39'!
PASSED!
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 00:46:51'!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.
	userPurchases  := Dictionary new.
	invalidCarts  := OrderedCollection new.
	currentTransactionID  := 0.! !
!Store class methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:46:51' prior: 51062479!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: priceList   
	^self new initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList.! !

!methodRemoval: Store #initializeWithClientAuthenticator:catalog:clock:priceList: stamp: 'ET 6/24/2021 00:46:51'!
initializeWithClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.
	userPurchases  := Dictionary new.
	invalidCarts  := OrderedCollection new.
	currentTransactionID  := 0.!
!Store class methodsFor: 'instance creation' stamp: 'ET 6/24/2021 00:47:17'!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList   
	^self new initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:47:17' prior: 51061947!
store
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: self clockSimulator priceList: TestObjects new defaultPriceList.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:47:17' prior: 51062876!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.
	
	
	self should: [store addToCart: cartID1 bookISBN: 123456789 bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:47:17' prior: 51061764!
test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated

	| store clientAuthenticatorSimulator errorMessage |
	store := self store .		
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator clock: GregorianDateTime now priceList: TestObjects new defaultPriceList .
	
	
	self should: [
		store listPurchasesOf: 123 password: 'passwd'.
	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 	
		self assert: errorMessage  equals: exception messageText.
		self deny: store hasCarts.
	]
	
	
	
			! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:47:17' prior: 51061621!
test01CanNotCreateCartWhenCredentialsCantBeAuthenticated

	| store errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator clock: GregorianDateTime now priceList: TestObjects new defaultPriceList .
	
	
	self should: [
		store createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: store hasCarts.
		]
	
	
	
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:47:18' prior: 51062805!
test07CartIsInvalidAfter30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.

	self deny: (store hasCartIdentified: cartID1).
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:47:18' prior: 51062774!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.								
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 bookISBN: TestObjects new itemSellByTheStore bookQuantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!methodRemoval: Store class #withClientAuthenticator:catalog:clock:priceList: stamp: 'ET 6/24/2021 00:47:18'!
withClientAuthenticator: aClientAuthenticator catalog: aCatalog clock: aClock priceList: priceList   
	^self new initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList.!

!classDefinition: #Store category: 'TusLibros' stamp: 'ET 6/24/2021 00:50:00'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases invalidCarts currentTransactionID salesBook'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:51:05' prior: 51062387!
checkoutCart: aCartId creditCard: aCreditCard 
	| cashier userID |
	self assertCartIDIsValid: aCartId .
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard .
	userID := cartOwner at:aCartId. 
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).
	
	self invalidateCartId: aCartId.
	
	currentTransactionID := currentTransactionID + 1.
	^ currentTransactionID.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:51:08'!
ERROR!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:51:08'!
ERROR!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:51:08'!
ERROR!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:51:08'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:51:21'!
ERROR!
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 00:51:48' prior: 51064207!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.
	userPurchases  := Dictionary new.
	invalidCarts  := OrderedCollection new.
	currentTransactionID  := 0.
	salesBook := OrderedCollection new.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:51:51'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:51:52'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:51:52'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:51:52'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:51:54'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:51:54'!
PASSED!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:52:51' prior: 51064406!
checkoutCart: aCartId creditCard: aCreditCard 
	| cashier userID |
	self assertCartIDIsValid: aCartId.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard.
	userID := cartOwner at:aCartId. 
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).
	
	self invalidateCartId: aCartId.
	
	currentTransactionID := currentTransactionID + 1.
	^ currentTransactionID.! !

!classDefinition: #Store category: 'TusLibros' stamp: 'ET 6/24/2021 00:54:01'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases invalidCarts currentTransactionID salesBook cashierr'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:53:59' prior: 51064604!
checkoutCart: aCartId creditCard: aCreditCard 
	| userID |
	self assertCartIDIsValid: aCartId.
	
	cashierr checkout: (carts at: aCartId ) withCreditCard: aCreditCard.
	userID := cartOwner at:aCartId. 
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).
	
	self invalidateCartId: aCartId.
	
	currentTransactionID := currentTransactionID + 1.
	^ currentTransactionID.! !

!classDefinition: #Store category: 'TusLibros' stamp: 'ET 6/24/2021 00:54:07'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases invalidCarts currentTransactionID salesBook cashierr cashier'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:54:05' prior: 51064633!
checkoutCart: aCartId creditCard: aCreditCard 
	| userID |
	self assertCartIDIsValid: aCartId.
	
	cashier checkout: (carts at: aCartId ) withCreditCard: aCreditCard.
	userID := cartOwner at:aCartId. 
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).
	
	self invalidateCartId: aCartId.
	
	currentTransactionID := currentTransactionID + 1.
	^ currentTransactionID.! !

Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases invalidCarts currentTransactionID salesBook cashier'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'ET 6/24/2021 00:54:13'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases invalidCarts currentTransactionID salesBook cashier'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 00:54:53' prior: 51064483!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := OrderedCollection new.
	clock := aClock.
	lastTimeCartUsed :=OrderedCollection new.
	priceList := aPriceList.
	cartOwner := OrderedCollection new.
	userPurchases  := Dictionary new.
	invalidCarts  := OrderedCollection new.
	currentTransactionID  := 0.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	
! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 00:59:21' prior: 51062445!
listCart: cartID
	
	| cartList |
	self assertCartIDIsValid: cartID.
	cartList := OrderedCollection new.
	(carts at: cartID) do: [:anItem | cartList add: anItem].
	
	lastTimeCartUsed at: cartID put: clock now.
	
	^ cartList.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 00:59:22'!
PASSED!

----SNAPSHOT----(24 June 2021 01:00:27) CuisUniversity-4532.image priorSource: 23437506!
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 01:02:56' prior: 51064699!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := Dictionary new.
	clock := aClock.
	lastTimeCartUsed := Dictionary new.
	priceList := aPriceList.
	cartOwner := Dictionary new.
	userPurchases  := Dictionary new.
	invalidCarts  := Dictionary new.
	currentTransactionID  := 0.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	
! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:04:20' prior: 51062371!
addToCart: aCartID bookISBN: aBookISBN bookQuantity: aBookQuantity

	self assertCartIDIsValid: aCartID	.
	
	(carts at: aCartID) add: aBookQuantity of: aBookISBN.
	
	lastTimeCartUsed at:aCartID put: clock now.! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:05:03' prior: 51062428!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	(invalidCarts includesKey: aCartId) ifTrue:[^ false].
	^ (self expiredCart: aCartId) not.
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:05:31' prior: 51064662!
checkoutCart: aCartId creditCard: aCreditCard 
	| userID |
	self assertCartIDIsValid: aCartId.
	
	cashier checkout: (carts at: aCartId) withCreditCard: aCreditCard.
	userID := cartOwner at:aCartId. 
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).
	
	self invalidateCartId: aCartId.
	
	currentTransactionID := currentTransactionID + 1.
	^ currentTransactionID.! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:05:35' prior: 51064823!
checkoutCart: aCartId creditCard: aCreditCard 
	| userID |
	self assertCartIDIsValid: aCartId.
	
	cashier checkout: (carts at: aCartId) withCreditCard: aCreditCard.
	userID := cartOwner at: aCartId. 
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).
	
	self invalidateCartId: aCartId.
	
	currentTransactionID := currentTransactionID + 1.
	^ currentTransactionID.! !
!ClientAuthenticatorSimulator methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:06:57'!
authenticateUser: aSmallInteger withPassword: aString 
	authenticationErrorMessage ifNotNil: [self error: authenticationErrorMessage].! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:06:57' prior: 51062455!
listPurchasesOf: aUserId password: aPassword

	clientAuthenticator authenticateUser: aUserId withPassword: aPassword. 
	(userPurchases includesKey: aUserId ) ifFalse: [userPurchases add: aUserId ->(OrderedCollection new)].				
	^ PurchaseList withItems: (userPurchases at: aUserId) AndPriceList: priceList .
	! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:06:57' prior: 51064076!
createCartFor: aUserId authenticatedWith: aPassword
	clientAuthenticator authenticateUser: aUserId withPassword: aPassword. 
	
	carts add: (Cart acceptingItemsOf: priceList keys).
	cartOwner add: aUserId.
	lastTimeCartUsed add: clock now.
	^carts size.
	
	! !

!methodRemoval: ClientAuthenticatorSimulator #athenticateUser:withPassword: stamp: 'ET 6/24/2021 01:06:57'!
athenticateUser: aSmallInteger withPassword: aString 
	authenticationErrorMessage ifNotNil: [self error: authenticationErrorMessage].!

x := Dictionary new.!

x size.!

x add: x size -> 'hola'.!

x!

x := 1.!

x next!

!classDefinition: #Store category: 'TusLibros' stamp: 'ET 6/24/2021 01:10:58'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases invalidCarts currentTransactionID salesBook cashier currentCartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:10:57' prior: 51064880!
createCartFor: userID authenticatedWith: aPassword
	|cartID|
	clientAuthenticator authenticateUser: userID withPassword: aPassword. 
	
	cartID := currentCartID.
	currentCartID := currentCartID + 1.
	carts add: cartID -> (Cart acceptingItemsOf: priceList keys).
	cartOwner add: cartID -> userID.
	lastTimeCartUsed add: cartID -> clock now.
	^cartID
	
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:11:17'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:11:17'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:11:17'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:11:17'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:11:17'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:11:17'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:11:17'!
ERROR!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:11:17'!
ERROR!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:11:17'!
ERROR!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:11:17'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:11:17'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:11:17'!
ERROR!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:11:17'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:11:17'!
ERROR!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:11:17'!
ERROR!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:11:17'!
ERROR!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:11:29'!
ERROR!
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 01:11:51' prior: 51064785!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := Dictionary new.
	clock := aClock.
	lastTimeCartUsed := Dictionary new.
	priceList := aPriceList.
	cartOwner := Dictionary new.
	userPurchases  := Dictionary new.
	invalidCarts  := Dictionary new.
	currentTransactionID  := 0.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	currentCartID := 0.
	
! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:11:52'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:11:52'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:11:53'!
ERROR!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:11:53'!
ERROR!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:11:53'!
ERROR!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:11:53'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:11:55'!
ERROR!
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 01:12:53' prior: 51064982!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := Dictionary new.
	clock := aClock.
	lastTimeCartUsed := Dictionary new.
	priceList := aPriceList.
	cartOwner := Dictionary new.
	userPurchases  := Dictionary new.
	invalidCarts  := OrderedCollection new.
	currentTransactionID  := 0.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	currentCartID := 0.
	
! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:12:53'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:12:53'!
ERROR!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:12:53'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:12:53'!
ERROR!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:12:53'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:12:53'!
ERROR!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:12:53'!
ERROR!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:12:53'!
ERROR!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:12:53'!
ERROR!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:12:53'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:12:53'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:12:54'!
ERROR!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:12:54'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:12:54'!
ERROR!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:12:54'!
ERROR!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:12:54'!
ERROR!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:12:56'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:13:04' prior: 51064815!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	(invalidCarts includes: aCartId) ifTrue:[^ false].
	^ (self expiredCart: aCartId) not.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:13:07'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:13:07'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:13:07'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:13:07'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:13:07'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:13:07'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:13:07'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:13:07'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:13:08'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:13:08'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:13:08'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:13:08'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:13:08'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:13:08'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:13:08'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:13:08'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:13:12'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:13:12'!
PASSED!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:19:01' prior: 51062440!
invalidateCartId: aCartID
	carts removeKey: aCartID.
	lastTimeCartUsed removeKey: aCartID.
	cartOwner removeKey: aCartID.
	invalidCarts add: aCartID.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:19:06'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:19:06'!
PASSED!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:19:47' prior: 51065133!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	"(invalidCarts includes: aCartId) ifTrue:[^ false]."
	^ (self expiredCart: aCartId) not.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:19:48'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:19:48'!
PASSED!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:21:20' prior: 51065305!
hasCartIdentified: aCartId 
	
 	carts at: aCartId ifAbsent: [^ false].
	(self expiredCart: aCartId) 
		ifTrue: [self invalidateCartId: aCartId.
			^false].
	^true.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:21:20'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:21:20'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:21:20'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:21:20'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:21:20'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:21:20'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:21:20'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:21:20'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:21:21'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:21:21'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:21:21'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:21:21'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:21:21'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:21:21'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:21:21'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:21:21'!
PASSED!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:21:48' prior: 51065245!
invalidateCartId: aCartID
	carts removeKey: aCartID.
	lastTimeCartUsed removeKey: aCartID.
	cartOwner removeKey: aCartID.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:21:48'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:21:49'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:21:49'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:21:49'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:21:49'!
PASSED!
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 01:22:14' prior: 51065058!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := Dictionary new.
	clock := aClock.
	lastTimeCartUsed := Dictionary new.
	priceList := aPriceList.
	cartOwner := Dictionary new.
	userPurchases  := Dictionary new.
	currentTransactionID  := 0.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	currentCartID := 0.
	
! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:22:14'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:22:14'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:22:14'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:22:14'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:22:14'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:22:14'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:22:14'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:22:14'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:22:14'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:22:15'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:22:15'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:22:15'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:22:15'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:22:15'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:22:15'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:22:15'!
PASSED!

Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases currentTransactionID salesBook cashier currentCartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'ET 6/24/2021 01:22:21'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock priceList cartOwner userPurchases currentTransactionID salesBook cashier currentCartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:22:25'!
PASSED!

----SNAPSHOT----(24 June 2021 01:22:33) CuisUniversity-4532.image priorSource: 23460187!

x := Dictionary with: 2->3.!

x !

x at: 2!

x at: 1!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:35:45'!
addToCart: aCartID item: aBookISBN quantity: aBookQuantity

	self assertCartIDIsValid: aCartID	.
	
	(carts at: aCartID) add: aBookQuantity of: aBookISBN.
	
	lastTimeCartUsed at:aCartID put: clock now.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:35:45' prior: 51061738!
test09ItemsAddedToCartAreListed

	| store cartID1 cartList validBook |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	validBook _ TestObjects new itemSellByTheStore.
	store addToCart: cartID1 item: validBook quantity:10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: (cartList occurrencesOf: validBook ).
	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:35:45' prior: 51064356!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 item: TestObjects new itemSellByTheStore quantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.								
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 item: TestObjects new itemSellByTheStore quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:35:45' prior: 51061791!
test12CheckoutUpdatesPurchaseListOfUserWithTheSales

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 item: TestObjects new itemSellByTheStore quantity: 10.
	
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases list size.
	self assert: 10 equals: (purchases list occurrencesOf: TestObjects new itemSellByTheStore).
	self assert: 100 equals: purchases totalAmount.	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:35:45' prior: 51061839!
test15CheckoutCartReturnsUniqueTransactionIDs

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	
	store addToCart: cartID1 item: TestObjects new itemSellByTheStore quantity: 10.
	store addToCart: cartID2 item: TestObjects new itemSellByTheStore quantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:35:45' prior: 51064266!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: TestObjects new defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.
	
	
	self should: [store addToCart: cartID1 item: 123456789 quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:35:45' prior: 51061825!
test14CheckoutInvalidatesCartId

	| store cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 item: TestObjects new itemSellByTheStore quantity: 10.
		
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	self deny: (store hasCartIdentified: cartID1).! !

!methodRemoval: Store #addToCart:bookISBN:bookQuantity: stamp: 'ET 6/24/2021 01:35:45'!
addToCart: aCartID bookISBN: aBookISBN bookQuantity: aBookQuantity

	self assertCartIDIsValid: aCartID	.
	
	(carts at: aCartID) add: aBookQuantity of: aBookISBN.
	
	lastTimeCartUsed at:aCartID put: clock now.!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:36:03' prior: 51065630!
addToCart: aCartID item: anItem quantity: aBookQuantity

	self assertCartIDIsValid: aCartID	.
	
	(carts at: aCartID) add: aBookQuantity of: anItem.
	
	lastTimeCartUsed at:aCartID put: clock now.! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 01:36:11' prior: 51065777!
addToCart: aCartID item: anItem quantity: aQuantity

	self assertCartIDIsValid: aCartID	.
	
	(carts at: aCartID) add: aQuantity of: anItem.
	
	lastTimeCartUsed at:aCartID put: clock now.! !

TestCase subclass: #StoreTest
	instanceVariableNames: 'testObjects'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreTest category: 'TusLibros' stamp: 'ET 6/24/2021 01:37:57'!
TestCase subclass: #StoreTest
	instanceVariableNames: 'testObjects'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreTest methodsFor: 'support' stamp: 'ET 6/24/2021 01:38:13' overrides: 16896425!
initialize

	testObjects := TestObjects new.! !
!StoreTest methodsFor: 'support' stamp: 'ET 6/24/2021 01:38:48' overrides: 16927572!
setUp

	testObjects := TestObjects new.! !

!methodRemoval: StoreTest #initialize stamp: 'ET 6/24/2021 01:38:48'!
initialize

	testObjects := TestObjects new.!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:39:08' prior: 51064314!
test01CanNotCreateCartWhenCredentialsCantBeAuthenticated

	| store errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator clock: GregorianDateTime now priceList: testObjects defaultPriceList.
	
	
	self should: [
		store createCartFor: 123 authenticatedWith: 'passwd'
		] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 
	
	self assert: errorMessage  equals: exception messageText.
			self deny: store hasCarts.
		]
	
	
	
		! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:39:09'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:39:09'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:39:42' prior: 51064340!
test07CartIsInvalidAfter30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.

	self deny: (store hasCartIdentified: cartID1).
		! !
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:39:50' prior: 51065731!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.
	
	
	self should: [store addToCart: cartID1 item: 123456789 quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:39:58' prior: 51065640!
test09ItemsAddedToCartAreListed

	| store cartID1 cartList validBook |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	validBook _ testObjects itemSellByTheStore.
	store addToCart: cartID1 item: validBook quantity:10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: (cartList occurrencesOf: validBook ).
	! !
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:40:09' prior: 51064288!
test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated

	| store clientAuthenticatorSimulator errorMessage |
	store := self store .		
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator clock: GregorianDateTime now priceList: testObjects defaultPriceList .
	
	
	self should: [
		store listPurchasesOf: 123 password: 'passwd'.
	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 	
		self assert: errorMessage  equals: exception messageText.
		self deny: store hasCarts.
	]
	
	
	
			! !
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:40:18' prior: 51065685!
test12CheckoutUpdatesPurchaseListOfUserWithTheSales

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	
	store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases list size.
	self assert: 10 equals: (purchases list occurrencesOf: TestObjects new itemSellByTheStore).
	self assert: 100 equals: purchases totalAmount.	! !
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:40:53' prior: 51065978!
test12CheckoutUpdatesPurchaseListOfUserWithTheSales

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	
	store checkoutCart: cartID1 creditCard: testObjects validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases list size.
	self assert: 10 equals: (purchases list occurrencesOf: testObjects itemSellByTheStore).
	self assert: 10 * testObjects itemInStorePrice equals: purchases totalAmount.	! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:40:54'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:40:54'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:41:10' prior: 51061812!
test13CannotCheckoutWithInvalidCartID

	| store |
	store := self store .
	
	self should:  [store checkoutCart: -1 creditCard: testObjects validCreditCard .]
		raise: Error - MessageNotUnderstood 
		withExceptionDo: [:exception | self assert: Store invalidCartIDErrorDescription equals: exception messageText]
	
	
	! !

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:41:12'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:41:13'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:41:13'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:41:13'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:41:13'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:41:13'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:41:32' prior: 51065753!
test14CheckoutInvalidatesCartId

	| store cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
		
	store checkoutCart: cartID1 creditCard: TestObjects validCreditCard .
	
	self deny: (store hasCartIdentified: cartID1).! !
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:41:37' prior: 51066144!
test14CheckoutInvalidatesCartId

	| store cartID1 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
		
	store checkoutCart: cartID1 creditCard: testObjects validCreditCard .
	
	self deny: (store hasCartIdentified: cartID1).! !

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:41:38'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:41:38'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:41:57' prior: 51065707!
test15CheckoutCartReturnsUniqueTransactionIDs

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	store addToCart: cartID2 item: testObjects new itemSellByTheStore quantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:42:00' prior: 51066227!
test15CheckoutCartReturnsUniqueTransactionIDs

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	store addToCart: cartID2 item: testObjects itemSellByTheStore quantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:42:01'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:42:01'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:42:09' prior: 51065656!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 item: TestObjects new itemSellByTheStore quantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.								
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 item: TestObjects new itemSellByTheStore quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:42:18' prior: 51066330!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.								
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:42:19'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:42:19'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:42:39' prior: 51066359!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.								
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 item: TestObjects new itemSellByTheStore quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 01:42:39'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:42:40'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:42:40'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:42:48' prior: 51066442!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.								
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:42:49'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:42:49'!
PASSED!
!StoreTest methodsFor: 'support' stamp: 'ET 6/24/2021 01:44:53' prior: 51064258!
store
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: self clockSimulator priceList: testObjects defaultPriceList.! !

Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts lastTimeCartUsed clock priceList cartOwner userPurchases currentTransactionID salesBook cashier currentCartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'ET 6/24/2021 01:45:22'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts lastTimeCartUsed clock priceList cartOwner userPurchases currentTransactionID salesBook cashier currentCartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:45:24'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:45:24'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:45:24'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:45:24'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:45:24'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:45:24'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:45:24'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:45:24'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:45:24'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:45:24'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:45:25'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:45:25'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:45:25'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:45:25'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:45:25'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:45:25'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:49:57' prior: 51065819!
test01CanNotCreateCartWhenCredentialsCantBeAuthenticated

	| store errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator clock: GregorianDateTime now priceList: testObjects defaultPriceList.
	
	
	self should: [		store createCartFor: 123 authenticatedWith: 'passwd'	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :anError | 	self assert: errorMessage  equals: anError messageText.
					self deny: store hasCarts.]
	
	
	
		! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:49:59'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:49:59'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:50:05' prior: 51061647!
test02StoreHasNewCreatedCart

	| store aCartId |
	store := self store.
	
	aCartId := store createCartFor: 123 authenticatedWith: 'passwd'.

	self assert: store hasCarts.
	self assert: (store hasCartIdentified: aCartId).

	
	
	
		! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:50:06'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:50:06'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:50:46'!
test07CartIsInvalidAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.

	self deny: (store hasCartIdentified: cartID1).
		! !

!methodRemoval: StoreTest #test07CartIsInvalidAfter30Min stamp: 'ET 6/24/2021 01:50:46'!
test07CartIsInvalidAfter30Min

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.

	self deny: (store hasCartIdentified: cartID1).
		!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:51:33' prior: 51065936!
test09ItemsAddedToCartAreListed

	| store cartID1 cartList |
	store := self store .
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.
	
	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity:10.
	cartList := store listCart: cartID1 .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: (cartList occurrencesOf: testObjects itemSellByTheStore).
	! !
!StoreTest methodsFor: 'tests' stamp: 'ET 6/24/2021 01:51:43' prior: 51066925!
test09ItemsAddedToCartAreListed

	| store cartID cartList |
	store := self store .
	cartID := store createCartFor: 123 authenticatedWith: 'passwd'.
	
	
	store addToCart: cartID item: testObjects itemSellByTheStore quantity:10.
	cartList := store listCart: cartID .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: (cartList occurrencesOf: testObjects itemSellByTheStore).
	! !

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 01:51:44'!
PASSED!

----SNAPSHOT----(24 June 2021 01:53:15) CuisUniversity-4532.image priorSource: 23487200!

!classDefinition: #Sales category: 'TusLibros' stamp: 'ET 6/24/2021 01:59:02'!
Object subclass: #Sales
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Cashier methodsFor: 'checkout' stamp: 'ET 6/24/2021 01:58:58' prior: 51062057!
checkout: aCart withCreditCard: aCreditCard 
	|totalPrice items sales|
	self assertCartIsNotEmpty: aCart.
	self assertCreditCardIsNotExpired: aCreditCard.
	totalPrice := 0.
	items := OrderedCollection new.
	aCart do: [:anItem | totalPrice := totalPrice + priceList at: anItem ifAbsent: [self raiseItemNotInPriceListError].
		items add: anItem].
	merchantProcessor charge: totalPrice  on: aCreditCard .
	sales := Sales withItems: items totalAmount: totalPrice.
	salesBook add: sales.
	^sales.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 02:01:20' prior: 51061416!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := self createCart.
	cart add: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals:  (sales).
	self assert: 1 equals: aSalesBook size.
	self assert: self itemInStorePrice equals: aSalesBook first.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 02:01:47' prior: 51067038!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := self createCart.
	cart add: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals:  sales totalAmount.
	self assert: 1 equals: sales items size.
	self assert: self itemInStorePrice equals: sales items first.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 02:01:49'!
ERROR!
!Sales class methodsFor: 'instance creation' stamp: 'ET 6/24/2021 02:01:56'!
withItems: anOrderedCollection totalAmount: aSmallInteger 
	"DO NOT FORGET TO RENAME COLLABORATORS AND REMOVE THIS COMMENT!!!!"
	self shouldBeImplemented.
	^self new initializeWithItems: anOrderedCollection totalAmount: aSmallInteger ! !
!Sales class methodsFor: 'instance creation' stamp: 'ET 6/24/2021 02:02:18' prior: 51067076!
withItems: items totalAmount: anAmount

	^self new initializeWithItems: items totalAmount: anAmount.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 02:02:21'!
ERROR!

!classDefinition: #Sales category: 'TusLibros' stamp: 'ET 6/24/2021 02:02:36'!
Object subclass: #Sales
	instanceVariableNames: 'items_CHANGE_ME'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Sales category: 'TusLibros' stamp: 'ET 6/24/2021 02:02:37'!
Object subclass: #Sales
	instanceVariableNames: 'items_CHANGE_ME amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Sales methodsFor: 'initialization' stamp: 'ET 6/24/2021 02:02:37'!
initializeWithItems: items totalAmount: anAmount 
	self shouldBeImplemented.
	items_CHANGE_ME := items.
	amount := anAmount.! !
!Sales methodsFor: 'initialization' stamp: 'ET 6/24/2021 02:03:19' prior: 51067110!
initializeWithItems: aCollectionOfItems totalAmount: anAmount 

	items_CHANGE_ME := aCollectionOfItems.
	amount := anAmount.! !

!classDefinition: #Sales category: 'TusLibros' stamp: 'ET 6/24/2021 02:03:23'!
Object subclass: #Sales
	instanceVariableNames: 'items_CHANGE_ME amount items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Sales methodsFor: 'initialization' stamp: 'ET 6/24/2021 02:03:22' prior: 51067117!
initializeWithItems: aCollectionOfItems totalAmount: anAmount 

	items := aCollectionOfItems.
	amount := anAmount.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 02:03:24'!
ERROR!
!Sales methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 02:03:29'!
totalAmount
	self shouldBeImplemented.! !
!Sales methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 02:03:34' prior: 51067141!
totalAmount
	^amount.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 02:03:36'!
ERROR!
!Sales methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 02:03:41'!
items
	self shouldBeImplemented.
	^items! !
!Sales methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 02:03:44' prior: 51067153!
items
	^items! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 02:03:46'!
FAILURE!

sales!

self itemInStorePrice!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 02:05:02' prior: 51067055!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := self createCart.
	cart add: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals:  sales totalAmount.
	self assert: 1 equals: sales items size.
	self assert: self itemInStore equals: sales items first.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 02:05:05'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 02:05:05'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 02:05:05'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 02:05:05'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 02:05:05'!
FAILURE!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 02:05:05'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 02:05:05'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 02:05:05'!
FAILURE!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 02:05:18' prior: 51061432!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := self createCart.
	cart add: 2 of: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 2 equals:  (sales).
	self assert: 1 equals: aSalesBook size.
	self assert: 2 * self itemInStorePrice equals: aSalesBook first.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 02:05:49' prior: 51067166!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := self createCart.
	cart add: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: self itemInStorePrice equals:  sales totalAmount.
	self assert: 1 equals: sales items size.
	self assert: self itemInStore equals: sales items first.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 02:06:47' prior: 51067213!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := self createCart.
	cart add: 2 of: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 2 * self itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 02:07:55' prior: 51067249!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := self createCart.
	cart add: 2 of: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 2 equals: (sales occurrencesOf: self itemInStore).
	self assert: 2 * self itemInStorePrice equals: sales totalAmount.! !

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 02:07:58'!
ERROR!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 02:08:14' prior: 51067267!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := self createCart.
	cart add: 2 of: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 2 equals: (sales items occurrencesOf: self itemInStore).
	self assert: 2 * self itemInStorePrice equals: sales totalAmount.! !

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 02:08:16'!
PASSED!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 02:08:54' prior: 51067231!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := self createCart.
	cart add: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 1 equals: (sales items occurrencesOf: self itemInStore).
	self assert: self itemInStorePrice equals: sales totalAmount.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 02:08:56'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 02:08:56'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 02:08:56'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 02:08:56'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 02:08:56'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 02:08:56'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 02:08:56'!
PASSED!

Object subclass: #Sales
	instanceVariableNames: 'userID amount items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Sales category: 'TusLibros' stamp: 'ET 6/24/2021 02:09:31'!
Object subclass: #Sales
	instanceVariableNames: 'userID amount items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Sales methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 02:09:52'!
userID: aUserID
	userID := aUserID.! !
!Sales methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 02:09:59'!
userID
	^userID.! !
!Store methodsFor: 'checkout' stamp: 'ET 6/24/2021 02:10:56' prior: 51064841!
checkoutCart: aCartId creditCard: aCreditCard 
	| userID |
	self assertCartIDIsValid: aCartId.
	
	cashier checkout: (carts at: aCartId) withCreditCard: aCreditCard.
	userID := cartOwner at: aCartId. 
	salesBook last userID: userID.
	
	
	(userPurchases includesKey: userID) ifFalse: [userPurchases add: userID->(OrderedCollection new)].
	(userPurchases at: userID) addAll: (self listCart: aCartId).
	
	self invalidateCartId: aCartId.
	
	currentTransactionID := currentTransactionID + 1.
	^ currentTransactionID.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 02:10:57'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 02:10:57'!
PASSED!
!Store methodsFor: 'lists' stamp: 'ET 6/24/2021 02:16:57' prior: 51064867!
listPurchasesOf: aUserId password: aPassword
	|userIDSales items totalAmount|
	clientAuthenticator authenticateUser: aUserId withPassword: aPassword. 
	(userPurchases includesKey: aUserId ) ifFalse: [userPurchases add: aUserId ->(OrderedCollection new)].				
	userIDSales := salesBook select: [:aSales | aSales userID = aUserId].
	items := OrderedCollection new.
	userIDSales do: [:aSales | items addAll: aSales items].
	totalAmount := userIDSales sum: [:aSales | aSales totalAmount] ifEmpty: 0.
	^ PurchaseList withItems: items totalAmount: totalAmount.
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 02:17:11'!
ERROR!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 02:17:11'!
ERROR!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 02:17:11'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 02:17:17'!
ERROR!
!PurchaseList class methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 02:18:11'!
withItems: anItemList totalAmount: anAmount.
	^ self new initializeWithItems: anItemList totalAmount: anAmount .! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 02:18:14'!
ERROR!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 02:18:14'!
ERROR!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 02:18:14'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 02:18:16'!
ERROR!

!classDefinition: #PurchaseList category: 'TusLibros' stamp: 'ET 6/24/2021 02:18:26'!
Object subclass: #PurchaseList
	instanceVariableNames: 'itemList priceList amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!PurchaseList methodsFor: 'initialization' stamp: 'ET 6/24/2021 02:18:26'!
initializeWithItems: anItemList totalAmount: anAmount 
	self shouldBeImplemented.
	itemList := anItemList.
	amount := anAmount.! !
!PurchaseList methodsFor: 'initialization' stamp: 'ET 6/24/2021 02:18:45' prior: 51067596!
initializeWithItems: anItemList totalAmount: anAmount 
	itemList := anItemList.
	amount := anAmount.! !

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 02:18:47'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 02:18:49'!
ERROR!
!PurchaseList methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 02:19:10' prior: 51062316!
totalAmount
	^amount.! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 02:19:12'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 02:19:14'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 02:19:14'!
PASSED!
!Behavior method!
raiseAuthenticationErrorWithMessage: anErrorMessage
	(authenticationErrorMessage _ anErrorMessage
		cover: (84 to: 97)
		declaredAt: (38 to: 51))
		cover: (54 to: 79)
		declaredAt: (54 to: 79).! !
!Behavior method!
defaultPriceList
	^ [
	(Dictionary
		cover: (21 to: 30)
		declaredAt: (21 to: 30)) with:
		([
		([
		(self coverAll:
			{38 to: 41}) itemSellByTheStore ] valueCoveringAll:
			{43 to: 60}) ->
			([
			(self coverAll:
				{65 to: 68}) itemInStorePrice ] valueCoveringAll:
				{70 to: 85}) ] valueCoveringAll:
			{62 to: 63}) ] valueCoveringAll:
		{32 to: 36}.! !
!Behavior method!
itemSellByTheStore
	^ 'validBook' coverAll:
		{25 to: 35}.! !
!Behavior method!
itemInStorePrice
	^ 10 coverAll:
		{21 to: 22}.! !
!Behavior method!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWithClientAuthenticator:
			(aClientAuthenticator
				cover: (131 to: 150)
				declaredAt: (26 to: 45))
		clock:
			(aClock
				cover: (159 to: 164)
				declaredAt: (54 to: 59))
		priceList:
			(priceList
				cover: (177 to: 185)
				declaredAt: (72 to: 80)) ] valueCoveringAll:
		{96 to: 129. 152 to: 157. 166 to: 175}.! !
!Behavior method!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList
	(clientAuthenticator _ aClientAuthenticator
		cover: (118 to: 137)
		declaredAt: (36 to: 55))
		cover: (95 to: 113)
		declaredAt: (95 to: 113).
	(carts _ [
	(Dictionary
		cover: (150 to: 159)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{161 to: 163})
		cover: (141 to: 145)
		declaredAt: (141 to: 145).
	(clock _ aClock
		cover: (176 to: 181)
		declaredAt: (64 to: 69))
		cover: (167 to: 171)
		declaredAt: (167 to: 171).
	(lastTimeCartUsed _ [
	(Dictionary
		cover: (205 to: 214)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{216 to: 218})
		cover: (185 to: 200)
		declaredAt: (185 to: 200).
	(priceList _ aPriceList
		cover: (235 to: 244)
		declaredAt: (82 to: 91))
		cover: (222 to: 230)
		declaredAt: (222 to: 230).
	(cartOwner _ [
	(Dictionary
		cover: (261 to: 270)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{272 to: 274})
		cover: (248 to: 256)
		declaredAt: (248 to: 256).
	(userPurchases _ [
	(Dictionary
		cover: (296 to: 305)
		declaredAt: (150 to: 159)) new ] valueCoveringAll:
		{307 to: 309})
		cover: (278 to: 290)
		declaredAt: (278 to: 290).
	(currentTransactionID _ 0 coverAll:
		{338 to: 338})
		cover: (313 to: 332)
		declaredAt: (313 to: 332).
	(salesBook _ [
	(OrderedCollection
		cover: (355 to: 371)
		declaredAt: (355 to: 371)) new ] valueCoveringAll:
		{373 to: 375})
		cover: (342 to: 350)
		declaredAt: (342 to: 350).
	(cashier _ [
	(Cashier
		cover: (390 to: 396)
		declaredAt: (390 to: 396))
		with:
			(priceList
				cover: (404 to: 412)
				declaredAt: (222 to: 230))
		registerSalesOn:
			(salesBook
				cover: (431 to: 439)
				declaredAt: (342 to: 350))
		merchantProcessor:
			([
			(MerchantProcessorSimulator
				cover: (460 to: 485)
				declaredAt: (460 to: 485)) new ] valueCoveringAll:
				{487 to: 489}) ] valueCoveringAll:
		{398 to: 402. 414 to: 429. 441 to: 458})
		cover: (379 to: 385)
		declaredAt: (379 to: 385).
	(currentCartID _ 0 coverAll:
		{510 to: 510})
		cover: (493 to: 505)
		declaredAt: (493 to: 505).! !
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWith:
			(aPriceList
				cover: (112 to: 121)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (140 to: 149)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessor
				cover: (170 to: 187)
				declaredAt: (65 to: 82)) ] valueCoveringAll:
		{96 to: 110. 123 to: 138. 151 to: 168}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	(priceList _ aPriceList
		cover: (111 to: 120)
		declaredAt: (17 to: 26))
		cover: (98 to: 106)
		declaredAt: (98 to: 106).
	(salesBook _ aSalesBook
		cover: (137 to: 146)
		declaredAt: (45 to: 54))
		cover: (124 to: 132)
		declaredAt: (124 to: 132).
	(merchantProcessor _ aMerchantProcessor
		cover: (171 to: 188)
		declaredAt: (75 to: 92))
		cover: (150 to: 166)
		declaredAt: (150 to: 166).! !
!Behavior method!
createCartFor: userID authenticatedWith: aPassword
	| cartID |
	[
	(clientAuthenticator
		cover: (63 to: 81)
		declaredAt: (63 to: 81))
		authenticateUser:
			(userID
				cover: (101 to: 106)
				declaredAt: (16 to: 21))
		withPassword:
			(aPassword
				cover: (122 to: 130)
				declaredAt: (42 to: 50)) ] valueCoveringAll:
		{83 to: 99. 108 to: 120}.
	(cartID _ currentCartID
		cover: (147 to: 159)
		declaredAt: (147 to: 159))
		cover: (137 to: 142)
		declaredAt: (54 to: 59).
	(currentCartID _ [
	(currentCartID
		cover: (163 to: 175)
		declaredAt: (147 to: 159)) +
		(1 coverAll:
			{196 to: 196}) ] valueCoveringAll:
		{194 to: 194})
		cover: (180 to: 192)
		declaredAt: (147 to: 159).
	[
	(carts
		cover: (200 to: 204)
		declaredAt: (200 to: 204)) add:
		([
		(cartID
			cover: (211 to: 216)
			declaredAt: (54 to: 59)) ->
			([
			(Cart
				cover: (222 to: 225)
				declaredAt: (222 to: 225)) acceptingItemsOf:
				([
				(priceList
					cover: (245 to: 253)
					declaredAt: (245 to: 253)) keys ] valueCoveringAll:
					{255 to: 258}) ] valueCoveringAll:
				{227 to: 243}) ] valueCoveringAll:
			{218 to: 219}) ] valueCoveringAll:
		{206 to: 209}.
	[
	(cartOwner
		cover: (263 to: 271)
		declaredAt: (263 to: 271)) add:
		([
		(cartID
			cover: (278 to: 283)
			declaredAt: (54 to: 59)) ->
			(userID
				cover: (288 to: 293)
				declaredAt: (16 to: 21)) ] valueCoveringAll:
			{285 to: 286}) ] valueCoveringAll:
		{273 to: 276}.
	[
	(lastTimeCartUsed
		cover: (297 to: 312)
		declaredAt: (297 to: 312)) add:
		([
		(cartID
			cover: (319 to: 324)
			declaredAt: (54 to: 59)) ->
			([
			(clock
				cover: (329 to: 333)
				declaredAt: (329 to: 333)) now ] valueCoveringAll:
				{335 to: 337}) ] valueCoveringAll:
			{326 to: 327}) ] valueCoveringAll:
		{314 to: 317}.
	^ cartID
		cover: (342 to: 347)
		declaredAt: (54 to: 59).! !
!Behavior method!
authenticateUser: aSmallInteger withPassword: aString
	[
	(authenticationErrorMessage
		cover: (57 to: 82)
		declaredAt: (57 to: 82)) ifNotNil: [
		[
		(self coverAll:
			{95 to: 98}) error:
			(authenticationErrorMessage
				cover: (107 to: 132)
				declaredAt: (57 to: 82)) ] valueCoveringAll:
			{100 to: 105} ]] valueCoveringAll:
		{84 to: 92}.! !
!Behavior method!
hasCarts
	^ [
	([
	(carts
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}) not ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:19:25'!
PASSED!
!Behavior method!
with: aDateTime
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) initializeWith:
		(aDateTime
			cover: (45 to: 53)
			declaredAt: (7 to: 15)) ] valueCoveringAll:
		{29 to: 43}.! !
!Behavior method!
initializeWith: aDateTime
	(dateTime _ aDateTime
		cover: (40 to: 48)
		declaredAt: (17 to: 25))
		cover: (28 to: 35)
		declaredAt: (28 to: 35).! !
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
now
	^ dateTime
		cover: (8 to: 15)
		declaredAt: (8 to: 15).! !
!Behavior method!
hasCartIdentified: aCartId
	[
	(carts
		cover: (33 to: 37)
		declaredAt: (33 to: 37))
		at:
			(aCartId
				cover: (43 to: 49)
				declaredAt: (20 to: 26))
		ifAbsent: [ ^ false coverAll:
				{64 to: 68} ]] valueCoveringAll:
		{39 to: 41. 51 to: 59}.
	[
	([
	(self coverAll:
		{74 to: 77}) expiredCart:
		(aCartId
			cover: (92 to: 98)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{79 to: 90}) ifTrue: [
		[
		(self coverAll:
			{113 to: 116}) invalidateCartId:
			(aCartId
				cover: (136 to: 142)
				declaredAt: (20 to: 26)) ] valueCoveringAll:
			{118 to: 134}.
		^ false coverAll:
			{149 to: 153} ]] valueCoveringAll:
		{104 to: 110}.
	^ true coverAll:
		{159 to: 162}.! !
!Behavior method!
expiredCart: aCartId
	^ [
	([
	([
	(lastTimeCartUsed
		cover: (28 to: 43)
		declaredAt: (28 to: 43)) at:
		(aCartId
			cover: (49 to: 55)
			declaredAt: (14 to: 20)) ] valueCoveringAll:
		{45 to: 47}) next:
		([
		([
		(TimeUnits
			cover: (65 to: 73)
			declaredAt: (65 to: 73)) minute ] valueCoveringAll:
			{75 to: 80}) with:
			([
			(self coverAll:
				{88 to: 91}) maxInactiveTimeInMinutes ] valueCoveringAll:
				{93 to: 116}) ] valueCoveringAll:
			{82 to: 86}) ] valueCoveringAll:
		{58 to: 62}) <
		([
		(clock
			cover: (122 to: 126)
			declaredAt: (122 to: 126)) now ] valueCoveringAll:
			{128 to: 130}) ] valueCoveringAll:
		{120 to: 120}.! !
!Behavior method!
maxInactiveTimeInMinutes
	^ 30 coverAll:
		{30 to: 31}.! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 02:19:26'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 02:19:26'!
PASSED!
!Behavior method!
listCart: cartID
	| cartList |
	[
	(self coverAll:
		{35 to: 38}) assertCartIDIsValid:
		(cartID
			cover: (61 to: 66)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{40 to: 59}.
	(cartList _ [
	(OrderedCollection
		cover: (82 to: 98)
		declaredAt: (82 to: 98)) new ] valueCoveringAll:
		{100 to: 102})
		cover: (70 to: 77)
		declaredAt: (23 to: 30).
	[
	([
	(carts
		cover: (107 to: 111)
		declaredAt: (107 to: 111)) at:
		(cartID
			cover: (117 to: 122)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{113 to: 115}) do: [ :anItem |
		[
		(cartList
			cover: (140 to: 147)
			declaredAt: (23 to: 30)) add:
			(anItem
				cover: (154 to: 159)
				declaredAt: (131 to: 136)) ] valueCoveringAll:
			{149 to: 152} ]] valueCoveringAll:
		{125 to: 127}.
	[
	(lastTimeCartUsed
		cover: (166 to: 181)
		declaredAt: (166 to: 181))
		at:
			(cartID
				cover: (187 to: 192)
				declaredAt: (11 to: 16))
		put:
			([
			(clock
				cover: (199 to: 203)
				declaredAt: (199 to: 203)) now ] valueCoveringAll:
				{205 to: 207}) ] valueCoveringAll:
		{183 to: 185. 194 to: 197}.
	^ cartList
		cover: (215 to: 222)
		declaredAt: (23 to: 30).! !
!Behavior method!
assertCartIDIsValid: cartID
	[
	([
	(self coverAll:
		{33 to: 36}) hasCartIdentified:
		(cartID
			cover: (57 to: 62)
			declaredAt: (22 to: 27)) ] valueCoveringAll:
		{38 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) invalidCartIDErrorDescription ] valueCoveringAll:
				{99 to: 127}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 02:19:26'!
PASSED!
!Behavior method!
invalidCartIDErrorDescription
	^ 'Cart ID is not in the system' coverAll:
		{33 to: 62}.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 02:19:26'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 02:19:26'!
PASSED!
!Behavior method!
addMinutes: anAmountOfMinutes
	(dateTime _ [
	(dateTime
		cover: (32 to: 39)
		declaredAt: (32 to: 39)) next:
		([
		([
		(TimeUnits
			cover: (60 to: 68)
			declaredAt: (60 to: 68)) minute ] valueCoveringAll:
			{70 to: 75}) with:
			(anAmountOfMinutes
				cover: (83 to: 99)
				declaredAt: (13 to: 29)) ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{53 to: 57})
		cover: (44 to: 51)
		declaredAt: (32 to: 39).! !
!Behavior method!
invalidateCartId: aCartID
	[
	(carts
		cover: (28 to: 32)
		declaredAt: (28 to: 32)) removeKey:
		(aCartID
			cover: (45 to: 51)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{34 to: 43}.
	[
	(lastTimeCartUsed
		cover: (55 to: 70)
		declaredAt: (55 to: 70)) removeKey:
		(aCartID
			cover: (83 to: 89)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{72 to: 81}.
	[
	(cartOwner
		cover: (93 to: 101)
		declaredAt: (93 to: 101)) removeKey:
		(aCartID
			cover: (114 to: 120)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{103 to: 112}.! !

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:19:26'!
PASSED!
!Behavior method!
addToCart: aCartID item: anItem quantity: aQuantity
	[
	(self coverAll:
		{55 to: 58}) assertCartIDIsValid:
		(aCartID
			cover: (81 to: 87)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{60 to: 79}.
	[
	([
	(carts
		cover: (95 to: 99)
		declaredAt: (95 to: 99)) at:
		(aCartID
			cover: (105 to: 111)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{101 to: 103})
		add:
			(aQuantity
				cover: (119 to: 127)
				declaredAt: (43 to: 51))
		of:
			(anItem
				cover: (133 to: 138)
				declaredAt: (26 to: 31)) ] valueCoveringAll:
		{114 to: 117. 129 to: 131}.
	[
	(lastTimeCartUsed
		cover: (144 to: 159)
		declaredAt: (144 to: 159))
		at:
			(aCartID
				cover: (164 to: 170)
				declaredAt: (12 to: 18))
		put:
			([
			(clock
				cover: (177 to: 181)
				declaredAt: (177 to: 181)) now ] valueCoveringAll:
				{183 to: 185}) ] valueCoveringAll:
		{161 to: 163. 172 to: 175}.! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:19:26'!
PASSED!
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 02:19:26'!
PASSED!
!Behavior method!
listPurchasesOf: aUserId password: aPassword
	| userIDSales items totalAmount |
	[
	(clientAuthenticator
		cover: (80 to: 98)
		declaredAt: (80 to: 98))
		authenticateUser:
			(aUserId
				cover: (118 to: 124)
				declaredAt: (18 to: 24))
		withPassword:
			(aPassword
				cover: (140 to: 148)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{100 to: 116. 126 to: 138}.
	[
	([
	(userPurchases
		cover: (154 to: 166)
		declaredAt: (154 to: 166)) includesKey:
		(aUserId
			cover: (181 to: 187)
			declaredAt: (18 to: 24)) ] valueCoveringAll:
		{168 to: 179}) ifFalse: [
		[
		(userPurchases
			cover: (201 to: 213)
			declaredAt: (154 to: 166)) add:
			([
			(aUserId
				cover: (220 to: 226)
				declaredAt: (18 to: 24)) ->
				([
				(OrderedCollection
					cover: (231 to: 247)
					declaredAt: (231 to: 247)) new ] valueCoveringAll:
					{249 to: 251}) ] valueCoveringAll:
				{228 to: 229}) ] valueCoveringAll:
			{215 to: 218} ]] valueCoveringAll:
		{191 to: 198}.
	(userIDSales _ [
	(salesBook
		cover: (276 to: 284)
		declaredAt: (276 to: 284)) select: [ :aSales |
		[
		([
		(aSales
			cover: (305 to: 310)
			declaredAt: (296 to: 301)) userID ] valueCoveringAll:
			{312 to: 317}) =
			(aUserId
				cover: (321 to: 327)
				declaredAt: (18 to: 24)) ] valueCoveringAll:
			{319 to: 319} ]] valueCoveringAll:
		{286 to: 292})
		cover: (261 to: 271)
		declaredAt: (48 to: 58).
	(items _ [
	(OrderedCollection
		cover: (341 to: 357)
		declaredAt: (231 to: 247)) new ] valueCoveringAll:
		{359 to: 361})
		cover: (332 to: 336)
		declaredAt: (60 to: 64).
	[
	(userIDSales
		cover: (365 to: 375)
		declaredAt: (48 to: 58)) do: [ :aSales |
		[
		(items
			cover: (392 to: 396)
			declaredAt: (60 to: 64)) addAll:
			([
			(aSales
				cover: (406 to: 411)
				declaredAt: (383 to: 388)) items ] valueCoveringAll:
				{413 to: 417}) ] valueCoveringAll:
			{398 to: 404} ]] valueCoveringAll:
		{377 to: 379}.
	(totalAmount _ [
	(userIDSales
		cover: (437 to: 447)
		declaredAt: (48 to: 58))
		sum: [ :aSales |
			[
			(aSales
				cover: (465 to: 470)
				declaredAt: (456 to: 461)) totalAmount ] valueCoveringAll:
				{472 to: 482} ]
		ifEmpty:
			(0 coverAll:
				{494 to: 494}) ] valueCoveringAll:
		{449 to: 452. 485 to: 492})
		cover: (422 to: 432)
		declaredAt: (66 to: 76).
	^ [
	(PurchaseList
		cover: (500 to: 511)
		declaredAt: (500 to: 511))
		withItems:
			(items
				cover: (524 to: 528)
				declaredAt: (60 to: 64))
		totalAmount:
			(totalAmount
				cover: (543 to: 553)
				declaredAt: (66 to: 76)) ] valueCoveringAll:
		{513 to: 522. 530 to: 541}.! !
!Behavior method!
withItems: anItemList totalAmount: anAmount
	self coverAll:
		{49 to: 52}.
	^ [
	([ self new ] valueCoveringAll:
		{54 to: 56})
		initializeWithItems:
			(anItemList
				cover: (79 to: 88)
				declaredAt: (12 to: 21))
		totalAmount:
			(anAmount
				cover: (103 to: 110)
				declaredAt: (36 to: 43)) ] valueCoveringAll:
		{58 to: 77. 90 to: 101}.! !
!Behavior method!
initializeWithItems: anItemList totalAmount: anAmount
	(itemList _ anItemList
		cover: (69 to: 78)
		declaredAt: (22 to: 31))
		cover: (57 to: 64)
		declaredAt: (57 to: 64).
	(amount _ anAmount
		cover: (92 to: 99)
		declaredAt: (46 to: 53))
		cover: (82 to: 87)
		declaredAt: (82 to: 87).! !
!Behavior method!
isEmpty
	^ [
	(itemList
		cover: (12 to: 19)
		declaredAt: (12 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 02:19:26'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:19:26'!
PASSED!
!Behavior method!
validCreditCard
	^ [
	(CreditCard
		cover: (21 to: 30)
		declaredAt: (21 to: 30))
		owner:
			('owner' coverAll:
				{39 to: 45})
		number:
			('1234567891011121' coverAll:
				{55 to: 72})
		expiration:
			([
			([
			(GregorianMonthOfYear
				cover: (86 to: 105)
				declaredAt: (86 to: 105)) current ] valueCoveringAll:
				{107 to: 113}) next ] valueCoveringAll:
				{115 to: 118}) ] valueCoveringAll:
		{32 to: 37. 47 to: 53. 74 to: 84}.! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{89 to: 121}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (128 to: 134)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (159 to: 164)
			declaredAt: (150 to: 155)) isDigit ] valueCoveringAll:
			{166 to: 172} ]] valueCoveringAll:
		{136 to: 146}) ifFalse: [
		[
		(self coverAll:
			{187 to: 190}) error:
			([
			(self coverAll:
				{199 to: 202}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{204 to: 236}) ] valueCoveringAll:
			{192 to: 197} ]] valueCoveringAll:
		{177 to: 184}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{103 to: 135}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(expirationMonthOfYear _ aGregorianMonthOfYear
		cover: (209 to: 229)
		declaredAt: (76 to: 96))
		cover: (184 to: 204)
		declaredAt: (184 to: 204).! !
!Behavior method!
checkoutCart: aCartId creditCard: aCreditCard
	| userID |
	[
	(self coverAll:
		{61 to: 64}) assertCartIDIsValid:
		(aCartId
			cover: (87 to: 93)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{66 to: 85}.
	[
	(cashier
		cover: (99 to: 105)
		declaredAt: (99 to: 105))
		checkout:
			([
			(carts
				cover: (118 to: 122)
				declaredAt: (118 to: 122)) at:
				(aCartId
					cover: (128 to: 134)
					declaredAt: (15 to: 21)) ] valueCoveringAll:
				{124 to: 126})
		withCreditCard:
			(aCreditCard
				cover: (153 to: 163)
				declaredAt: (35 to: 45)) ] valueCoveringAll:
		{107 to: 115. 137 to: 151}.
	(userID _ [
	(cartOwner
		cover: (177 to: 185)
		declaredAt: (177 to: 185)) at:
		(aCartId
			cover: (191 to: 197)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{187 to: 189})
		cover: (167 to: 172)
		declaredAt: (51 to: 56).
	[
	([
	(salesBook
		cover: (202 to: 210)
		declaredAt: (202 to: 210)) last ] valueCoveringAll:
		{212 to: 215}) userID:
		(userID
			cover: (225 to: 230)
			declaredAt: (51 to: 56)) ] valueCoveringAll:
		{217 to: 223}.
	[
	([
	(userPurchases
		cover: (239 to: 251)
		declaredAt: (239 to: 251)) includesKey:
		(userID
			cover: (266 to: 271)
			declaredAt: (51 to: 56)) ] valueCoveringAll:
		{253 to: 264}) ifFalse: [
		[
		(userPurchases
			cover: (284 to: 296)
			declaredAt: (239 to: 251)) add:
			([
			(userID
				cover: (303 to: 308)
				declaredAt: (51 to: 56)) ->
				([
				(OrderedCollection
					cover: (312 to: 328)
					declaredAt: (312 to: 328)) new ] valueCoveringAll:
					{330 to: 332}) ] valueCoveringAll:
				{309 to: 310}) ] valueCoveringAll:
			{298 to: 301} ]] valueCoveringAll:
		{274 to: 281}.
	[
	([
	(userPurchases
		cover: (339 to: 351)
		declaredAt: (239 to: 251)) at:
		(userID
			cover: (357 to: 362)
			declaredAt: (51 to: 56)) ] valueCoveringAll:
		{353 to: 355}) addAll:
		([
		(self coverAll:
			{374 to: 377}) listCart:
			(aCartId
				cover: (389 to: 395)
				declaredAt: (15 to: 21)) ] valueCoveringAll:
			{379 to: 387}) ] valueCoveringAll:
		{365 to: 371}.
	[
	(self coverAll:
		{402 to: 405}) invalidateCartId:
		(aCartId
			cover: (425 to: 431)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{407 to: 423}.
	(currentTransactionID _ [
	(currentTransactionID
		cover: (437 to: 456)
		declaredAt: (437 to: 456)) +
		(1 coverAll:
			{484 to: 484}) ] valueCoveringAll:
		{482 to: 482})
		cover: (461 to: 480)
		declaredAt: (437 to: 456).
	^ currentTransactionID
		cover: (490 to: 509)
		declaredAt: (437 to: 456).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice items sales |
	[
	(self coverAll:
		{73 to: 76}) assertCartIsNotEmpty:
		(aCart
			cover: (100 to: 104)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{78 to: 98}.
	[
	(self coverAll:
		{108 to: 111}) assertCreditCardIsNotExpired:
		(aCreditCard
			cover: (143 to: 153)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{113 to: 141}.
	(totalPrice _ 0 coverAll:
		{171 to: 171})
		cover: (157 to: 166)
		declaredAt: (48 to: 57).
	(items _ [
	(OrderedCollection
		cover: (184 to: 200)
		declaredAt: (184 to: 200)) new ] valueCoveringAll:
		{202 to: 204})
		cover: (175 to: 179)
		declaredAt: (59 to: 63).
	[
	(aCart
		cover: (208 to: 212)
		declaredAt: (11 to: 15)) do: [ :anItem |
		(totalPrice _ [
		([
		(totalPrice
			cover: (229 to: 238)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (256 to: 264)
				declaredAt: (256 to: 264)) ] valueCoveringAll:
			{254 to: 254})
			at:
				(anItem
					cover: (270 to: 275)
					declaredAt: (220 to: 225))
			ifAbsent: [
				[
				(self coverAll:
					{288 to: 291}) raiseItemNotInPriceListError ] valueCoveringAll:
					{293 to: 320} ]] valueCoveringAll:
			{266 to: 268. 277 to: 285})
			cover: (243 to: 252)
			declaredAt: (48 to: 57).
		[
		(items
			cover: (326 to: 330)
			declaredAt: (59 to: 63)) add:
			(anItem
				cover: (337 to: 342)
				declaredAt: (220 to: 225)) ] valueCoveringAll:
			{332 to: 335} ]] valueCoveringAll:
		{214 to: 216}.
	[
	(merchantProcessor
		cover: (347 to: 363)
		declaredAt: (347 to: 363))
		charge:
			(totalPrice
				cover: (373 to: 382)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (389 to: 399)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{365 to: 371. 385 to: 387}.
	(sales _ [
	(Sales
		cover: (413 to: 417)
		declaredAt: (413 to: 417))
		withItems:
			(items
				cover: (430 to: 434)
				declaredAt: (59 to: 63))
		totalAmount:
			(totalPrice
				cover: (449 to: 458)
				declaredAt: (48 to: 57)) ] valueCoveringAll:
		{419 to: 428. 436 to: 447})
		cover: (404 to: 408)
		declaredAt: (65 to: 69).
	[
	(salesBook
		cover: (462 to: 470)
		declaredAt: (462 to: 470)) add:
		(sales
			cover: (477 to: 481)
			declaredAt: (65 to: 69)) ] valueCoveringAll:
		{472 to: 475}.
	^ sales
		cover: (486 to: 490)
		declaredAt: (65 to: 69).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) emptyCartErrorDescription ] valueCoveringAll:
				{80 to: 104}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !
!Behavior method!
assertCreditCardIsNotExpired: aCreditCard
	[
	([
	(aCreditCard
		cover: (47 to: 57)
		declaredAt: (31 to: 41)) isExpiredOn:
		([
		(Date
			cover: (72 to: 75)
			declaredAt: (72 to: 75)) today ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{59 to: 70}) ifTrue: [
		[
		(self coverAll:
			{93 to: 96}) error:
			([
			([
			(self coverAll:
				{105 to: 108}) class ] valueCoveringAll:
				{110 to: 114}) expiredCreditCardErrorDescription ] valueCoveringAll:
				{116 to: 148}) ] valueCoveringAll:
			{98 to: 103} ]] valueCoveringAll:
		{84 to: 90}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	([
	(GregorianMonthOfYear
		cover: (26 to: 45)
		declaredAt: (26 to: 45))
		yearNumber:
			([
			(aDate
				cover: (59 to: 63)
				declaredAt: (14 to: 18)) yearNumber ] valueCoveringAll:
				{65 to: 74})
		monthNumber:
			([
			(aDate
				cover: (89 to: 93)
				declaredAt: (14 to: 18)) monthIndex ] valueCoveringAll:
				{95 to: 104}) ] valueCoveringAll:
		{47 to: 57. 76 to: 87}) >
		(expirationMonthOfYear
			cover: (109 to: 129)
			declaredAt: (109 to: 129)) ] valueCoveringAll:
		{107 to: 107}.! !
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !
!Behavior method!
withItems: items totalAmount: anAmount
	^ [
	([
	(self coverAll:
		{43 to: 46}) new ] valueCoveringAll:
		{48 to: 50})
		initializeWithItems:
			(items
				cover: (73 to: 77)
				declaredAt: (12 to: 16))
		totalAmount:
			(anAmount
				cover: (92 to: 99)
				declaredAt: (31 to: 38)) ] valueCoveringAll:
		{52 to: 71. 79 to: 90}.! !
!Behavior method!
initializeWithItems: aCollectionOfItems totalAmount: anAmount
	(items _ aCollectionOfItems
		cover: (75 to: 92)
		declaredAt: (22 to: 39))
		cover: (66 to: 70)
		declaredAt: (66 to: 70).
	(amount _ anAmount
		cover: (106 to: 113)
		declaredAt: (54 to: 61))
		cover: (96 to: 101)
		declaredAt: (96 to: 101).! !
!Behavior method!
userID: aUserID
	(userID _ aUserID
		cover: (28 to: 34)
		declaredAt: (9 to: 15))
		cover: (18 to: 23)
		declaredAt: (18 to: 23).! !
!Behavior method!
userID
	^ userID
		cover: (10 to: 15)
		declaredAt: (10 to: 15).! !
!Behavior method!
items
	^ items
		cover: (9 to: 13)
		declaredAt: (9 to: 13).! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !
!Behavior method!
list
	^ [
	(itemList
		cover: (9 to: 16)
		declaredAt: (9 to: 16)) copy ] valueCoveringAll:
		{18 to: 21}.! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 02:19:27'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 02:19:27'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 02:19:27'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 02:19:27'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 02:19:27'!
PASSED!
!Store methodsFor: 'lists' stamp: 'ET 6/24/2021 02:19:57' prior: 51067450!
listPurchasesOf: aUserId password: aPassword
	|userIDSales items totalAmount|
	clientAuthenticator authenticateUser: aUserId withPassword: aPassword. 
	userIDSales := salesBook select: [:aSales | aSales userID = aUserId].
	items := OrderedCollection new.
	userIDSales do: [:aSales | items addAll: aSales items].
	totalAmount := userIDSales sum: [:aSales | aSales totalAmount] ifEmpty: 0.
	^ PurchaseList withItems: items totalAmount: totalAmount.
	! !
!Store methodsFor: 'checkout' stamp: 'ET 6/24/2021 02:20:15' prior: 51067379!
checkoutCart: aCartId creditCard: aCreditCard 
	| userID |
	self assertCartIDIsValid: aCartId.
	
	cashier checkout: (carts at: aCartId) withCreditCard: aCreditCard.
	userID := cartOwner at: aCartId. 
	salesBook last userID: userID.
	
	self invalidateCartId: aCartId.
	
	currentTransactionID := currentTransactionID + 1.
	^ currentTransactionID.! !
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 02:20:27' prior: 51065484!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := Dictionary new.
	clock := aClock.
	lastTimeCartUsed := Dictionary new.
	priceList := aPriceList.
	cartOwner := Dictionary new.
	currentTransactionID  := 0.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	currentCartID := 0.
	
! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 02:20:29'!
PASSED!

Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts lastTimeCartUsed clock priceList cartOwner currentTransactionID salesBook cashier currentCartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'ET 6/24/2021 02:20:35'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts lastTimeCartUsed clock priceList cartOwner currentTransactionID salesBook cashier currentCartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!Store methodsFor: 'checkout' stamp: 'ET 6/24/2021 02:21:10' prior: 51068698!
checkoutCart: aCartId creditCard: aCreditCard 
	| userID |
	self assertCartIDIsValid: aCartId.
	
	cashier checkout: (carts at: aCartId) withCreditCard: aCreditCard.
	userID := cartOwner at: aCartId. 
	salesBook last userID: userID.
	
	self invalidateCartId: aCartId.

	^salesBook size.! !

Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts lastTimeCartUsed clock priceList cartOwner salesBook cashier currentCartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #Store category: 'TusLibros' stamp: 'ET 6/24/2021 02:21:25'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts lastTimeCartUsed clock priceList cartOwner salesBook cashier currentCartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 02:21:37'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 02:21:37'!
PASSED!
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 02:22:03' prior: 51068712!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	carts := Dictionary new.
	clock := aClock.
	lastTimeCartUsed := Dictionary new.
	priceList := aPriceList.
	cartOwner := Dictionary new.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	currentCartID := 0.
	
! !
!Store methodsFor: 'initialization' stamp: 'ET 6/24/2021 02:22:30' prior: 51068881!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	clock := aClock.
	priceList := aPriceList.
	carts := Dictionary new.
	lastTimeCartUsed := Dictionary new.
	cartOwner := Dictionary new.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	currentCartID := 0.
	
! !

----SNAPSHOT----(24 June 2021 02:23:30) CuisUniversity-4532.image priorSource: 23531505!

----STARTUP---- (24 June 2021 08:08:10) as /home/jaicardo/Descargas/Cuis/CuisUniversity-4532.image!


!classRemoval: #TestObjects stamp: 'JA 6/24/2021 08:16:07'!
Object subclass: #TestObjects
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Store stamp: 'JA 6/24/2021 08:16:07'!
Object subclass: #Store
	instanceVariableNames: 'clientAuthenticator carts itemCatalog lastTimeCartUsed clock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #MerchantProcessorSimulator stamp: 'JA 6/24/2021 08:16:07'!
Object subclass: #MerchantProcessorSimulator
	instanceVariableNames: 'messageError'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCard stamp: 'JA 6/24/2021 08:16:08'!
Object subclass: #CreditCard
	instanceVariableNames: 'ownerString creditCardNumberString expirationMonthOfYear'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #ClockSimulator stamp: 'JA 6/24/2021 08:16:08'!
Object subclass: #ClockSimulator
	instanceVariableNames: 'dateTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #ClientAuthenticatorSimulator stamp: 'JA 6/24/2021 08:16:08'!
Object subclass: #ClientAuthenticatorSimulator
	instanceVariableNames: 'raiseAuthenticationError authenticationErrorMessage'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cashier stamp: 'JA 6/24/2021 08:16:09'!
Object subclass: #Cashier
	instanceVariableNames: 'priceList salesBook merchantProcessor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #Cart stamp: 'JA 6/24/2021 08:16:09'!
Object subclass: #Cart
	instanceVariableNames: 'catalog items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #StoreTest stamp: 'JA 6/24/2021 08:16:09'!
TestCase subclass: #StoreTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CreditCardTest stamp: 'JA 6/24/2021 08:16:10'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CashierTest stamp: 'JA 6/24/2021 08:16:10'!
TestCase subclass: #CashierTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classRemoval: #CartTest stamp: 'JA 6/24/2021 08:16:10'!
TestCase subclass: #CartTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

----End fileIn of /home/jaicardo/Descargas/Cuis/ejsIS1/20-TusLibros-iteracion-3/TusLibros.st----!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 08:16:43'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 08:16:43'!
PASSED!
!Behavior method!
defaultCatalog
	^ [
	(Array
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) with:
		([
		(self coverAll:
			{33 to: 36}) itemSellByTheStore ] valueCoveringAll:
			{38 to: 55}) ] valueCoveringAll:
		{27 to: 31}.! !
!Behavior method!
itemSellByTheStore
	^ 'validBook' coverAll:
		{25 to: 35}.! !
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWith:
			(aPriceList
				cover: (112 to: 121)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (140 to: 149)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessor
				cover: (170 to: 187)
				declaredAt: (65 to: 82)) ] valueCoveringAll:
		{96 to: 110. 123 to: 138. 151 to: 168}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	(priceList _ aPriceList
		cover: (111 to: 120)
		declaredAt: (17 to: 26))
		cover: (98 to: 106)
		declaredAt: (98 to: 106).
	(salesBook _ aSalesBook
		cover: (137 to: 146)
		declaredAt: (45 to: 54))
		cover: (124 to: 132)
		declaredAt: (124 to: 132).
	(merchantProcessor _ aMerchantProcessor
		cover: (171 to: 188)
		declaredAt: (75 to: 92))
		cover: (150 to: 166)
		declaredAt: (150 to: 166).! !
!Behavior method!
validCreditCard
	^ [
	(CreditCard
		cover: (21 to: 30)
		declaredAt: (21 to: 30))
		owner:
			('owner' coverAll:
				{39 to: 45})
		number:
			('1234567891011121' coverAll:
				{55 to: 72})
		expiration:
			([
			([
			(GregorianMonthOfYear
				cover: (86 to: 105)
				declaredAt: (86 to: 105)) current ] valueCoveringAll:
				{107 to: 113}) next ] valueCoveringAll:
				{115 to: 118}) ] valueCoveringAll:
		{32 to: 37. 47 to: 53. 74 to: 84}.! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{89 to: 121}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (128 to: 134)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (159 to: 164)
			declaredAt: (150 to: 155)) isDigit ] valueCoveringAll:
			{166 to: 172} ]] valueCoveringAll:
		{136 to: 146}) ifFalse: [
		[
		(self coverAll:
			{187 to: 190}) error:
			([
			(self coverAll:
				{199 to: 202}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{204 to: 236}) ] valueCoveringAll:
			{192 to: 197} ]] valueCoveringAll:
		{177 to: 184}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{103 to: 135}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(expirationMonthOfYear _ aGregorianMonthOfYear
		cover: (209 to: 229)
		declaredAt: (76 to: 96))
		cover: (184 to: 204)
		declaredAt: (184 to: 204).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice items sales |
	[
	(self coverAll:
		{73 to: 76}) assertCartIsNotEmpty:
		(aCart
			cover: (100 to: 104)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{78 to: 98}.
	[
	(self coverAll:
		{108 to: 111}) assertCreditCardIsNotExpired:
		(aCreditCard
			cover: (143 to: 153)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{113 to: 141}.
	(totalPrice _ 0 coverAll:
		{171 to: 171})
		cover: (157 to: 166)
		declaredAt: (48 to: 57).
	(items _ [
	(OrderedCollection
		cover: (184 to: 200)
		declaredAt: (184 to: 200)) new ] valueCoveringAll:
		{202 to: 204})
		cover: (175 to: 179)
		declaredAt: (59 to: 63).
	[
	(aCart
		cover: (208 to: 212)
		declaredAt: (11 to: 15)) do: [ :anItem |
		(totalPrice _ [
		([
		(totalPrice
			cover: (229 to: 238)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (256 to: 264)
				declaredAt: (256 to: 264)) ] valueCoveringAll:
			{254 to: 254})
			at:
				(anItem
					cover: (270 to: 275)
					declaredAt: (220 to: 225))
			ifAbsent: [
				[
				(self coverAll:
					{288 to: 291}) raiseItemNotInPriceListError ] valueCoveringAll:
					{293 to: 320} ]] valueCoveringAll:
			{266 to: 268. 277 to: 285})
			cover: (243 to: 252)
			declaredAt: (48 to: 57).
		[
		(items
			cover: (326 to: 330)
			declaredAt: (59 to: 63)) add:
			(anItem
				cover: (337 to: 342)
				declaredAt: (220 to: 225)) ] valueCoveringAll:
			{332 to: 335} ]] valueCoveringAll:
		{214 to: 216}.
	[
	(merchantProcessor
		cover: (347 to: 363)
		declaredAt: (347 to: 363))
		charge:
			(totalPrice
				cover: (373 to: 382)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (389 to: 399)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{365 to: 371. 385 to: 387}.
	(sales _ [
	(Sales
		cover: (413 to: 417)
		declaredAt: (413 to: 417))
		withItems:
			(items
				cover: (430 to: 434)
				declaredAt: (59 to: 63))
		totalAmount:
			(totalPrice
				cover: (449 to: 458)
				declaredAt: (48 to: 57)) ] valueCoveringAll:
		{419 to: 428. 436 to: 447})
		cover: (404 to: 408)
		declaredAt: (65 to: 69).
	[
	(salesBook
		cover: (462 to: 470)
		declaredAt: (462 to: 470)) add:
		(sales
			cover: (477 to: 481)
			declaredAt: (65 to: 69)) ] valueCoveringAll:
		{472 to: 475}.
	^ sales
		cover: (486 to: 490)
		declaredAt: (65 to: 69).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) emptyCartErrorDescription ] valueCoveringAll:
				{80 to: 104}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
emptyCartErrorDescription
	^ 'The cart is empty' coverAll:
		{29 to: 47}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
assertCreditCardIsNotExpired: aCreditCard
	[
	([
	(aCreditCard
		cover: (47 to: 57)
		declaredAt: (31 to: 41)) isExpiredOn:
		([
		(Date
			cover: (72 to: 75)
			declaredAt: (72 to: 75)) today ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{59 to: 70}) ifTrue: [
		[
		(self coverAll:
			{93 to: 96}) error:
			([
			([
			(self coverAll:
				{105 to: 108}) class ] valueCoveringAll:
				{110 to: 114}) expiredCreditCardErrorDescription ] valueCoveringAll:
				{116 to: 148}) ] valueCoveringAll:
			{98 to: 103} ]] valueCoveringAll:
		{84 to: 90}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	([
	(GregorianMonthOfYear
		cover: (26 to: 45)
		declaredAt: (26 to: 45))
		yearNumber:
			([
			(aDate
				cover: (59 to: 63)
				declaredAt: (14 to: 18)) yearNumber ] valueCoveringAll:
				{65 to: 74})
		monthNumber:
			([
			(aDate
				cover: (89 to: 93)
				declaredAt: (14 to: 18)) monthIndex ] valueCoveringAll:
				{95 to: 104}) ] valueCoveringAll:
		{47 to: 57. 76 to: 87}) >
		(expirationMonthOfYear
			cover: (109 to: 129)
			declaredAt: (109 to: 129)) ] valueCoveringAll:
		{107 to: 107}.! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
raiseItemNotInPriceListError
	^ [
	(self coverAll:
		{34 to: 37}) error:
		([
		([
		(self coverAll:
			{46 to: 49}) class ] valueCoveringAll:
			{51 to: 55}) itemNotInPriceListErrorDescription ] valueCoveringAll:
			{57 to: 90}) ] valueCoveringAll:
		{39 to: 44}.! !
!Behavior method!
itemNotInPriceListErrorDescription
	^ 'An item in the cart is not in the price list' coverAll:
		{38 to: 83}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !
!Behavior method!
withItems: items totalAmount: anAmount
	^ [
	([
	(self coverAll:
		{43 to: 46}) new ] valueCoveringAll:
		{48 to: 50})
		initializeWithItems:
			(items
				cover: (73 to: 77)
				declaredAt: (12 to: 16))
		totalAmount:
			(anAmount
				cover: (92 to: 99)
				declaredAt: (31 to: 38)) ] valueCoveringAll:
		{52 to: 71. 79 to: 90}.! !
!Behavior method!
initializeWithItems: aCollectionOfItems totalAmount: anAmount
	(items _ aCollectionOfItems
		cover: (75 to: 92)
		declaredAt: (22 to: 39))
		cover: (66 to: 70)
		declaredAt: (66 to: 70).
	(amount _ anAmount
		cover: (106 to: 113)
		declaredAt: (54 to: 61))
		cover: (96 to: 101)
		declaredAt: (96 to: 101).! !
!Behavior method!
items
	^ items
		cover: (9 to: 13)
		declaredAt: (9 to: 13).! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
expiredCreditCardErrorDescription
	^ 'The credit card is expired' coverAll:
		{37 to: 64}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
invalidCreditCardErrorDescription
	^ 'Los datos de la tarjeta de crdito son invlidos' coverAll:
		{37 to: 86}.! !

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
raiseAuthenticationErrorWithMessage: anErrorMessage
	(authenticationErrorMessage _ anErrorMessage
		cover: (84 to: 97)
		declaredAt: (38 to: 51))
		cover: (54 to: 79)
		declaredAt: (54 to: 79).! !
!Behavior method!
defaultPriceList
	^ [
	(Dictionary
		cover: (21 to: 30)
		declaredAt: (21 to: 30)) with:
		([
		([
		(self coverAll:
			{38 to: 41}) itemSellByTheStore ] valueCoveringAll:
			{43 to: 60}) ->
			([
			(self coverAll:
				{65 to: 68}) itemInStorePrice ] valueCoveringAll:
				{70 to: 85}) ] valueCoveringAll:
			{62 to: 63}) ] valueCoveringAll:
		{32 to: 36}.! !
!Behavior method!
itemInStorePrice
	^ 10 coverAll:
		{21 to: 22}.! !
!Behavior method!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWithClientAuthenticator:
			(aClientAuthenticator
				cover: (131 to: 150)
				declaredAt: (26 to: 45))
		clock:
			(aClock
				cover: (159 to: 164)
				declaredAt: (54 to: 59))
		priceList:
			(priceList
				cover: (177 to: 185)
				declaredAt: (72 to: 80)) ] valueCoveringAll:
		{96 to: 129. 152 to: 157. 166 to: 175}.! !
!Behavior method!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList
	(clientAuthenticator _ aClientAuthenticator
		cover: (118 to: 137)
		declaredAt: (36 to: 55))
		cover: (95 to: 113)
		declaredAt: (95 to: 113).
	(clock _ aClock
		cover: (150 to: 155)
		declaredAt: (64 to: 69))
		cover: (141 to: 145)
		declaredAt: (141 to: 145).
	(priceList _ aPriceList
		cover: (172 to: 181)
		declaredAt: (82 to: 91))
		cover: (159 to: 167)
		declaredAt: (159 to: 167).
	(carts _ [
	(Dictionary
		cover: (194 to: 203)
		declaredAt: (194 to: 203)) new ] valueCoveringAll:
		{205 to: 207})
		cover: (185 to: 189)
		declaredAt: (185 to: 189).
	(lastTimeCartUsed _ [
	(Dictionary
		cover: (231 to: 240)
		declaredAt: (194 to: 203)) new ] valueCoveringAll:
		{242 to: 244})
		cover: (211 to: 226)
		declaredAt: (211 to: 226).
	(cartOwner _ [
	(Dictionary
		cover: (261 to: 270)
		declaredAt: (194 to: 203)) new ] valueCoveringAll:
		{272 to: 274})
		cover: (248 to: 256)
		declaredAt: (248 to: 256).
	(salesBook _ [
	(OrderedCollection
		cover: (291 to: 307)
		declaredAt: (291 to: 307)) new ] valueCoveringAll:
		{309 to: 311})
		cover: (278 to: 286)
		declaredAt: (278 to: 286).
	(cashier _ [
	(Cashier
		cover: (326 to: 332)
		declaredAt: (326 to: 332))
		with:
			(priceList
				cover: (340 to: 348)
				declaredAt: (159 to: 167))
		registerSalesOn:
			(salesBook
				cover: (367 to: 375)
				declaredAt: (278 to: 286))
		merchantProcessor:
			([
			(MerchantProcessorSimulator
				cover: (396 to: 421)
				declaredAt: (396 to: 421)) new ] valueCoveringAll:
				{423 to: 425}) ] valueCoveringAll:
		{334 to: 338. 350 to: 365. 377 to: 394})
		cover: (315 to: 321)
		declaredAt: (315 to: 321).
	(currentCartID _ 0 coverAll:
		{446 to: 446})
		cover: (429 to: 441)
		declaredAt: (429 to: 441).! !
!Behavior method!
createCartFor: userID authenticatedWith: aPassword
	| cartID |
	[
	(clientAuthenticator
		cover: (63 to: 81)
		declaredAt: (63 to: 81))
		authenticateUser:
			(userID
				cover: (101 to: 106)
				declaredAt: (16 to: 21))
		withPassword:
			(aPassword
				cover: (122 to: 130)
				declaredAt: (42 to: 50)) ] valueCoveringAll:
		{83 to: 99. 108 to: 120}.
	(cartID _ currentCartID
		cover: (147 to: 159)
		declaredAt: (147 to: 159))
		cover: (137 to: 142)
		declaredAt: (54 to: 59).
	(currentCartID _ [
	(currentCartID
		cover: (163 to: 175)
		declaredAt: (147 to: 159)) +
		(1 coverAll:
			{196 to: 196}) ] valueCoveringAll:
		{194 to: 194})
		cover: (180 to: 192)
		declaredAt: (147 to: 159).
	[
	(carts
		cover: (200 to: 204)
		declaredAt: (200 to: 204)) add:
		([
		(cartID
			cover: (211 to: 216)
			declaredAt: (54 to: 59)) ->
			([
			(Cart
				cover: (222 to: 225)
				declaredAt: (222 to: 225)) acceptingItemsOf:
				([
				(priceList
					cover: (245 to: 253)
					declaredAt: (245 to: 253)) keys ] valueCoveringAll:
					{255 to: 258}) ] valueCoveringAll:
				{227 to: 243}) ] valueCoveringAll:
			{218 to: 219}) ] valueCoveringAll:
		{206 to: 209}.
	[
	(cartOwner
		cover: (263 to: 271)
		declaredAt: (263 to: 271)) add:
		([
		(cartID
			cover: (278 to: 283)
			declaredAt: (54 to: 59)) ->
			(userID
				cover: (288 to: 293)
				declaredAt: (16 to: 21)) ] valueCoveringAll:
			{285 to: 286}) ] valueCoveringAll:
		{273 to: 276}.
	[
	(lastTimeCartUsed
		cover: (297 to: 312)
		declaredAt: (297 to: 312)) add:
		([
		(cartID
			cover: (319 to: 324)
			declaredAt: (54 to: 59)) ->
			([
			(clock
				cover: (329 to: 333)
				declaredAt: (329 to: 333)) now ] valueCoveringAll:
				{335 to: 337}) ] valueCoveringAll:
			{326 to: 327}) ] valueCoveringAll:
		{314 to: 317}.
	^ cartID
		cover: (342 to: 347)
		declaredAt: (54 to: 59).! !
!Behavior method!
authenticateUser: aSmallInteger withPassword: aString
	[
	(authenticationErrorMessage
		cover: (57 to: 82)
		declaredAt: (57 to: 82)) ifNotNil: [
		[
		(self coverAll:
			{95 to: 98}) error:
			(authenticationErrorMessage
				cover: (107 to: 132)
				declaredAt: (57 to: 82)) ] valueCoveringAll:
			{100 to: 105} ]] valueCoveringAll:
		{84 to: 92}.! !
!Behavior method!
hasCarts
	^ [
	([
	(carts
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}) not ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
with: aDateTime
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) initializeWith:
		(aDateTime
			cover: (45 to: 53)
			declaredAt: (7 to: 15)) ] valueCoveringAll:
		{29 to: 43}.! !
!Behavior method!
initializeWith: aDateTime
	(dateTime _ aDateTime
		cover: (40 to: 48)
		declaredAt: (17 to: 25))
		cover: (28 to: 35)
		declaredAt: (28 to: 35).! !
!Behavior method!
now
	^ dateTime
		cover: (8 to: 15)
		declaredAt: (8 to: 15).! !
!Behavior method!
hasCartIdentified: aCartId
	[
	(carts
		cover: (33 to: 37)
		declaredAt: (33 to: 37))
		at:
			(aCartId
				cover: (43 to: 49)
				declaredAt: (20 to: 26))
		ifAbsent: [ ^ false coverAll:
				{64 to: 68} ]] valueCoveringAll:
		{39 to: 41. 51 to: 59}.
	[
	([
	(self coverAll:
		{74 to: 77}) expiredCart:
		(aCartId
			cover: (92 to: 98)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{79 to: 90}) ifTrue: [
		[
		(self coverAll:
			{113 to: 116}) invalidateCartId:
			(aCartId
				cover: (136 to: 142)
				declaredAt: (20 to: 26)) ] valueCoveringAll:
			{118 to: 134}.
		^ false coverAll:
			{149 to: 153} ]] valueCoveringAll:
		{104 to: 110}.
	^ true coverAll:
		{159 to: 162}.! !
!Behavior method!
expiredCart: aCartId
	^ [
	([
	([
	(lastTimeCartUsed
		cover: (28 to: 43)
		declaredAt: (28 to: 43)) at:
		(aCartId
			cover: (49 to: 55)
			declaredAt: (14 to: 20)) ] valueCoveringAll:
		{45 to: 47}) next:
		([
		([
		(TimeUnits
			cover: (65 to: 73)
			declaredAt: (65 to: 73)) minute ] valueCoveringAll:
			{75 to: 80}) with:
			([
			(self coverAll:
				{88 to: 91}) maxInactiveTimeInMinutes ] valueCoveringAll:
				{93 to: 116}) ] valueCoveringAll:
			{82 to: 86}) ] valueCoveringAll:
		{58 to: 62}) <
		([
		(clock
			cover: (122 to: 126)
			declaredAt: (122 to: 126)) now ] valueCoveringAll:
			{128 to: 130}) ] valueCoveringAll:
		{120 to: 120}.! !
!Behavior method!
maxInactiveTimeInMinutes
	^ 30 coverAll:
		{30 to: 31}.! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
listCart: cartID
	| cartList |
	[
	(self coverAll:
		{35 to: 38}) assertCartIDIsValid:
		(cartID
			cover: (61 to: 66)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{40 to: 59}.
	(cartList _ [
	(OrderedCollection
		cover: (82 to: 98)
		declaredAt: (82 to: 98)) new ] valueCoveringAll:
		{100 to: 102})
		cover: (70 to: 77)
		declaredAt: (23 to: 30).
	[
	([
	(carts
		cover: (107 to: 111)
		declaredAt: (107 to: 111)) at:
		(cartID
			cover: (117 to: 122)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{113 to: 115}) do: [ :anItem |
		[
		(cartList
			cover: (140 to: 147)
			declaredAt: (23 to: 30)) add:
			(anItem
				cover: (154 to: 159)
				declaredAt: (131 to: 136)) ] valueCoveringAll:
			{149 to: 152} ]] valueCoveringAll:
		{125 to: 127}.
	[
	(lastTimeCartUsed
		cover: (166 to: 181)
		declaredAt: (166 to: 181))
		at:
			(cartID
				cover: (187 to: 192)
				declaredAt: (11 to: 16))
		put:
			([
			(clock
				cover: (199 to: 203)
				declaredAt: (199 to: 203)) now ] valueCoveringAll:
				{205 to: 207}) ] valueCoveringAll:
		{183 to: 185. 194 to: 197}.
	^ cartList
		cover: (215 to: 222)
		declaredAt: (23 to: 30).! !
!Behavior method!
assertCartIDIsValid: cartID
	[
	([
	(self coverAll:
		{33 to: 36}) hasCartIdentified:
		(cartID
			cover: (57 to: 62)
			declaredAt: (22 to: 27)) ] valueCoveringAll:
		{38 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) invalidCartIDErrorDescription ] valueCoveringAll:
				{99 to: 127}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
invalidCartIDErrorDescription
	^ 'Cart ID is not in the system' coverAll:
		{33 to: 62}.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
addMinutes: anAmountOfMinutes
	(dateTime _ [
	(dateTime
		cover: (32 to: 39)
		declaredAt: (32 to: 39)) next:
		([
		([
		(TimeUnits
			cover: (60 to: 68)
			declaredAt: (60 to: 68)) minute ] valueCoveringAll:
			{70 to: 75}) with:
			(anAmountOfMinutes
				cover: (83 to: 99)
				declaredAt: (13 to: 29)) ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{53 to: 57})
		cover: (44 to: 51)
		declaredAt: (32 to: 39).! !
!Behavior method!
invalidateCartId: aCartID
	[
	(carts
		cover: (28 to: 32)
		declaredAt: (28 to: 32)) removeKey:
		(aCartID
			cover: (45 to: 51)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{34 to: 43}.
	[
	(lastTimeCartUsed
		cover: (55 to: 70)
		declaredAt: (55 to: 70)) removeKey:
		(aCartID
			cover: (83 to: 89)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{72 to: 81}.
	[
	(cartOwner
		cover: (93 to: 101)
		declaredAt: (93 to: 101)) removeKey:
		(aCartID
			cover: (114 to: 120)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{103 to: 112}.! !

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
addToCart: aCartID item: anItem quantity: aQuantity
	[
	(self coverAll:
		{55 to: 58}) assertCartIDIsValid:
		(aCartID
			cover: (81 to: 87)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{60 to: 79}.
	[
	([
	(carts
		cover: (95 to: 99)
		declaredAt: (95 to: 99)) at:
		(aCartID
			cover: (105 to: 111)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{101 to: 103})
		add:
			(aQuantity
				cover: (119 to: 127)
				declaredAt: (43 to: 51))
		of:
			(anItem
				cover: (133 to: 138)
				declaredAt: (26 to: 31)) ] valueCoveringAll:
		{114 to: 117. 129 to: 131}.
	[
	(lastTimeCartUsed
		cover: (144 to: 159)
		declaredAt: (144 to: 159))
		at:
			(aCartID
				cover: (164 to: 170)
				declaredAt: (12 to: 18))
		put:
			([
			(clock
				cover: (177 to: 181)
				declaredAt: (177 to: 181)) now ] valueCoveringAll:
				{183 to: 185}) ] valueCoveringAll:
		{161 to: 163. 172 to: 175}.! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
listPurchasesOf: aUserId password: aPassword
	| userIDSales items totalAmount |
	[
	(clientAuthenticator
		cover: (80 to: 98)
		declaredAt: (80 to: 98))
		authenticateUser:
			(aUserId
				cover: (118 to: 124)
				declaredAt: (18 to: 24))
		withPassword:
			(aPassword
				cover: (140 to: 148)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{100 to: 116. 126 to: 138}.
	(userIDSales _ [
	(salesBook
		cover: (168 to: 176)
		declaredAt: (168 to: 176)) select: [ :aSales |
		[
		([
		(aSales
			cover: (197 to: 202)
			declaredAt: (188 to: 193)) userID ] valueCoveringAll:
			{204 to: 209}) =
			(aUserId
				cover: (213 to: 219)
				declaredAt: (18 to: 24)) ] valueCoveringAll:
			{211 to: 211} ]] valueCoveringAll:
		{178 to: 184})
		cover: (153 to: 163)
		declaredAt: (48 to: 58).
	(items _ [
	(OrderedCollection
		cover: (233 to: 249)
		declaredAt: (233 to: 249)) new ] valueCoveringAll:
		{251 to: 253})
		cover: (224 to: 228)
		declaredAt: (60 to: 64).
	[
	(userIDSales
		cover: (257 to: 267)
		declaredAt: (48 to: 58)) do: [ :aSales |
		[
		(items
			cover: (284 to: 288)
			declaredAt: (60 to: 64)) addAll:
			([
			(aSales
				cover: (298 to: 303)
				declaredAt: (275 to: 280)) items ] valueCoveringAll:
				{305 to: 309}) ] valueCoveringAll:
			{290 to: 296} ]] valueCoveringAll:
		{269 to: 271}.
	(totalAmount _ [
	(userIDSales
		cover: (329 to: 339)
		declaredAt: (48 to: 58))
		sum: [ :aSales |
			[
			(aSales
				cover: (357 to: 362)
				declaredAt: (348 to: 353)) totalAmount ] valueCoveringAll:
				{364 to: 374} ]
		ifEmpty:
			(0 coverAll:
				{386 to: 386}) ] valueCoveringAll:
		{341 to: 344. 377 to: 384})
		cover: (314 to: 324)
		declaredAt: (66 to: 76).
	^ [
	(PurchaseList
		cover: (392 to: 403)
		declaredAt: (392 to: 403))
		withItems:
			(items
				cover: (416 to: 420)
				declaredAt: (60 to: 64))
		totalAmount:
			(totalAmount
				cover: (435 to: 445)
				declaredAt: (66 to: 76)) ] valueCoveringAll:
		{405 to: 414. 422 to: 433}.! !
!Behavior method!
withItems: anItemList totalAmount: anAmount
	self coverAll:
		{49 to: 52}.
	^ [
	([ self new ] valueCoveringAll:
		{54 to: 56})
		initializeWithItems:
			(anItemList
				cover: (79 to: 88)
				declaredAt: (12 to: 21))
		totalAmount:
			(anAmount
				cover: (103 to: 110)
				declaredAt: (36 to: 43)) ] valueCoveringAll:
		{58 to: 77. 90 to: 101}.! !
!Behavior method!
initializeWithItems: anItemList totalAmount: anAmount
	(itemList _ anItemList
		cover: (69 to: 78)
		declaredAt: (22 to: 31))
		cover: (57 to: 64)
		declaredAt: (57 to: 64).
	(amount _ anAmount
		cover: (92 to: 99)
		declaredAt: (46 to: 53))
		cover: (82 to: 87)
		declaredAt: (82 to: 87).! !
!Behavior method!
isEmpty
	^ [
	(itemList
		cover: (12 to: 19)
		declaredAt: (12 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Behavior method!
checkoutCart: aCartId creditCard: aCreditCard
	| userID |
	[
	(self coverAll:
		{61 to: 64}) assertCartIDIsValid:
		(aCartId
			cover: (87 to: 93)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{66 to: 85}.
	[
	(cashier
		cover: (99 to: 105)
		declaredAt: (99 to: 105))
		checkout:
			([
			(carts
				cover: (118 to: 122)
				declaredAt: (118 to: 122)) at:
				(aCartId
					cover: (128 to: 134)
					declaredAt: (15 to: 21)) ] valueCoveringAll:
				{124 to: 126})
		withCreditCard:
			(aCreditCard
				cover: (153 to: 163)
				declaredAt: (35 to: 45)) ] valueCoveringAll:
		{107 to: 115. 137 to: 151}.
	(userID _ [
	(cartOwner
		cover: (177 to: 185)
		declaredAt: (177 to: 185)) at:
		(aCartId
			cover: (191 to: 197)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{187 to: 189})
		cover: (167 to: 172)
		declaredAt: (51 to: 56).
	[
	([
	(salesBook
		cover: (202 to: 210)
		declaredAt: (202 to: 210)) last ] valueCoveringAll:
		{212 to: 215}) userID:
		(userID
			cover: (225 to: 230)
			declaredAt: (51 to: 56)) ] valueCoveringAll:
		{217 to: 223}.
	[
	(self coverAll:
		{236 to: 239}) invalidateCartId:
		(aCartId
			cover: (259 to: 265)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{241 to: 257}.
	^ [
	(salesBook
		cover: (271 to: 279)
		declaredAt: (202 to: 210)) size ] valueCoveringAll:
		{281 to: 284}.! !
!Behavior method!
userID: aUserID
	(userID _ aUserID
		cover: (28 to: 34)
		declaredAt: (9 to: 15))
		cover: (18 to: 23)
		declaredAt: (18 to: 23).! !
!Behavior method!
userID
	^ userID
		cover: (10 to: 15)
		declaredAt: (10 to: 15).! !
!Behavior method!
list
	^ [
	(itemList
		cover: (9 to: 16)
		declaredAt: (9 to: 16)) copy ] valueCoveringAll:
		{18 to: 21}.! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 08:32:55'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 08:32:55'!
PASSED!
!Store methodsFor: 'lists' stamp: 'JA 6/24/2021 08:39:17' prior: 50869421!
listPurchasesOf: aUserId password: aPassword
	|userIDSales items totalAmount|
	clientAuthenticator authenticateUser: aUserId withPassword: aPassword. 
	userIDSales := salesBook select: [:aSales | aSales userID = aUserId].
	items := OrderedCollection new.
	userIDSales do: [:aSales | items addAll: aSales items].
	totalAmount := userIDSales sum: [:aSales | aSales totalAmount] ifEmpty: 0.
	PurchaseList withItems: items totalAmount: totalAmount.
	! !
!Store methodsFor: 'lists' stamp: 'JA 6/24/2021 08:39:42' prior: 50870708!
listPurchasesOf: aUserId password: aPassword
	|userIDSales items totalAmount|
	clientAuthenticator authenticateUser: aUserId withPassword: aPassword. 
	userIDSales := salesBook select: [:aSales | aSales userID = aUserId].
	items := OrderedCollection new.
	userIDSales do: [:aSales | items addAll: aSales items].
	totalAmount := userIDSales sum: [:aSales | aSales totalAmount] ifEmpty: 0.
	^PurchaseList withItems: items totalAmount: totalAmount.
	! !
!Store methodsFor: 'lists' stamp: 'JA 6/24/2021 08:41:01'!
purchaseListFor: aUserID
	|userIDSales items totalAmount|	
	userIDSales := salesBook select: [:aSales | aSales userID = aUserID].
	items := OrderedCollection new.
	userIDSales do: [:aSales | items addAll: aSales items].
	totalAmount := userIDSales sum: [:aSales | aSales totalAmount] ifEmpty: 0.
	^PurchaseList withItems: items totalAmount: totalAmount.
	! !
!Store methodsFor: 'lists' stamp: 'JA 6/24/2021 08:41:30' prior: 50870725!
listPurchasesOf: aUserId password: aPassword
	
	clientAuthenticator authenticateUser: aUserId withPassword: aPassword. 
	
	^ self purchaseListFor: aUserId 
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 08:41:31'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 08:41:31'!
PASSED!
!Store methodsFor: 'lists' stamp: 'JA 6/24/2021 08:42:51'!
updateLastTimeUsedFor: cartID

	^ lastTimeCartUsed at: cartID put: clock now! !
!Store methodsFor: 'lists' stamp: 'JA 6/24/2021 08:42:51' prior: 50869412!
listCart: cartID
	
	| cartList |
	self assertCartIDIsValid: cartID.
	cartList := OrderedCollection new.
	(carts at: cartID) do: [:anItem | cartList add: anItem].
	
	self updateLastTimeUsedFor: cartID.
	
	^ cartList.! !
!Store methodsFor: 'adding' stamp: 'JA 6/24/2021 08:44:03' prior: 50869437!
addToCart: aCartID item: anItem quantity: aQuantity

	self assertCartIDIsValid: aCartID	.	
	(carts at: aCartID) add: aQuantity of: anItem.	
	self updateLastTimeUsedFor: aCartID.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 08:44:04'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 08:44:04'!
PASSED!
!Store methodsFor: 'adding' stamp: 'JA 6/24/2021 08:48:09' prior: 50869445!
createCartFor: userID authenticatedWith: aPassword
	|cartID|
	clientAuthenticator authenticateUser: userID withPassword: aPassword. 
	
	cartID := currentCartID.
	currentCartID := currentCartID + 1.
	carts add: cartID -> (Cart acceptingItemsOf: priceList keys).
	cartOwner add: cartID -> userID.
	"lastTimeCartUsed add: cartID -> clock now."
	self updateLastTimeUsedFor: cartID .
	^cartID
	
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 08:48:11'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 08:49:07'!
PASSED!

a := Dictionary new.!

a at: 12 put:1!

a at: 12 put:1!

a add: 11->1!

a!
!Store methodsFor: 'adding' stamp: 'JA 6/24/2021 08:52:20' prior: 50870891!
createCartFor: userID authenticatedWith: aPassword
	|cartID|
	clientAuthenticator authenticateUser: userID withPassword: aPassword. 
	
	cartID := currentCartID.
	currentCartID := currentCartID + 1.
	carts add: cartID -> (Cart acceptingItemsOf: priceList keys).
	cartOwner add: cartID -> userID.
	"lastTimeCartUsed add: cartID -> clock now."
	self updateLastTimeUsedFor: cartID .
	^cartID
	
	! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 08:52:20'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 08:52:20'!
PASSED!
!Store methodsFor: 'adding' stamp: 'JA 6/24/2021 08:52:29' prior: 50870964!
createCartFor: userID authenticatedWith: aPassword
	|cartID|
	clientAuthenticator authenticateUser: userID withPassword: aPassword. 
	
	cartID := currentCartID.
	currentCartID := currentCartID + 1.
	carts add: cartID -> (Cart acceptingItemsOf: priceList keys).
	cartOwner add: cartID -> userID.
	self updateLastTimeUsedFor: cartID .
	^cartID
	
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 08:52:30'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 08:52:30'!
PASSED!
!Store methodsFor: 'adding' stamp: 'JA 6/24/2021 08:56:06'!
nextFreeCartID
	
	currentCartID := currentCartID + 1.	
	^ currentCartID 
	
	! !
!Store methodsFor: 'adding' stamp: 'JA 6/24/2021 08:56:32' prior: 50871095!
createCartFor: userID authenticatedWith: aPassword
	|cartID|
	clientAuthenticator authenticateUser: userID withPassword: aPassword. 
	
	cartID := self nextFreeCartID.
	carts add: cartID -> (Cart acceptingItemsOf: priceList keys).
	cartOwner add: cartID -> userID.
	self updateLastTimeUsedFor: cartID .
	^cartID
	
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 08:56:33'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 08:56:33'!
PASSED!
!Store methodsFor: 'adding' stamp: 'JA 6/24/2021 08:58:49' prior: 50871165!
createCartFor: userID authenticatedWith: aPassword
	|cartID|
	clientAuthenticator authenticateUser: userID withPassword: aPassword. 
	
	cartID := self nextFreeCartID.
	carts add: cartID -> (Cart acceptingItemsOf: priceList keys).
	cartOwner add: cartID -> userID.
	
	self updateLastTimeUsedFor: cartID .
	^cartID
	
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 08:58:50'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 08:58:50'!
PASSED!
!Store methodsFor: 'initialization' stamp: 'JA 6/24/2021 09:00:40'!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList merchantProcessor: aMerchantProcessor  
	clientAuthenticator := aClientAuthenticator.
	clock := aClock.
	priceList := aPriceList.
	carts := Dictionary new.
	lastTimeCartUsed := Dictionary new.
	cartOwner := Dictionary new.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	currentCartID := 0.
	
! !
!Store class methodsFor: 'as yet unclassified' stamp: 'JA 6/24/2021 09:00:40' prior: 50869466!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList   
	^self new initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList merchantProcessor: MerchantProcessorSimulator new.! !

!methodRemoval: Store #initializeWithClientAuthenticator:clock:priceList: stamp: 'JA 6/24/2021 09:00:40'!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList 
	clientAuthenticator := aClientAuthenticator.
	clock := aClock.
	priceList := aPriceList.
	carts := Dictionary new.
	lastTimeCartUsed := Dictionary new.
	cartOwner := Dictionary new.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: MerchantProcessorSimulator new.
	currentCartID := 0.
	
!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:01:01'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:01:01'!
PASSED!
!Store class methodsFor: 'instance creation' stamp: 'JA 6/24/2021 09:01:37'!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList merchantProcessor: aMerchantProcessor    
	^self new initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList merchantProcessor: MerchantProcessorSimulator new.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/24/2021 09:01:37' prior: 50868850!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.								
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/24/2021 09:01:37' prior: 50868621!
test01CanNotCreateCartWhenCredentialsCantBeAuthenticated

	| store errorMessage clientAuthenticatorSimulator |
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator clock: GregorianDateTime now priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	
	
	self should: [		store createCartFor: 123 authenticatedWith: 'passwd'	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :anError | 	self assert: errorMessage  equals: anError messageText.
					self deny: store hasCarts.]
	
	
	
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/24/2021 09:01:37' prior: 50868756!
test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated

	| store clientAuthenticatorSimulator errorMessage |
	store := self store .		
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator clock: GregorianDateTime now priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new .
	
	
	self should: [
		store listPurchasesOf: 123 password: 'passwd'.
	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 	
		self assert: errorMessage  equals: exception messageText.
		self deny: store hasCarts.
	]
	
	
	
			! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/24/2021 09:01:37' prior: 50868696!
test07CartIsInvalidAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.

	self deny: (store hasCartIdentified: cartID1).
		! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/24/2021 09:01:37' prior: 50868889!
store
	
	^ Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: self clockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.! !
!StoreTest methodsFor: 'as yet unclassified' stamp: 'JA 6/24/2021 09:01:37' prior: 50868711!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := store createCartFor: 123 authenticatedWith: 'passwd'.

	aClockSimulator addMinutes: 31.
	
	
	self should: [store addToCart: cartID1 item: 123456789 quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!methodRemoval: Store class #withClientAuthenticator:clock:priceList: stamp: 'JA 6/24/2021 09:01:37'!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList   
	^self new initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList merchantProcessor: MerchantProcessorSimulator new.!
!Store class methodsFor: 'instance creation' stamp: 'JA 6/24/2021 09:01:49' prior: 50871394!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList merchantProcessor: aMerchantProcessor    
	^self new initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList merchantProcessor: aMerchantProcessor .! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:01:50'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:01:50'!
PASSED!
!Store methodsFor: 'initialization' stamp: 'JA 6/24/2021 09:02:04' prior: 50871295!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList merchantProcessor: aMerchantProcessor  
	clientAuthenticator := aClientAuthenticator.
	clock := aClock.
	priceList := aPriceList.
	carts := Dictionary new.
	lastTimeCartUsed := Dictionary new.
	cartOwner := Dictionary new.
	salesBook := OrderedCollection new.
	cashier := Cashier with: priceList registerSalesOn: salesBook merchantProcessor: aMerchantProcessor .
	currentCartID := 0.
	
! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:02:05'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:03:21'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:04:21'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:04:21'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:06:14'!
validUserID

	^ 123! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:06:14' prior: 50868827!
test15CheckoutCartReturnsUniqueTransactionIDs

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := store createCartFor: self validUserID authenticatedWith: 'passwd'.	
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	store addToCart: cartID2 item: testObjects itemSellByTheStore quantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:06:34'!
validUserPassword

	^ 'passwd'! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:06:34' prior: 50871862!
test15CheckoutCartReturnsUniqueTransactionIDs

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	
	cartID2 := store createCartFor: 123 authenticatedWith: 'passwd'.	
	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	store addToCart: cartID2 item: testObjects itemSellByTheStore quantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:06:51' prior: 50871889!
test15CheckoutCartReturnsUniqueTransactionIDs

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	
	cartID2 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	
	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	store addToCart: cartID2 item: testObjects itemSellByTheStore quantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:06:52'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:06:52'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:07:06' prior: 50871406!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.								
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:07:07'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:07:07'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:07:43' prior: 50868814!
test14CheckoutInvalidatesCartId

	| store cartID1 |
	store := self store .
	cartID1 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
		
	store checkoutCart: cartID1 creditCard: testObjects validCreditCard .
	
	self deny: (store hasCartIdentified: cartID1).! !

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:07:43'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:07:43'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:07:57' prior: 50868781!
test12CheckoutUpdatesPurchaseListOfUserWithTheSales

	| store purchases cartID1 |
	store := self store .
	cartID1 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	
	store checkoutCart: cartID1 creditCard: testObjects validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases list size.
	self assert: 10 equals: (purchases list occurrencesOf: testObjects itemSellByTheStore).
	self assert: 10 * testObjects itemInStorePrice equals: purchases totalAmount.	! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:07:59'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:08:01'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:08:01'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:08:50' prior: 50868746!
test10PurchaseListOfUserWithoutPurchasesIsEmpty

	| store purchases |
	store := self store .
	
	purchases := store listPurchasesOf: self validUserID password: self validUserPassword.
	self assert: purchases isEmpty.
	self assert: 0 equals: purchases totalAmount .
	! !

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:08:51'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:08:51'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:09:03' prior: 50868731!
test09ItemsAddedToCartAreListed

	| store cartID cartList |
	store := self store .
	cartID := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	
	
	
	store addToCart: cartID item: testObjects itemSellByTheStore quantity:10.
	cartList := store listCart: cartID .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: (cartList occurrencesOf: testObjects itemSellByTheStore).
	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:09:17' prior: 50871519!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	

	aClockSimulator addMinutes: 31.
	
	
	self should: [store addToCart: cartID1 item: 123456789 quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:09:18'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:09:18'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:09:29' prior: 50871491!
test07CartIsInvalidAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	

	aClockSimulator addMinutes: 31.

	self deny: (store hasCartIdentified: cartID1).
		! !

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:09:32'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:09:32'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:09:46' prior: 50868682!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := self store .
	
	cartID1 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	
	cartID2 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	
	
	self deny: cartID1 = cartID2.
	self assert: (store hasCartIdentified: cartID1).
	self assert: (store hasCartIdentified: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:09:47'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:09:47'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:10:10' prior: 50868663!
test04NewCreatedCartIsEmpty

	| store aCartId |
	store := self store .
	
	aCartId := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	

	self assert: (store listCart: aCartId) isEmpty.
	
	
	
		! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:10:12'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:10:12'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:10:24' prior: 50868645!
test02StoreHasNewCreatedCart

	| store aCartId |
	store := self store.
	
	aCartId := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	

	self assert: store hasCarts.
	self assert: (store hasCartIdentified: aCartId).

	
	
	
		! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:10:26'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:10:26'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:13:42'!
createValidCartIn: store

	^ store createCartFor: self validUserID authenticatedWith: self validUserPassword! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:13:42' prior: 50871994!
test16UseCartUpdatesTimeLimit

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := self createValidCartIn: store.	

	aClockSimulator addMinutes: 30.
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity:10.
	aClockSimulator addMinutes: 1.
	store listCart: cartID1.								
	aClockSimulator addMinutes: 30.
	store listCart: cartID1.
	aClockSimulator addMinutes: 31.
	
	self should: [store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:14:51' prior: 50871913!
test15CheckoutCartReturnsUniqueTransactionIDs

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := self createValidCartIn: store.	
	cartID2 := self createValidCartIn: store.	
	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	store addToCart: cartID2 item: testObjects itemSellByTheStore quantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: TestObjects new validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: TestObjects new validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:14:52'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:14:52'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:15:11' prior: 50872080!
test14CheckoutInvalidatesCartId

	| store cartID1 |
	store := self store .
	cartID1 := self createValidCartIn: store.	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
		
	store checkoutCart: cartID1 creditCard: testObjects validCreditCard .
	
	self deny: (store hasCartIdentified: cartID1).! !

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:15:11'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:15:11'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:15:48' prior: 50872150!
test12CheckoutUpdatesPurchaseListOfUserWithTheSales

	| store purchases cartID1 |
	store := self store .
	cartID1 := self createValidCartIn: store.	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	
	store checkoutCart: cartID1 creditCard: testObjects validCreditCard .
	
	purchases := store listPurchasesOf: 123 password: 'passwd'.
	self assert: 10 equals: purchases list size.
	self assert: 10 equals: (purchases list occurrencesOf: testObjects itemSellByTheStore).
	self assert: 10 * testObjects itemInStorePrice equals: purchases totalAmount.	! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:15:49'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:15:49'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:17:07' prior: 50871463!
test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated

	| store clientAuthenticatorSimulator errorMessage |
	store := self store .		
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator clock: self clockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new .
	
	
	self should: [
		store listPurchasesOf: 123 password: 'passwd'.
	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 	
		self assert: errorMessage  equals: exception messageText.
		self deny: store hasCarts.
	]
	
	
	
			! !

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:17:08'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:17:08'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:18:24' prior: 50872299!
test09ItemsAddedToCartAreListed

	| store cartID cartList |
	store := self store .
	cartID := self createValidCartIn: store.	
	
	
	store addToCart: cartID item: testObjects itemSellByTheStore quantity:10.
	cartList := store listCart: cartID .
	
	self assert: 10 equals: (cartList size).
	self assert: 10 equals: (cartList occurrencesOf: testObjects itemSellByTheStore).
	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:18:49' prior: 50872315!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := self createValidCartIn: store.	

	aClockSimulator addMinutes: 31.
	
	
	self should: [store addToCart: cartID1 item: 123456789 quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:20:02' prior: 50873026!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := self createValidCartIn: store.	

	aClockSimulator addMinutes: 31.
	
	
	self should: [store addToCart: cartID1 item: testObjects itemSellByTheStore  quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:20:04'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:20:04'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:20:14' prior: 50873048!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := self createValidCartIn: store.	

	aClockSimulator addMinutes: 21.
	
	
	self should: [store addToCart: cartID1 item: testObjects itemSellByTheStore  quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:20:16'!
FAILURE!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:20:21' prior: 50873126!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := self createValidCartIn: store.	

	aClockSimulator addMinutes: 31.
	
	
	self should: [store addToCart: cartID1 item: testObjects itemSellByTheStore  quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:20:22'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:20:22'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:20:45' prior: 50872394!
test07CartIsInvalidAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := self createValidCartIn: store.	

	aClockSimulator addMinutes: 31.

	self deny: (store hasCartIdentified: cartID1).
		! !

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:20:49'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:20:49'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:21:03' prior: 50872468!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := self store .
	
	cartID1 := self createValidCartIn: store.	
	cartID2 := self createValidCartIn: store.	
	
	self deny: cartID1 = cartID2.
	self assert: (store hasCartIdentified: cartID1).
	self assert: (store hasCartIdentified: cartID2).

	
	
	
		! !
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:22:48' prior: 50873302!
test06StoreCanCreateMoreThanOneCart

	| store cartID1 cartID2 |
	store := self store .
	
	cartID1 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	
	cartID2 := store createCartFor: self validUserID authenticatedWith: self validUserPassword.	
	
	self deny: cartID1 = cartID2.
	self assert: (store hasCartIdentified: cartID1).
	self assert: (store hasCartIdentified: cartID2).

	
	
	
		! !

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:22:49'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:22:49'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:24:40' prior: 50872705!
test15CheckoutCartReturnsUniqueTransactionIDs

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := self createValidCartIn: store.	
	cartID2 := self createValidCartIn: store.	
	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	store addToCart: cartID2 item: testObjects itemSellByTheStore quantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: testObjects validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: testObjects validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:24:41'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:24:41'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:25:40' prior: 50872851!
test12CheckoutUpdatesPurchaseListOfUserWithTheSales

	| store purchases cartID1 |
	store := self store .
	cartID1 := self createValidCartIn: store.	
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	
	store checkoutCart: cartID1 creditCard: testObjects validCreditCard .
	
	purchases := store listPurchasesOf: self validUserID password: self validUserPassword .
	self assert: 10 equals: purchases list size.
	self assert: 10 equals: (purchases list occurrencesOf: testObjects itemSellByTheStore).
	self assert: 10 * testObjects itemInStorePrice equals: purchases totalAmount.	! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:25:41'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:25:41'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:26:12' prior: 50872928!
test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated

	| store clientAuthenticatorSimulator errorMessage |
	store := self store .		
	errorMessage _ 'Username or password invalid'.
	clientAuthenticatorSimulator _ ClientAuthenticatorSimulator new.
	clientAuthenticatorSimulator raiseAuthenticationErrorWithMessage: errorMessage .
	store := Store withClientAuthenticator: clientAuthenticatorSimulator clock: self clockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new .
	
	
	self should: [
		store listPurchasesOf: self validUserID password: self validUserPassword .
	] 
	raise: Error - MessageNotUnderstood 
	withExceptionDo: [ :exception | 	
		self assert: errorMessage  equals: exception messageText.
		self deny: store hasCarts.
	]
	
	
	
			! !

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:26:13'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:26:13'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:27:20' prior: 50873386!
test15CheckoutCartReturnsUniqueTransactionIDs

	| store cartID1 cartID2 transactionID1 transactionID2 |
	store := self store .
	cartID1 := self createValidCartIn: store.	
	cartID2 := self createValidCartIn: store.		
	store addToCart: cartID1 item: testObjects itemSellByTheStore quantity: 10.
	store addToCart: cartID2 item: testObjects itemSellByTheStore quantity: 10.		
	
	transactionID1 := store checkoutCart: cartID1 creditCard: testObjects validCreditCard .
	transactionID2 := store checkoutCart: cartID2 creditCard: testObjects validCreditCard .	
	
	self deny: transactionID1 = transactionID2.! !

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:27:21'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:27:21'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'JA 6/24/2021 09:28:16' prior: 50873152!
test08CannotAddToCartAfter30MinOfItsCreation

	| store cartID1 aClockSimulator |
	aClockSimulator:= self clockSimulator.
	store := Store withClientAuthenticator: ClientAuthenticatorSimulator new clock: aClockSimulator priceList: testObjects defaultPriceList merchantProcessor: MerchantProcessorSimulator new.
	cartID1 := self createValidCartIn: store.	
	aClockSimulator addMinutes: 31.
	
	
	self should: [store addToCart: cartID1 item: testObjects itemSellByTheStore  quantity: 10.]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [:anError | self assert: anError messageText = Store invalidCartIDErrorDescription]	! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:28:18'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:28:19'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:28:19'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:28:19'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:28:19'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:28:19'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:30:09'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:30:09'!
PASSED!
!Store methodsFor: 'adding' stamp: 'JA 6/24/2021 09:34:35'!
itemCatalog

	^ priceList keys! !
!Store methodsFor: 'adding' stamp: 'JA 6/24/2021 09:34:35' prior: 50871230!
createCartFor: userID authenticatedWith: aPassword
	|cartID|
	clientAuthenticator authenticateUser: userID withPassword: aPassword. 
	
	cartID := self nextFreeCartID.
	carts add: cartID -> (Cart acceptingItemsOf: self itemCatalog).
	cartOwner add: cartID -> userID.
	
	self updateLastTimeUsedFor: cartID .
	^cartID
	
	! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:35:17'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:35:17'!
PASSED!
!Store methodsFor: 'lists' stamp: 'JA 6/24/2021 09:36:40' prior: 50870820!
listCart: cartID
	
	| cartList |
	self assertCartIDIsValid: cartID.
	
	cartList := OrderedCollection new.
	(carts at: cartID) do: [:anItem | cartList add: anItem].
	
	self updateLastTimeUsedFor: cartID.
	
	^ cartList.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:36:42'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:36:42'!
PASSED!
!Behavior method!
defaultCatalog
	^ [
	(Array
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) with:
		([
		(self coverAll:
			{33 to: 36}) itemSellByTheStore ] valueCoveringAll:
			{38 to: 55}) ] valueCoveringAll:
		{27 to: 31}.! !
!Behavior method!
itemSellByTheStore
	^ 'validBook' coverAll:
		{25 to: 35}.! !
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWith:
			(aPriceList
				cover: (112 to: 121)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (140 to: 149)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessor
				cover: (170 to: 187)
				declaredAt: (65 to: 82)) ] valueCoveringAll:
		{96 to: 110. 123 to: 138. 151 to: 168}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	(priceList _ aPriceList
		cover: (111 to: 120)
		declaredAt: (17 to: 26))
		cover: (98 to: 106)
		declaredAt: (98 to: 106).
	(salesBook _ aSalesBook
		cover: (137 to: 146)
		declaredAt: (45 to: 54))
		cover: (124 to: 132)
		declaredAt: (124 to: 132).
	(merchantProcessor _ aMerchantProcessor
		cover: (171 to: 188)
		declaredAt: (75 to: 92))
		cover: (150 to: 166)
		declaredAt: (150 to: 166).! !
!Behavior method!
validCreditCard
	^ [
	(CreditCard
		cover: (21 to: 30)
		declaredAt: (21 to: 30))
		owner:
			('owner' coverAll:
				{39 to: 45})
		number:
			('1234567891011121' coverAll:
				{55 to: 72})
		expiration:
			([
			([
			(GregorianMonthOfYear
				cover: (86 to: 105)
				declaredAt: (86 to: 105)) current ] valueCoveringAll:
				{107 to: 113}) next ] valueCoveringAll:
				{115 to: 118}) ] valueCoveringAll:
		{32 to: 37. 47 to: 53. 74 to: 84}.! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{89 to: 121}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (128 to: 134)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (159 to: 164)
			declaredAt: (150 to: 155)) isDigit ] valueCoveringAll:
			{166 to: 172} ]] valueCoveringAll:
		{136 to: 146}) ifFalse: [
		[
		(self coverAll:
			{187 to: 190}) error:
			([
			(self coverAll:
				{199 to: 202}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{204 to: 236}) ] valueCoveringAll:
			{192 to: 197} ]] valueCoveringAll:
		{177 to: 184}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{103 to: 135}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(expirationMonthOfYear _ aGregorianMonthOfYear
		cover: (209 to: 229)
		declaredAt: (76 to: 96))
		cover: (184 to: 204)
		declaredAt: (184 to: 204).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice items sales |
	[
	(self coverAll:
		{73 to: 76}) assertCartIsNotEmpty:
		(aCart
			cover: (100 to: 104)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{78 to: 98}.
	[
	(self coverAll:
		{108 to: 111}) assertCreditCardIsNotExpired:
		(aCreditCard
			cover: (143 to: 153)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{113 to: 141}.
	(totalPrice _ 0 coverAll:
		{171 to: 171})
		cover: (157 to: 166)
		declaredAt: (48 to: 57).
	(items _ [
	(OrderedCollection
		cover: (184 to: 200)
		declaredAt: (184 to: 200)) new ] valueCoveringAll:
		{202 to: 204})
		cover: (175 to: 179)
		declaredAt: (59 to: 63).
	[
	(aCart
		cover: (208 to: 212)
		declaredAt: (11 to: 15)) do: [ :anItem |
		(totalPrice _ [
		([
		(totalPrice
			cover: (229 to: 238)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (256 to: 264)
				declaredAt: (256 to: 264)) ] valueCoveringAll:
			{254 to: 254})
			at:
				(anItem
					cover: (270 to: 275)
					declaredAt: (220 to: 225))
			ifAbsent: [
				[
				(self coverAll:
					{288 to: 291}) raiseItemNotInPriceListError ] valueCoveringAll:
					{293 to: 320} ]] valueCoveringAll:
			{266 to: 268. 277 to: 285})
			cover: (243 to: 252)
			declaredAt: (48 to: 57).
		[
		(items
			cover: (326 to: 330)
			declaredAt: (59 to: 63)) add:
			(anItem
				cover: (337 to: 342)
				declaredAt: (220 to: 225)) ] valueCoveringAll:
			{332 to: 335} ]] valueCoveringAll:
		{214 to: 216}.
	[
	(merchantProcessor
		cover: (347 to: 363)
		declaredAt: (347 to: 363))
		charge:
			(totalPrice
				cover: (373 to: 382)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (389 to: 399)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{365 to: 371. 385 to: 387}.
	(sales _ [
	(Sales
		cover: (413 to: 417)
		declaredAt: (413 to: 417))
		withItems:
			(items
				cover: (430 to: 434)
				declaredAt: (59 to: 63))
		totalAmount:
			(totalPrice
				cover: (449 to: 458)
				declaredAt: (48 to: 57)) ] valueCoveringAll:
		{419 to: 428. 436 to: 447})
		cover: (404 to: 408)
		declaredAt: (65 to: 69).
	[
	(salesBook
		cover: (462 to: 470)
		declaredAt: (462 to: 470)) add:
		(sales
			cover: (477 to: 481)
			declaredAt: (65 to: 69)) ] valueCoveringAll:
		{472 to: 475}.
	^ sales
		cover: (486 to: 490)
		declaredAt: (65 to: 69).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) emptyCartErrorDescription ] valueCoveringAll:
				{80 to: 104}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
emptyCartErrorDescription
	^ 'The cart is empty' coverAll:
		{29 to: 47}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
assertCreditCardIsNotExpired: aCreditCard
	[
	([
	(aCreditCard
		cover: (47 to: 57)
		declaredAt: (31 to: 41)) isExpiredOn:
		([
		(Date
			cover: (72 to: 75)
			declaredAt: (72 to: 75)) today ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{59 to: 70}) ifTrue: [
		[
		(self coverAll:
			{93 to: 96}) error:
			([
			([
			(self coverAll:
				{105 to: 108}) class ] valueCoveringAll:
				{110 to: 114}) expiredCreditCardErrorDescription ] valueCoveringAll:
				{116 to: 148}) ] valueCoveringAll:
			{98 to: 103} ]] valueCoveringAll:
		{84 to: 90}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	([
	(GregorianMonthOfYear
		cover: (26 to: 45)
		declaredAt: (26 to: 45))
		yearNumber:
			([
			(aDate
				cover: (59 to: 63)
				declaredAt: (14 to: 18)) yearNumber ] valueCoveringAll:
				{65 to: 74})
		monthNumber:
			([
			(aDate
				cover: (89 to: 93)
				declaredAt: (14 to: 18)) monthIndex ] valueCoveringAll:
				{95 to: 104}) ] valueCoveringAll:
		{47 to: 57. 76 to: 87}) >
		(expirationMonthOfYear
			cover: (109 to: 129)
			declaredAt: (109 to: 129)) ] valueCoveringAll:
		{107 to: 107}.! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
raiseItemNotInPriceListError
	^ [
	(self coverAll:
		{34 to: 37}) error:
		([
		([
		(self coverAll:
			{46 to: 49}) class ] valueCoveringAll:
			{51 to: 55}) itemNotInPriceListErrorDescription ] valueCoveringAll:
			{57 to: 90}) ] valueCoveringAll:
		{39 to: 44}.! !
!Behavior method!
itemNotInPriceListErrorDescription
	^ 'An item in the cart is not in the price list' coverAll:
		{38 to: 83}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !
!Behavior method!
withItems: items totalAmount: anAmount
	^ [
	([
	(self coverAll:
		{43 to: 46}) new ] valueCoveringAll:
		{48 to: 50})
		initializeWithItems:
			(items
				cover: (73 to: 77)
				declaredAt: (12 to: 16))
		totalAmount:
			(anAmount
				cover: (92 to: 99)
				declaredAt: (31 to: 38)) ] valueCoveringAll:
		{52 to: 71. 79 to: 90}.! !
!Behavior method!
initializeWithItems: aCollectionOfItems totalAmount: anAmount
	(items _ aCollectionOfItems
		cover: (75 to: 92)
		declaredAt: (22 to: 39))
		cover: (66 to: 70)
		declaredAt: (66 to: 70).
	(amount _ anAmount
		cover: (106 to: 113)
		declaredAt: (54 to: 61))
		cover: (96 to: 101)
		declaredAt: (96 to: 101).! !
!Behavior method!
items
	^ items
		cover: (9 to: 13)
		declaredAt: (9 to: 13).! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
expiredCreditCardErrorDescription
	^ 'The credit card is expired' coverAll:
		{37 to: 64}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
invalidCreditCardErrorDescription
	^ 'Los datos de la tarjeta de crdito son invlidos' coverAll:
		{37 to: 86}.! !

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
raiseAuthenticationErrorWithMessage: anErrorMessage
	(authenticationErrorMessage _ anErrorMessage
		cover: (84 to: 97)
		declaredAt: (38 to: 51))
		cover: (54 to: 79)
		declaredAt: (54 to: 79).! !
!Behavior method!
defaultPriceList
	^ [
	(Dictionary
		cover: (21 to: 30)
		declaredAt: (21 to: 30)) with:
		([
		([
		(self coverAll:
			{38 to: 41}) itemSellByTheStore ] valueCoveringAll:
			{43 to: 60}) ->
			([
			(self coverAll:
				{65 to: 68}) itemInStorePrice ] valueCoveringAll:
				{70 to: 85}) ] valueCoveringAll:
			{62 to: 63}) ] valueCoveringAll:
		{32 to: 36}.! !
!Behavior method!
itemInStorePrice
	^ 10 coverAll:
		{21 to: 22}.! !
!Behavior method!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{126 to: 129}) new ] valueCoveringAll:
		{131 to: 133})
		initializeWithClientAuthenticator:
			(aClientAuthenticator
				cover: (170 to: 189)
				declaredAt: (26 to: 45))
		clock:
			(aClock
				cover: (198 to: 203)
				declaredAt: (54 to: 59))
		priceList:
			(priceList
				cover: (216 to: 224)
				declaredAt: (72 to: 80))
		merchantProcessor:
			(aMerchantProcessor
				cover: (245 to: 262)
				declaredAt: (101 to: 118)) ] valueCoveringAll:
		{135 to: 168. 191 to: 196. 205 to: 214. 226 to: 243}.! !
!Behavior method!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList merchantProcessor: aMerchantProcessor
	(clientAuthenticator _ aClientAuthenticator
		cover: (157 to: 176)
		declaredAt: (36 to: 55))
		cover: (134 to: 152)
		declaredAt: (134 to: 152).
	(clock _ aClock
		cover: (189 to: 194)
		declaredAt: (64 to: 69))
		cover: (180 to: 184)
		declaredAt: (180 to: 184).
	(priceList _ aPriceList
		cover: (211 to: 220)
		declaredAt: (82 to: 91))
		cover: (198 to: 206)
		declaredAt: (198 to: 206).
	(carts _ [
	(Dictionary
		cover: (233 to: 242)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{244 to: 246})
		cover: (224 to: 228)
		declaredAt: (224 to: 228).
	(lastTimeCartUsed _ [
	(Dictionary
		cover: (270 to: 279)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{281 to: 283})
		cover: (250 to: 265)
		declaredAt: (250 to: 265).
	(cartOwner _ [
	(Dictionary
		cover: (300 to: 309)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{311 to: 313})
		cover: (287 to: 295)
		declaredAt: (287 to: 295).
	(salesBook _ [
	(OrderedCollection
		cover: (330 to: 346)
		declaredAt: (330 to: 346)) new ] valueCoveringAll:
		{348 to: 350})
		cover: (317 to: 325)
		declaredAt: (317 to: 325).
	(cashier _ [
	(Cashier
		cover: (365 to: 371)
		declaredAt: (365 to: 371))
		with:
			(priceList
				cover: (379 to: 387)
				declaredAt: (198 to: 206))
		registerSalesOn:
			(salesBook
				cover: (406 to: 414)
				declaredAt: (317 to: 325))
		merchantProcessor:
			(aMerchantProcessor
				cover: (435 to: 452)
				declaredAt: (112 to: 129)) ] valueCoveringAll:
		{373 to: 377. 389 to: 404. 416 to: 433})
		cover: (354 to: 360)
		declaredAt: (354 to: 360).
	(currentCartID _ 0 coverAll:
		{474 to: 474})
		cover: (457 to: 469)
		declaredAt: (457 to: 469).! !
!Behavior method!
createCartFor: userID authenticatedWith: aPassword
	| cartID |
	[
	(clientAuthenticator
		cover: (63 to: 81)
		declaredAt: (63 to: 81))
		authenticateUser:
			(userID
				cover: (101 to: 106)
				declaredAt: (16 to: 21))
		withPassword:
			(aPassword
				cover: (122 to: 130)
				declaredAt: (42 to: 50)) ] valueCoveringAll:
		{83 to: 99. 108 to: 120}.
	(cartID _ [
	(self coverAll:
		{147 to: 150}) nextFreeCartID ] valueCoveringAll:
		{152 to: 165})
		cover: (137 to: 142)
		declaredAt: (54 to: 59).
	[
	(carts
		cover: (169 to: 173)
		declaredAt: (169 to: 173)) add:
		([
		(cartID
			cover: (180 to: 185)
			declaredAt: (54 to: 59)) ->
			([
			(Cart
				cover: (191 to: 194)
				declaredAt: (191 to: 194)) acceptingItemsOf:
				([
				(self coverAll:
					{214 to: 217}) itemCatalog ] valueCoveringAll:
					{219 to: 229}) ] valueCoveringAll:
				{196 to: 212}) ] valueCoveringAll:
			{187 to: 188}) ] valueCoveringAll:
		{175 to: 178}.
	[
	(cartOwner
		cover: (234 to: 242)
		declaredAt: (234 to: 242)) add:
		([
		(cartID
			cover: (249 to: 254)
			declaredAt: (54 to: 59)) ->
			(userID
				cover: (259 to: 264)
				declaredAt: (16 to: 21)) ] valueCoveringAll:
			{256 to: 257}) ] valueCoveringAll:
		{244 to: 247}.
	[
	(self coverAll:
		{270 to: 273}) updateLastTimeUsedFor:
		(cartID
			cover: (298 to: 303)
			declaredAt: (54 to: 59)) ] valueCoveringAll:
		{275 to: 296}.
	^ cartID
		cover: (309 to: 314)
		declaredAt: (54 to: 59).! !
!Behavior method!
authenticateUser: aSmallInteger withPassword: aString
	[
	(authenticationErrorMessage
		cover: (57 to: 82)
		declaredAt: (57 to: 82)) ifNotNil: [
		[
		(self coverAll:
			{95 to: 98}) error:
			(authenticationErrorMessage
				cover: (107 to: 132)
				declaredAt: (57 to: 82)) ] valueCoveringAll:
			{100 to: 105} ]] valueCoveringAll:
		{84 to: 92}.! !
!Behavior method!
hasCarts
	^ [
	([
	(carts
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}) not ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
with: aDateTime
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) initializeWith:
		(aDateTime
			cover: (45 to: 53)
			declaredAt: (7 to: 15)) ] valueCoveringAll:
		{29 to: 43}.! !
!Behavior method!
initializeWith: aDateTime
	(dateTime _ aDateTime
		cover: (40 to: 48)
		declaredAt: (17 to: 25))
		cover: (28 to: 35)
		declaredAt: (28 to: 35).! !
!Behavior method!
nextFreeCartID
	(currentCartID _ [
	(currentCartID
		cover: (19 to: 31)
		declaredAt: (19 to: 31)) +
		(1 coverAll:
			{52 to: 52}) ] valueCoveringAll:
		{50 to: 50})
		cover: (36 to: 48)
		declaredAt: (19 to: 31).
	^ currentCartID
		cover: (59 to: 71)
		declaredAt: (19 to: 31).! !
!Behavior method!
itemCatalog
	^ [
	(priceList
		cover: (17 to: 25)
		declaredAt: (17 to: 25)) keys ] valueCoveringAll:
		{27 to: 30}.! !
!Behavior method!
updateLastTimeUsedFor: cartID
	^ [
	(lastTimeCartUsed
		cover: (35 to: 50)
		declaredAt: (35 to: 50))
		at:
			(cartID
				cover: (56 to: 61)
				declaredAt: (24 to: 29))
		put:
			([
			(clock
				cover: (68 to: 72)
				declaredAt: (68 to: 72)) now ] valueCoveringAll:
				{74 to: 76}) ] valueCoveringAll:
		{52 to: 54. 63 to: 66}.! !
!Behavior method!
now
	^ dateTime
		cover: (8 to: 15)
		declaredAt: (8 to: 15).! !
!Behavior method!
hasCartIdentified: aCartId
	[
	(carts
		cover: (33 to: 37)
		declaredAt: (33 to: 37))
		at:
			(aCartId
				cover: (43 to: 49)
				declaredAt: (20 to: 26))
		ifAbsent: [ ^ false coverAll:
				{64 to: 68} ]] valueCoveringAll:
		{39 to: 41. 51 to: 59}.
	[
	([
	(self coverAll:
		{74 to: 77}) expiredCart:
		(aCartId
			cover: (92 to: 98)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{79 to: 90}) ifTrue: [
		[
		(self coverAll:
			{113 to: 116}) invalidateCartId:
			(aCartId
				cover: (136 to: 142)
				declaredAt: (20 to: 26)) ] valueCoveringAll:
			{118 to: 134}.
		^ false coverAll:
			{149 to: 153} ]] valueCoveringAll:
		{104 to: 110}.
	^ true coverAll:
		{159 to: 162}.! !
!Behavior method!
expiredCart: aCartId
	^ [
	([
	([
	(lastTimeCartUsed
		cover: (28 to: 43)
		declaredAt: (28 to: 43)) at:
		(aCartId
			cover: (49 to: 55)
			declaredAt: (14 to: 20)) ] valueCoveringAll:
		{45 to: 47}) next:
		([
		([
		(TimeUnits
			cover: (65 to: 73)
			declaredAt: (65 to: 73)) minute ] valueCoveringAll:
			{75 to: 80}) with:
			([
			(self coverAll:
				{88 to: 91}) maxInactiveTimeInMinutes ] valueCoveringAll:
				{93 to: 116}) ] valueCoveringAll:
			{82 to: 86}) ] valueCoveringAll:
		{58 to: 62}) <
		([
		(clock
			cover: (122 to: 126)
			declaredAt: (122 to: 126)) now ] valueCoveringAll:
			{128 to: 130}) ] valueCoveringAll:
		{120 to: 120}.! !
!Behavior method!
maxInactiveTimeInMinutes
	^ 30 coverAll:
		{30 to: 31}.! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
listCart: cartID
	| cartList |
	[
	(self coverAll:
		{35 to: 38}) assertCartIDIsValid:
		(cartID
			cover: (61 to: 66)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{40 to: 59}.
	(cartList _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (72 to: 79)
		declaredAt: (23 to: 30).
	[
	([
	(carts
		cover: (109 to: 113)
		declaredAt: (109 to: 113)) at:
		(cartID
			cover: (119 to: 124)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{115 to: 117}) do: [ :anItem |
		[
		(cartList
			cover: (142 to: 149)
			declaredAt: (23 to: 30)) add:
			(anItem
				cover: (156 to: 161)
				declaredAt: (133 to: 138)) ] valueCoveringAll:
			{151 to: 154} ]] valueCoveringAll:
		{127 to: 129}.
	[
	(self coverAll:
		{168 to: 171}) updateLastTimeUsedFor:
		(cartID
			cover: (196 to: 201)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{173 to: 194}.
	^ cartList
		cover: (209 to: 216)
		declaredAt: (23 to: 30).! !
!Behavior method!
assertCartIDIsValid: cartID
	[
	([
	(self coverAll:
		{33 to: 36}) hasCartIdentified:
		(cartID
			cover: (57 to: 62)
			declaredAt: (22 to: 27)) ] valueCoveringAll:
		{38 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) invalidCartIDErrorDescription ] valueCoveringAll:
				{99 to: 127}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
invalidCartIDErrorDescription
	^ 'Cart ID is not in the system' coverAll:
		{33 to: 62}.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
addMinutes: anAmountOfMinutes
	(dateTime _ [
	(dateTime
		cover: (32 to: 39)
		declaredAt: (32 to: 39)) next:
		([
		([
		(TimeUnits
			cover: (60 to: 68)
			declaredAt: (60 to: 68)) minute ] valueCoveringAll:
			{70 to: 75}) with:
			(anAmountOfMinutes
				cover: (83 to: 99)
				declaredAt: (13 to: 29)) ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{53 to: 57})
		cover: (44 to: 51)
		declaredAt: (32 to: 39).! !
!Behavior method!
invalidateCartId: aCartID
	[
	(carts
		cover: (28 to: 32)
		declaredAt: (28 to: 32)) removeKey:
		(aCartID
			cover: (45 to: 51)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{34 to: 43}.
	[
	(lastTimeCartUsed
		cover: (55 to: 70)
		declaredAt: (55 to: 70)) removeKey:
		(aCartID
			cover: (83 to: 89)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{72 to: 81}.
	[
	(cartOwner
		cover: (93 to: 101)
		declaredAt: (93 to: 101)) removeKey:
		(aCartID
			cover: (114 to: 120)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{103 to: 112}.! !

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
addToCart: aCartID item: anItem quantity: aQuantity
	[
	(self coverAll:
		{55 to: 58}) assertCartIDIsValid:
		(aCartID
			cover: (81 to: 87)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{60 to: 79}.
	[
	([
	(carts
		cover: (94 to: 98)
		declaredAt: (94 to: 98)) at:
		(aCartID
			cover: (104 to: 110)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{100 to: 102})
		add:
			(aQuantity
				cover: (118 to: 126)
				declaredAt: (43 to: 51))
		of:
			(anItem
				cover: (132 to: 137)
				declaredAt: (26 to: 31)) ] valueCoveringAll:
		{113 to: 116. 128 to: 130}.
	[
	(self coverAll:
		{142 to: 145}) updateLastTimeUsedFor:
		(aCartID
			cover: (170 to: 176)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{147 to: 168}.! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
listPurchasesOf: aUserId password: aPassword
	[
	(clientAuthenticator
		cover: (49 to: 67)
		declaredAt: (49 to: 67))
		authenticateUser:
			(aUserId
				cover: (87 to: 93)
				declaredAt: (18 to: 24))
		withPassword:
			(aPassword
				cover: (109 to: 117)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{69 to: 85. 95 to: 107}.
	^ [
	(self coverAll:
		{126 to: 129}) purchaseListFor:
		(aUserId
			cover: (148 to: 154)
			declaredAt: (18 to: 24)) ] valueCoveringAll:
		{131 to: 146}.! !
!Behavior method!
purchaseListFor: aUserID
	| userIDSales items totalAmount |
	(userIDSales _ [
	(salesBook
		cover: (76 to: 84)
		declaredAt: (76 to: 84)) select: [ :aSales |
		[
		([
		(aSales
			cover: (105 to: 110)
			declaredAt: (96 to: 101)) userID ] valueCoveringAll:
			{112 to: 117}) =
			(aUserID
				cover: (121 to: 127)
				declaredAt: (18 to: 24)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{86 to: 92})
		cover: (61 to: 71)
		declaredAt: (28 to: 38).
	(items _ [
	(OrderedCollection
		cover: (141 to: 157)
		declaredAt: (141 to: 157)) new ] valueCoveringAll:
		{159 to: 161})
		cover: (132 to: 136)
		declaredAt: (40 to: 44).
	[
	(userIDSales
		cover: (165 to: 175)
		declaredAt: (28 to: 38)) do: [ :aSales |
		[
		(items
			cover: (192 to: 196)
			declaredAt: (40 to: 44)) addAll:
			([
			(aSales
				cover: (206 to: 211)
				declaredAt: (183 to: 188)) items ] valueCoveringAll:
				{213 to: 217}) ] valueCoveringAll:
			{198 to: 204} ]] valueCoveringAll:
		{177 to: 179}.
	(totalAmount _ [
	(userIDSales
		cover: (237 to: 247)
		declaredAt: (28 to: 38))
		sum: [ :aSales |
			[
			(aSales
				cover: (265 to: 270)
				declaredAt: (256 to: 261)) totalAmount ] valueCoveringAll:
				{272 to: 282} ]
		ifEmpty:
			(0 coverAll:
				{294 to: 294}) ] valueCoveringAll:
		{249 to: 252. 285 to: 292})
		cover: (222 to: 232)
		declaredAt: (46 to: 56).
	^ [
	(PurchaseList
		cover: (299 to: 310)
		declaredAt: (299 to: 310))
		withItems:
			(items
				cover: (323 to: 327)
				declaredAt: (40 to: 44))
		totalAmount:
			(totalAmount
				cover: (342 to: 352)
				declaredAt: (46 to: 56)) ] valueCoveringAll:
		{312 to: 321. 329 to: 340}.! !
!Behavior method!
withItems: anItemList totalAmount: anAmount
	self coverAll:
		{49 to: 52}.
	^ [
	([ self new ] valueCoveringAll:
		{54 to: 56})
		initializeWithItems:
			(anItemList
				cover: (79 to: 88)
				declaredAt: (12 to: 21))
		totalAmount:
			(anAmount
				cover: (103 to: 110)
				declaredAt: (36 to: 43)) ] valueCoveringAll:
		{58 to: 77. 90 to: 101}.! !
!Behavior method!
initializeWithItems: anItemList totalAmount: anAmount
	(itemList _ anItemList
		cover: (69 to: 78)
		declaredAt: (22 to: 31))
		cover: (57 to: 64)
		declaredAt: (57 to: 64).
	(amount _ anAmount
		cover: (92 to: 99)
		declaredAt: (46 to: 53))
		cover: (82 to: 87)
		declaredAt: (82 to: 87).! !
!Behavior method!
isEmpty
	^ [
	(itemList
		cover: (12 to: 19)
		declaredAt: (12 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:41:30'!
PASSED!
!Behavior method!
checkoutCart: aCartId creditCard: aCreditCard
	| userID |
	[
	(self coverAll:
		{61 to: 64}) assertCartIDIsValid:
		(aCartId
			cover: (87 to: 93)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{66 to: 85}.
	[
	(cashier
		cover: (99 to: 105)
		declaredAt: (99 to: 105))
		checkout:
			([
			(carts
				cover: (118 to: 122)
				declaredAt: (118 to: 122)) at:
				(aCartId
					cover: (128 to: 134)
					declaredAt: (15 to: 21)) ] valueCoveringAll:
				{124 to: 126})
		withCreditCard:
			(aCreditCard
				cover: (153 to: 163)
				declaredAt: (35 to: 45)) ] valueCoveringAll:
		{107 to: 115. 137 to: 151}.
	(userID _ [
	(cartOwner
		cover: (177 to: 185)
		declaredAt: (177 to: 185)) at:
		(aCartId
			cover: (191 to: 197)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{187 to: 189})
		cover: (167 to: 172)
		declaredAt: (51 to: 56).
	[
	([
	(salesBook
		cover: (202 to: 210)
		declaredAt: (202 to: 210)) last ] valueCoveringAll:
		{212 to: 215}) userID:
		(userID
			cover: (225 to: 230)
			declaredAt: (51 to: 56)) ] valueCoveringAll:
		{217 to: 223}.
	[
	(self coverAll:
		{236 to: 239}) invalidateCartId:
		(aCartId
			cover: (259 to: 265)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{241 to: 257}.
	^ [
	(salesBook
		cover: (271 to: 279)
		declaredAt: (202 to: 210)) size ] valueCoveringAll:
		{281 to: 284}.! !
!Behavior method!
userID: aUserID
	(userID _ aUserID
		cover: (28 to: 34)
		declaredAt: (9 to: 15))
		cover: (18 to: 23)
		declaredAt: (18 to: 23).! !
!Behavior method!
userID
	^ userID
		cover: (10 to: 15)
		declaredAt: (10 to: 15).! !
!Behavior method!
list
	^ [
	(itemList
		cover: (9 to: 16)
		declaredAt: (9 to: 16)) copy ] valueCoveringAll:
		{18 to: 21}.! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:41:30'!
PASSED!

!methodRemoval: PurchaseList class #withItems:AndPriceList: stamp: 'JA 6/24/2021 09:41:48'!
withItems: anItemList AndPriceList: aPriceList
	^ self new initializeWithItems: anItemList andPriceList: aPriceList .!

!methodRemoval: PurchaseList #initializeWithItems:andPriceList: stamp: 'JA 6/24/2021 09:41:53'!
initializeWithItems: anItemList andPriceList: aPriceList 
	
	itemList := anItemList.
	priceList := aPriceList.!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:41:59'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:41:59'!
PASSED!
!Behavior method!
defaultCatalog
	^ [
	(Array
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) with:
		([
		(self coverAll:
			{33 to: 36}) itemSellByTheStore ] valueCoveringAll:
			{38 to: 55}) ] valueCoveringAll:
		{27 to: 31}.! !
!Behavior method!
itemSellByTheStore
	^ 'validBook' coverAll:
		{25 to: 35}.! !
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/24/2021 09:42:05'!
PASSED!
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWith:
			(aPriceList
				cover: (112 to: 121)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (140 to: 149)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessor
				cover: (170 to: 187)
				declaredAt: (65 to: 82)) ] valueCoveringAll:
		{96 to: 110. 123 to: 138. 151 to: 168}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	(priceList _ aPriceList
		cover: (111 to: 120)
		declaredAt: (17 to: 26))
		cover: (98 to: 106)
		declaredAt: (98 to: 106).
	(salesBook _ aSalesBook
		cover: (137 to: 146)
		declaredAt: (45 to: 54))
		cover: (124 to: 132)
		declaredAt: (124 to: 132).
	(merchantProcessor _ aMerchantProcessor
		cover: (171 to: 188)
		declaredAt: (75 to: 92))
		cover: (150 to: 166)
		declaredAt: (150 to: 166).! !
!Behavior method!
validCreditCard
	^ [
	(CreditCard
		cover: (21 to: 30)
		declaredAt: (21 to: 30))
		owner:
			('owner' coverAll:
				{39 to: 45})
		number:
			('1234567891011121' coverAll:
				{55 to: 72})
		expiration:
			([
			([
			(GregorianMonthOfYear
				cover: (86 to: 105)
				declaredAt: (86 to: 105)) current ] valueCoveringAll:
				{107 to: 113}) next ] valueCoveringAll:
				{115 to: 118}) ] valueCoveringAll:
		{32 to: 37. 47 to: 53. 74 to: 84}.! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{89 to: 121}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (128 to: 134)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (159 to: 164)
			declaredAt: (150 to: 155)) isDigit ] valueCoveringAll:
			{166 to: 172} ]] valueCoveringAll:
		{136 to: 146}) ifFalse: [
		[
		(self coverAll:
			{187 to: 190}) error:
			([
			(self coverAll:
				{199 to: 202}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{204 to: 236}) ] valueCoveringAll:
			{192 to: 197} ]] valueCoveringAll:
		{177 to: 184}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{103 to: 135}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(expirationMonthOfYear _ aGregorianMonthOfYear
		cover: (209 to: 229)
		declaredAt: (76 to: 96))
		cover: (184 to: 204)
		declaredAt: (184 to: 204).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice items sales |
	[
	(self coverAll:
		{73 to: 76}) assertCartIsNotEmpty:
		(aCart
			cover: (100 to: 104)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{78 to: 98}.
	[
	(self coverAll:
		{108 to: 111}) assertCreditCardIsNotExpired:
		(aCreditCard
			cover: (143 to: 153)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{113 to: 141}.
	(totalPrice _ 0 coverAll:
		{171 to: 171})
		cover: (157 to: 166)
		declaredAt: (48 to: 57).
	(items _ [
	(OrderedCollection
		cover: (184 to: 200)
		declaredAt: (184 to: 200)) new ] valueCoveringAll:
		{202 to: 204})
		cover: (175 to: 179)
		declaredAt: (59 to: 63).
	[
	(aCart
		cover: (208 to: 212)
		declaredAt: (11 to: 15)) do: [ :anItem |
		(totalPrice _ [
		([
		(totalPrice
			cover: (229 to: 238)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (256 to: 264)
				declaredAt: (256 to: 264)) ] valueCoveringAll:
			{254 to: 254})
			at:
				(anItem
					cover: (270 to: 275)
					declaredAt: (220 to: 225))
			ifAbsent: [
				[
				(self coverAll:
					{288 to: 291}) raiseItemNotInPriceListError ] valueCoveringAll:
					{293 to: 320} ]] valueCoveringAll:
			{266 to: 268. 277 to: 285})
			cover: (243 to: 252)
			declaredAt: (48 to: 57).
		[
		(items
			cover: (326 to: 330)
			declaredAt: (59 to: 63)) add:
			(anItem
				cover: (337 to: 342)
				declaredAt: (220 to: 225)) ] valueCoveringAll:
			{332 to: 335} ]] valueCoveringAll:
		{214 to: 216}.
	[
	(merchantProcessor
		cover: (347 to: 363)
		declaredAt: (347 to: 363))
		charge:
			(totalPrice
				cover: (373 to: 382)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (389 to: 399)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{365 to: 371. 385 to: 387}.
	(sales _ [
	(Sales
		cover: (413 to: 417)
		declaredAt: (413 to: 417))
		withItems:
			(items
				cover: (430 to: 434)
				declaredAt: (59 to: 63))
		totalAmount:
			(totalPrice
				cover: (449 to: 458)
				declaredAt: (48 to: 57)) ] valueCoveringAll:
		{419 to: 428. 436 to: 447})
		cover: (404 to: 408)
		declaredAt: (65 to: 69).
	[
	(salesBook
		cover: (462 to: 470)
		declaredAt: (462 to: 470)) add:
		(sales
			cover: (477 to: 481)
			declaredAt: (65 to: 69)) ] valueCoveringAll:
		{472 to: 475}.
	^ sales
		cover: (486 to: 490)
		declaredAt: (65 to: 69).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) emptyCartErrorDescription ] valueCoveringAll:
				{80 to: 104}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
emptyCartErrorDescription
	^ 'The cart is empty' coverAll:
		{29 to: 47}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
assertCreditCardIsNotExpired: aCreditCard
	[
	([
	(aCreditCard
		cover: (47 to: 57)
		declaredAt: (31 to: 41)) isExpiredOn:
		([
		(Date
			cover: (72 to: 75)
			declaredAt: (72 to: 75)) today ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{59 to: 70}) ifTrue: [
		[
		(self coverAll:
			{93 to: 96}) error:
			([
			([
			(self coverAll:
				{105 to: 108}) class ] valueCoveringAll:
				{110 to: 114}) expiredCreditCardErrorDescription ] valueCoveringAll:
				{116 to: 148}) ] valueCoveringAll:
			{98 to: 103} ]] valueCoveringAll:
		{84 to: 90}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	([
	(GregorianMonthOfYear
		cover: (26 to: 45)
		declaredAt: (26 to: 45))
		yearNumber:
			([
			(aDate
				cover: (59 to: 63)
				declaredAt: (14 to: 18)) yearNumber ] valueCoveringAll:
				{65 to: 74})
		monthNumber:
			([
			(aDate
				cover: (89 to: 93)
				declaredAt: (14 to: 18)) monthIndex ] valueCoveringAll:
				{95 to: 104}) ] valueCoveringAll:
		{47 to: 57. 76 to: 87}) >
		(expirationMonthOfYear
			cover: (109 to: 129)
			declaredAt: (109 to: 129)) ] valueCoveringAll:
		{107 to: 107}.! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
raiseItemNotInPriceListError
	^ [
	(self coverAll:
		{34 to: 37}) error:
		([
		([
		(self coverAll:
			{46 to: 49}) class ] valueCoveringAll:
			{51 to: 55}) itemNotInPriceListErrorDescription ] valueCoveringAll:
			{57 to: 90}) ] valueCoveringAll:
		{39 to: 44}.! !
!Behavior method!
itemNotInPriceListErrorDescription
	^ 'An item in the cart is not in the price list' coverAll:
		{38 to: 83}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !
!Behavior method!
withItems: items totalAmount: anAmount
	^ [
	([
	(self coverAll:
		{43 to: 46}) new ] valueCoveringAll:
		{48 to: 50})
		initializeWithItems:
			(items
				cover: (73 to: 77)
				declaredAt: (12 to: 16))
		totalAmount:
			(anAmount
				cover: (92 to: 99)
				declaredAt: (31 to: 38)) ] valueCoveringAll:
		{52 to: 71. 79 to: 90}.! !
!Behavior method!
initializeWithItems: aCollectionOfItems totalAmount: anAmount
	(items _ aCollectionOfItems
		cover: (75 to: 92)
		declaredAt: (22 to: 39))
		cover: (66 to: 70)
		declaredAt: (66 to: 70).
	(amount _ anAmount
		cover: (106 to: 113)
		declaredAt: (54 to: 61))
		cover: (96 to: 101)
		declaredAt: (96 to: 101).! !
!Behavior method!
items
	^ items
		cover: (9 to: 13)
		declaredAt: (9 to: 13).! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
expiredCreditCardErrorDescription
	^ 'The credit card is expired' coverAll:
		{37 to: 64}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
invalidCreditCardErrorDescription
	^ 'Los datos de la tarjeta de crdito son invlidos' coverAll:
		{37 to: 86}.! !

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
raiseAuthenticationErrorWithMessage: anErrorMessage
	(authenticationErrorMessage _ anErrorMessage
		cover: (84 to: 97)
		declaredAt: (38 to: 51))
		cover: (54 to: 79)
		declaredAt: (54 to: 79).! !
!Behavior method!
defaultPriceList
	^ [
	(Dictionary
		cover: (21 to: 30)
		declaredAt: (21 to: 30)) with:
		([
		([
		(self coverAll:
			{38 to: 41}) itemSellByTheStore ] valueCoveringAll:
			{43 to: 60}) ->
			([
			(self coverAll:
				{65 to: 68}) itemInStorePrice ] valueCoveringAll:
				{70 to: 85}) ] valueCoveringAll:
			{62 to: 63}) ] valueCoveringAll:
		{32 to: 36}.! !
!Behavior method!
itemInStorePrice
	^ 10 coverAll:
		{21 to: 22}.! !
!Behavior method!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{126 to: 129}) new ] valueCoveringAll:
		{131 to: 133})
		initializeWithClientAuthenticator:
			(aClientAuthenticator
				cover: (170 to: 189)
				declaredAt: (26 to: 45))
		clock:
			(aClock
				cover: (198 to: 203)
				declaredAt: (54 to: 59))
		priceList:
			(priceList
				cover: (216 to: 224)
				declaredAt: (72 to: 80))
		merchantProcessor:
			(aMerchantProcessor
				cover: (245 to: 262)
				declaredAt: (101 to: 118)) ] valueCoveringAll:
		{135 to: 168. 191 to: 196. 205 to: 214. 226 to: 243}.! !
!Behavior method!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList merchantProcessor: aMerchantProcessor
	(clientAuthenticator _ aClientAuthenticator
		cover: (157 to: 176)
		declaredAt: (36 to: 55))
		cover: (134 to: 152)
		declaredAt: (134 to: 152).
	(clock _ aClock
		cover: (189 to: 194)
		declaredAt: (64 to: 69))
		cover: (180 to: 184)
		declaredAt: (180 to: 184).
	(priceList _ aPriceList
		cover: (211 to: 220)
		declaredAt: (82 to: 91))
		cover: (198 to: 206)
		declaredAt: (198 to: 206).
	(carts _ [
	(Dictionary
		cover: (233 to: 242)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{244 to: 246})
		cover: (224 to: 228)
		declaredAt: (224 to: 228).
	(lastTimeCartUsed _ [
	(Dictionary
		cover: (270 to: 279)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{281 to: 283})
		cover: (250 to: 265)
		declaredAt: (250 to: 265).
	(cartOwner _ [
	(Dictionary
		cover: (300 to: 309)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{311 to: 313})
		cover: (287 to: 295)
		declaredAt: (287 to: 295).
	(salesBook _ [
	(OrderedCollection
		cover: (330 to: 346)
		declaredAt: (330 to: 346)) new ] valueCoveringAll:
		{348 to: 350})
		cover: (317 to: 325)
		declaredAt: (317 to: 325).
	(cashier _ [
	(Cashier
		cover: (365 to: 371)
		declaredAt: (365 to: 371))
		with:
			(priceList
				cover: (379 to: 387)
				declaredAt: (198 to: 206))
		registerSalesOn:
			(salesBook
				cover: (406 to: 414)
				declaredAt: (317 to: 325))
		merchantProcessor:
			(aMerchantProcessor
				cover: (435 to: 452)
				declaredAt: (112 to: 129)) ] valueCoveringAll:
		{373 to: 377. 389 to: 404. 416 to: 433})
		cover: (354 to: 360)
		declaredAt: (354 to: 360).
	(currentCartID _ 0 coverAll:
		{474 to: 474})
		cover: (457 to: 469)
		declaredAt: (457 to: 469).! !
!Behavior method!
createCartFor: userID authenticatedWith: aPassword
	| cartID |
	[
	(clientAuthenticator
		cover: (63 to: 81)
		declaredAt: (63 to: 81))
		authenticateUser:
			(userID
				cover: (101 to: 106)
				declaredAt: (16 to: 21))
		withPassword:
			(aPassword
				cover: (122 to: 130)
				declaredAt: (42 to: 50)) ] valueCoveringAll:
		{83 to: 99. 108 to: 120}.
	(cartID _ [
	(self coverAll:
		{147 to: 150}) nextFreeCartID ] valueCoveringAll:
		{152 to: 165})
		cover: (137 to: 142)
		declaredAt: (54 to: 59).
	[
	(carts
		cover: (169 to: 173)
		declaredAt: (169 to: 173)) add:
		([
		(cartID
			cover: (180 to: 185)
			declaredAt: (54 to: 59)) ->
			([
			(Cart
				cover: (191 to: 194)
				declaredAt: (191 to: 194)) acceptingItemsOf:
				([
				(self coverAll:
					{214 to: 217}) itemCatalog ] valueCoveringAll:
					{219 to: 229}) ] valueCoveringAll:
				{196 to: 212}) ] valueCoveringAll:
			{187 to: 188}) ] valueCoveringAll:
		{175 to: 178}.
	[
	(cartOwner
		cover: (234 to: 242)
		declaredAt: (234 to: 242)) add:
		([
		(cartID
			cover: (249 to: 254)
			declaredAt: (54 to: 59)) ->
			(userID
				cover: (259 to: 264)
				declaredAt: (16 to: 21)) ] valueCoveringAll:
			{256 to: 257}) ] valueCoveringAll:
		{244 to: 247}.
	[
	(self coverAll:
		{270 to: 273}) updateLastTimeUsedFor:
		(cartID
			cover: (298 to: 303)
			declaredAt: (54 to: 59)) ] valueCoveringAll:
		{275 to: 296}.
	^ cartID
		cover: (309 to: 314)
		declaredAt: (54 to: 59).! !
!Behavior method!
authenticateUser: aSmallInteger withPassword: aString
	[
	(authenticationErrorMessage
		cover: (57 to: 82)
		declaredAt: (57 to: 82)) ifNotNil: [
		[
		(self coverAll:
			{95 to: 98}) error:
			(authenticationErrorMessage
				cover: (107 to: 132)
				declaredAt: (57 to: 82)) ] valueCoveringAll:
			{100 to: 105} ]] valueCoveringAll:
		{84 to: 92}.! !
!Behavior method!
hasCarts
	^ [
	([
	(carts
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}) not ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
with: aDateTime
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) initializeWith:
		(aDateTime
			cover: (45 to: 53)
			declaredAt: (7 to: 15)) ] valueCoveringAll:
		{29 to: 43}.! !
!Behavior method!
initializeWith: aDateTime
	(dateTime _ aDateTime
		cover: (40 to: 48)
		declaredAt: (17 to: 25))
		cover: (28 to: 35)
		declaredAt: (28 to: 35).! !
!Behavior method!
nextFreeCartID
	(currentCartID _ [
	(currentCartID
		cover: (19 to: 31)
		declaredAt: (19 to: 31)) +
		(1 coverAll:
			{52 to: 52}) ] valueCoveringAll:
		{50 to: 50})
		cover: (36 to: 48)
		declaredAt: (19 to: 31).
	^ currentCartID
		cover: (59 to: 71)
		declaredAt: (19 to: 31).! !
!Behavior method!
itemCatalog
	^ [
	(priceList
		cover: (17 to: 25)
		declaredAt: (17 to: 25)) keys ] valueCoveringAll:
		{27 to: 30}.! !
!Behavior method!
updateLastTimeUsedFor: cartID
	^ [
	(lastTimeCartUsed
		cover: (35 to: 50)
		declaredAt: (35 to: 50))
		at:
			(cartID
				cover: (56 to: 61)
				declaredAt: (24 to: 29))
		put:
			([
			(clock
				cover: (68 to: 72)
				declaredAt: (68 to: 72)) now ] valueCoveringAll:
				{74 to: 76}) ] valueCoveringAll:
		{52 to: 54. 63 to: 66}.! !
!Behavior method!
now
	^ dateTime
		cover: (8 to: 15)
		declaredAt: (8 to: 15).! !
!Behavior method!
hasCartIdentified: aCartId
	[
	(carts
		cover: (33 to: 37)
		declaredAt: (33 to: 37))
		at:
			(aCartId
				cover: (43 to: 49)
				declaredAt: (20 to: 26))
		ifAbsent: [ ^ false coverAll:
				{64 to: 68} ]] valueCoveringAll:
		{39 to: 41. 51 to: 59}.
	[
	([
	(self coverAll:
		{74 to: 77}) expiredCart:
		(aCartId
			cover: (92 to: 98)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{79 to: 90}) ifTrue: [
		[
		(self coverAll:
			{113 to: 116}) invalidateCartId:
			(aCartId
				cover: (136 to: 142)
				declaredAt: (20 to: 26)) ] valueCoveringAll:
			{118 to: 134}.
		^ false coverAll:
			{149 to: 153} ]] valueCoveringAll:
		{104 to: 110}.
	^ true coverAll:
		{159 to: 162}.! !
!Behavior method!
expiredCart: aCartId
	^ [
	([
	([
	(lastTimeCartUsed
		cover: (28 to: 43)
		declaredAt: (28 to: 43)) at:
		(aCartId
			cover: (49 to: 55)
			declaredAt: (14 to: 20)) ] valueCoveringAll:
		{45 to: 47}) next:
		([
		([
		(TimeUnits
			cover: (65 to: 73)
			declaredAt: (65 to: 73)) minute ] valueCoveringAll:
			{75 to: 80}) with:
			([
			(self coverAll:
				{88 to: 91}) maxInactiveTimeInMinutes ] valueCoveringAll:
				{93 to: 116}) ] valueCoveringAll:
			{82 to: 86}) ] valueCoveringAll:
		{58 to: 62}) <
		([
		(clock
			cover: (122 to: 126)
			declaredAt: (122 to: 126)) now ] valueCoveringAll:
			{128 to: 130}) ] valueCoveringAll:
		{120 to: 120}.! !
!Behavior method!
maxInactiveTimeInMinutes
	^ 30 coverAll:
		{30 to: 31}.! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
listCart: cartID
	| cartList |
	[
	(self coverAll:
		{35 to: 38}) assertCartIDIsValid:
		(cartID
			cover: (61 to: 66)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{40 to: 59}.
	(cartList _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (72 to: 79)
		declaredAt: (23 to: 30).
	[
	([
	(carts
		cover: (109 to: 113)
		declaredAt: (109 to: 113)) at:
		(cartID
			cover: (119 to: 124)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{115 to: 117}) do: [ :anItem |
		[
		(cartList
			cover: (142 to: 149)
			declaredAt: (23 to: 30)) add:
			(anItem
				cover: (156 to: 161)
				declaredAt: (133 to: 138)) ] valueCoveringAll:
			{151 to: 154} ]] valueCoveringAll:
		{127 to: 129}.
	[
	(self coverAll:
		{168 to: 171}) updateLastTimeUsedFor:
		(cartID
			cover: (196 to: 201)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{173 to: 194}.
	^ cartList
		cover: (209 to: 216)
		declaredAt: (23 to: 30).! !
!Behavior method!
assertCartIDIsValid: cartID
	[
	([
	(self coverAll:
		{33 to: 36}) hasCartIdentified:
		(cartID
			cover: (57 to: 62)
			declaredAt: (22 to: 27)) ] valueCoveringAll:
		{38 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) invalidCartIDErrorDescription ] valueCoveringAll:
				{99 to: 127}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
invalidCartIDErrorDescription
	^ 'Cart ID is not in the system' coverAll:
		{33 to: 62}.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
addMinutes: anAmountOfMinutes
	(dateTime _ [
	(dateTime
		cover: (32 to: 39)
		declaredAt: (32 to: 39)) next:
		([
		([
		(TimeUnits
			cover: (60 to: 68)
			declaredAt: (60 to: 68)) minute ] valueCoveringAll:
			{70 to: 75}) with:
			(anAmountOfMinutes
				cover: (83 to: 99)
				declaredAt: (13 to: 29)) ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{53 to: 57})
		cover: (44 to: 51)
		declaredAt: (32 to: 39).! !
!Behavior method!
invalidateCartId: aCartID
	[
	(carts
		cover: (28 to: 32)
		declaredAt: (28 to: 32)) removeKey:
		(aCartID
			cover: (45 to: 51)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{34 to: 43}.
	[
	(lastTimeCartUsed
		cover: (55 to: 70)
		declaredAt: (55 to: 70)) removeKey:
		(aCartID
			cover: (83 to: 89)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{72 to: 81}.
	[
	(cartOwner
		cover: (93 to: 101)
		declaredAt: (93 to: 101)) removeKey:
		(aCartID
			cover: (114 to: 120)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{103 to: 112}.! !

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
addToCart: aCartID item: anItem quantity: aQuantity
	[
	(self coverAll:
		{55 to: 58}) assertCartIDIsValid:
		(aCartID
			cover: (81 to: 87)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{60 to: 79}.
	[
	([
	(carts
		cover: (94 to: 98)
		declaredAt: (94 to: 98)) at:
		(aCartID
			cover: (104 to: 110)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{100 to: 102})
		add:
			(aQuantity
				cover: (118 to: 126)
				declaredAt: (43 to: 51))
		of:
			(anItem
				cover: (132 to: 137)
				declaredAt: (26 to: 31)) ] valueCoveringAll:
		{113 to: 116. 128 to: 130}.
	[
	(self coverAll:
		{142 to: 145}) updateLastTimeUsedFor:
		(aCartID
			cover: (170 to: 176)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{147 to: 168}.! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
listPurchasesOf: aUserId password: aPassword
	[
	(clientAuthenticator
		cover: (49 to: 67)
		declaredAt: (49 to: 67))
		authenticateUser:
			(aUserId
				cover: (87 to: 93)
				declaredAt: (18 to: 24))
		withPassword:
			(aPassword
				cover: (109 to: 117)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{69 to: 85. 95 to: 107}.
	^ [
	(self coverAll:
		{126 to: 129}) purchaseListFor:
		(aUserId
			cover: (148 to: 154)
			declaredAt: (18 to: 24)) ] valueCoveringAll:
		{131 to: 146}.! !
!Behavior method!
purchaseListFor: aUserID
	| userIDSales items totalAmount |
	(userIDSales _ [
	(salesBook
		cover: (76 to: 84)
		declaredAt: (76 to: 84)) select: [ :aSales |
		[
		([
		(aSales
			cover: (105 to: 110)
			declaredAt: (96 to: 101)) userID ] valueCoveringAll:
			{112 to: 117}) =
			(aUserID
				cover: (121 to: 127)
				declaredAt: (18 to: 24)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{86 to: 92})
		cover: (61 to: 71)
		declaredAt: (28 to: 38).
	(items _ [
	(OrderedCollection
		cover: (141 to: 157)
		declaredAt: (141 to: 157)) new ] valueCoveringAll:
		{159 to: 161})
		cover: (132 to: 136)
		declaredAt: (40 to: 44).
	[
	(userIDSales
		cover: (165 to: 175)
		declaredAt: (28 to: 38)) do: [ :aSales |
		[
		(items
			cover: (192 to: 196)
			declaredAt: (40 to: 44)) addAll:
			([
			(aSales
				cover: (206 to: 211)
				declaredAt: (183 to: 188)) items ] valueCoveringAll:
				{213 to: 217}) ] valueCoveringAll:
			{198 to: 204} ]] valueCoveringAll:
		{177 to: 179}.
	(totalAmount _ [
	(userIDSales
		cover: (237 to: 247)
		declaredAt: (28 to: 38))
		sum: [ :aSales |
			[
			(aSales
				cover: (265 to: 270)
				declaredAt: (256 to: 261)) totalAmount ] valueCoveringAll:
				{272 to: 282} ]
		ifEmpty:
			(0 coverAll:
				{294 to: 294}) ] valueCoveringAll:
		{249 to: 252. 285 to: 292})
		cover: (222 to: 232)
		declaredAt: (46 to: 56).
	^ [
	(PurchaseList
		cover: (299 to: 310)
		declaredAt: (299 to: 310))
		withItems:
			(items
				cover: (323 to: 327)
				declaredAt: (40 to: 44))
		totalAmount:
			(totalAmount
				cover: (342 to: 352)
				declaredAt: (46 to: 56)) ] valueCoveringAll:
		{312 to: 321. 329 to: 340}.! !
!Behavior method!
withItems: anItemList totalAmount: anAmount
	self coverAll:
		{49 to: 52}.
	^ [
	([ self new ] valueCoveringAll:
		{54 to: 56})
		initializeWithItems:
			(anItemList
				cover: (79 to: 88)
				declaredAt: (12 to: 21))
		totalAmount:
			(anAmount
				cover: (103 to: 110)
				declaredAt: (36 to: 43)) ] valueCoveringAll:
		{58 to: 77. 90 to: 101}.! !
!Behavior method!
initializeWithItems: anItemList totalAmount: anAmount
	(itemList _ anItemList
		cover: (69 to: 78)
		declaredAt: (22 to: 31))
		cover: (57 to: 64)
		declaredAt: (57 to: 64).
	(amount _ anAmount
		cover: (92 to: 99)
		declaredAt: (46 to: 53))
		cover: (82 to: 87)
		declaredAt: (82 to: 87).! !
!Behavior method!
isEmpty
	^ [
	(itemList
		cover: (12 to: 19)
		declaredAt: (12 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:42:06'!
PASSED!
!Behavior method!
checkoutCart: aCartId creditCard: aCreditCard
	| userID |
	[
	(self coverAll:
		{61 to: 64}) assertCartIDIsValid:
		(aCartId
			cover: (87 to: 93)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{66 to: 85}.
	[
	(cashier
		cover: (99 to: 105)
		declaredAt: (99 to: 105))
		checkout:
			([
			(carts
				cover: (118 to: 122)
				declaredAt: (118 to: 122)) at:
				(aCartId
					cover: (128 to: 134)
					declaredAt: (15 to: 21)) ] valueCoveringAll:
				{124 to: 126})
		withCreditCard:
			(aCreditCard
				cover: (153 to: 163)
				declaredAt: (35 to: 45)) ] valueCoveringAll:
		{107 to: 115. 137 to: 151}.
	(userID _ [
	(cartOwner
		cover: (177 to: 185)
		declaredAt: (177 to: 185)) at:
		(aCartId
			cover: (191 to: 197)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{187 to: 189})
		cover: (167 to: 172)
		declaredAt: (51 to: 56).
	[
	([
	(salesBook
		cover: (202 to: 210)
		declaredAt: (202 to: 210)) last ] valueCoveringAll:
		{212 to: 215}) userID:
		(userID
			cover: (225 to: 230)
			declaredAt: (51 to: 56)) ] valueCoveringAll:
		{217 to: 223}.
	[
	(self coverAll:
		{236 to: 239}) invalidateCartId:
		(aCartId
			cover: (259 to: 265)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{241 to: 257}.
	^ [
	(salesBook
		cover: (271 to: 279)
		declaredAt: (202 to: 210)) size ] valueCoveringAll:
		{281 to: 284}.! !
!Behavior method!
userID: aUserID
	(userID _ aUserID
		cover: (28 to: 34)
		declaredAt: (9 to: 15))
		cover: (18 to: 23)
		declaredAt: (18 to: 23).! !
!Behavior method!
userID
	^ userID
		cover: (10 to: 15)
		declaredAt: (10 to: 15).! !
!Behavior method!
list
	^ [
	(itemList
		cover: (9 to: 16)
		declaredAt: (9 to: 16)) copy ] valueCoveringAll:
		{18 to: 21}.! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:42:06'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:44:13'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'JA 6/24/2021 09:46:23'!
PASSED!

----QUIT----(24 June 2021 09:46:54) CuisUniversity-4532.image priorSource: 17168680!

----End fileIn of C:\Users\ezequ\Desktop\windows64\TusLibros.st----!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 13:19:09'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 13:19:09'!
PASSED!
!Store methodsFor: 'checkout' stamp: 'ET 6/24/2021 13:20:14' prior: 51072869!
checkoutCart: aCartId creditCard: aCreditCard 
	| userID sales|
	self assertCartIDIsValid: aCartId.
	
	sales := cashier checkout: (carts at: aCartId) withCreditCard: aCreditCard.
	userID := cartOwner at: aCartId. 
	sales userID: userID.
	
	self invalidateCartId: aCartId.

	^salesBook size.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 13:20:17'!
PASSED!

TestCase subclass: #CartTest
	instanceVariableNames: 'testObjects'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #CartTest category: 'TusLibros' stamp: 'ET 6/24/2021 13:21:27'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjects'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CartTest methodsFor: 'support' stamp: 'ET 6/24/2021 13:21:42' overrides: 16927572!
setUp
	
	testObjects := TestObjects new.! !
!CartTest methodsFor: 'support' stamp: 'ET 6/24/2021 13:21:52' prior: 51071838!
itemSellByTheStore
	
	
	^ testObjects itemSellByTheStore .! !

!methodRemoval: CartTest #itemSellByTheStore stamp: 'ET 6/24/2021 13:22:07'!
itemSellByTheStore
	
	
	^ testObjects itemSellByTheStore .!
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:22:27' prior: 51071768!
test03AfterAddingAnItemTheCartIsNotEmptyAnymore

	| cart |
	
	cart := self createCart.
	
	cart add: testObjects itemSellByTheStore.
	self deny: cart isEmpty ! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:22:33' prior: 51071776!
test04CanNotAddNonPositiveNumberOfItems

	| cart |
	
	cart := self createCart.
	
	self 
		should: [cart add: 0 of: testObjects itemSellByTheStore. ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:22:38' prior: 51071802!
test06CartRemembersAddedItems

	| cart |
	
	cart := self createCart.
	
	cart add: testObjects itemSellByTheStore.
	self assert: (cart includes: self itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:22:45' prior: 51073194!
test06CartRemembersAddedItems

	| cart |
	
	cart := self createCart.
	
	cart add: testObjects itemSellByTheStore.
	self assert: (cart includes: testObjects itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:22:53' prior: 51071810!
test07CartDoesNotHoldNotAddedItems

	| cart |
	
	cart := self createCart.
	
	self deny: (cart includes: testObjects itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:23:00' prior: 51071817!
test08CartRemembersTheNumberOfAddedItems

	| cart |
	
	cart := self createCart.
	
	cart add: 2 of: testObjects itemSellByTheStore.
	self assert: (cart occurrencesOf: testObjects itemSellByTheStore) = 2! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/24/2021 13:23:21'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/24/2021 13:23:21'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/24/2021 13:23:21'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/24/2021 13:23:21'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/24/2021 13:23:21'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/24/2021 13:23:21'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/24/2021 13:23:21'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/24/2021 13:23:21'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 13:23:31'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:23:32'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:23:32'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 13:23:32'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 13:23:32'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:23:32'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 13:23:32'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 13:23:32'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 13:23:32'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 13:23:32'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 13:23:32'!
PASSED!

!methodRemoval: CartTest #itemNotSellByTheStore stamp: 'ET 6/24/2021 13:23:47'!
itemNotSellByTheStore
	
	^'invalidBook'!
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:24:01' prior: 51071755!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |
	
	cart := self createCart.
	
	self 
		should: [ cart add: testObjects itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:24:07' prior: 51071789!
test05CanNotAddMoreThanOneItemNotSellByTheStore

	| cart |
	
	cart := self createCart.
	
	self 
		should: [cart add: 2 of: testObjects itemNotSellByTheStore  ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!TestObjects methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 13:24:25'!
temNotSellByTheStore
	
	^ 'invalidBook'! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/24/2021 13:24:27'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/24/2021 13:24:27'!
ERROR!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/24/2021 13:24:27'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/24/2021 13:24:27'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/24/2021 13:24:27'!
ERROR!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/24/2021 13:24:27'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/24/2021 13:24:28'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/24/2021 13:24:28'!
PASSED!
!TestObjects methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 13:24:48'!
itemNotSellByTheStore
	
	^ 'invalidBook'! !

!methodRemoval: TestObjects #temNotSellByTheStore stamp: 'ET 6/24/2021 13:24:48'!
temNotSellByTheStore
	
	^ 'invalidBook'!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 13:24:53'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 13:24:54'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 13:24:54'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 13:24:54'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 13:24:54'!
PASSED!

!methodRemoval: CartTest #defaultCatalog stamp: 'ET 6/24/2021 13:25:11'!
defaultCatalog
	^ TestObjects new defaultCatalog.!
!CartTest methodsFor: 'support' stamp: 'ET 6/24/2021 13:25:19' prior: 51071826!
createCart
	
	^Cart acceptingItemsOf: testObjects defaultCatalog! !

!methodRemoval: CartTest #createCart stamp: 'ET 6/24/2021 13:25:29'!
createCart
	
	^Cart acceptingItemsOf: testObjects defaultCatalog!
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:25:39' prior: 51071750!
test01NewCartsAreCreatedEmpty

	self assert: testObjects createCart isEmpty! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:25:53' prior: 51073373!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |
	
	cart := testObjects createCart.
	
	self 
		should: [ cart add: testObjects itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:25:58' prior: 51073173!
test03AfterAddingAnItemTheCartIsNotEmptyAnymore

	| cart |
	
	cart := testObjects createCart.
	
	cart add: testObjects itemSellByTheStore.
	self deny: cart isEmpty ! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:04' prior: 51073181!
test04CanNotAddNonPositiveNumberOfItems

	| cart |
	
	cart := testObjects createCart.
	
	self 
		should: [cart add: 0 of: testObjects itemSellByTheStore. ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:09' prior: 51073386!
test05CanNotAddMoreThanOneItemNotSellByTheStore

	| cart |
	
	cart := testObjects createCart.
	
	self 
		should: [cart add: 2 of: testObjects itemNotSellByTheStore  ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:12' prior: 51073202!
test06CartRemembersAddedItems

	| cart |
	
	cart := testObjects createCart.
	
	cart add: testObjects itemSellByTheStore.
	self assert: (cart includes: testObjects itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:16' prior: 51073211!
test07CartDoesNotHoldNotAddedItems

	| cart |
	
	cart := testObjects createCart.
	
	self deny: (cart includes: testObjects itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:20' prior: 51073218!
test08CartRemembersTheNumberOfAddedItems

	| cart |
	
	cart := testObjects createCart.
	
	cart add: 2 of: testObjects itemSellByTheStore.
	self assert: (cart occurrencesOf: testObjects itemSellByTheStore) = 2! !

!classDefinition: #CashierTest category: 'TusLibros' stamp: 'ET 6/24/2021 13:26:29'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjects'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:27' prior: 51071853!
test01CanNotCheckoutEmptyCart

	|cart cashier aSalesBook |

	cart := testObjects createCart.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier emptyCartErrorDescription. 
			self assert: aSalesBook isEmpty.]! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:34' prior: 51071869!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier aSalesBook |
	
	cart := testObjects createCart.
	cart add: self itemInStore.
	
	aSalesBook := OrderedCollection new.
	
	cashier := self newCashierWithPriceList: Dictionary new salesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier itemNotInPriceListErrorDescription. 
			self assert: aSalesBook isEmpty]! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:38' prior: 51073668!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier aSalesBook |
	
	cart := testObjects createCart.
	cart add: testObjects itemInStore.
	
	aSalesBook := OrderedCollection new.
	
	cashier := self newCashierWithPriceList: Dictionary new salesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier itemNotInPriceListErrorDescription. 
			self assert: aSalesBook isEmpty]! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:43' prior: 51071887!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := testObjects createCart.
	cart add: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 1 equals: (sales items occurrencesOf: self itemInStore).
	self assert: self itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:44' prior: 51073706!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := testObjects createCart.
	cart add: testObjects itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 1 equals: (sales items occurrencesOf: self itemInStore).
	self assert: self itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:49' prior: 51071906!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := testObjects createCart.
	cart add: 2 of: self itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 2 equals: (sales items occurrencesOf: self itemInStore).
	self assert: 2 * self itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:52' prior: 51073746!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := testObjects createCart.
	cart add: 2 of: testObjects itemInStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 2 equals: (sales items occurrencesOf: self itemInStore).
	self assert: 2 * self itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:57' prior: 51071926!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier aSalesBook |
	
	cart := testObjects createCart.
	cart add: self itemInStore.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	self should: [ (cashier checkout: cart withCreditCard: self expiredCreditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier expiredCreditCardErrorDescription.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:26:59' prior: 51073788!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier aSalesBook |
	
	cart := testObjects createCart.
	cart add: testObjects itemInStore.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	self should: [ (cashier checkout: cart withCreditCard: self expiredCreditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier expiredCreditCardErrorDescription.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:27:03' prior: 51071944!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier aSalesBook messageError |

	cart := testObjects createCart.
	cart add: self itemInStore.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: self defaultPriceList registerSalesOn: aSalesBook merchantProcessor: (self createMerchantProcessorThatRaisesError: messageError).
	
	
	self should: [ (cashier checkout: cart withCreditCard: self validCreditCard )]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:27:05' prior: 51073826!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier aSalesBook messageError |

	cart := testObjects createCart.
	cart add: testObjects itemInStore.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: self defaultPriceList registerSalesOn: aSalesBook merchantProcessor: (self createMerchantProcessorThatRaisesError: messageError).
	
	
	self should: [ (cashier checkout: cart withCreditCard: self validCreditCard )]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'support' stamp: 'ET 6/24/2021 13:27:43' overrides: 16927572!
setUp

	testObjects  := TestObjects new.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:27:58' prior: 51073687!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier aSalesBook |
	
	cart := testObjects createCart.
	cart add: testObjects itemSellByTheStore.
	
	aSalesBook := OrderedCollection new.
	
	cashier := self newCashierWithPriceList: Dictionary new salesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: self validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier itemNotInPriceListErrorDescription. 
			self assert: aSalesBook isEmpty]! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:28:06' prior: 51073726!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := testObjects createCart.
	cart add: testObjects itemSellByTheStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 1 equals: (sales items occurrencesOf: self itemInStore).
	self assert: self itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:28:11' prior: 51073767!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := testObjects createCart.
	cart add: 2 of: testObjects itemSellByTheStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 2 equals: (sales items occurrencesOf: self itemInStore).
	self assert: 2 * self itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:28:17' prior: 51073917!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := testObjects createCart.
	cart add: 2 of: testObjects itemSellByTheStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 2 equals: (sales items occurrencesOf: self itemInStore).
	self assert: 2 * self itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:28:22' prior: 51073807!
test05CanNotCheckoutWithExpiredCreditCard

	|cart cashier aSalesBook |
	
	cart := testObjects createCart.
	cart add: testObjects itemSellByTheStore.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	self should: [ (cashier checkout: cart withCreditCard: self expiredCreditCard)]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier expiredCreditCardErrorDescription.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:28:27' prior: 51073850!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier aSalesBook messageError |

	cart := testObjects createCart.
	cart add: testObjects itemSellByTheStore.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: self defaultPriceList registerSalesOn: aSalesBook merchantProcessor: (self createMerchantProcessorThatRaisesError: messageError).
	
	
	self should: [ (cashier checkout: cart withCreditCard: self validCreditCard )]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:29:00'!
ERROR!
!TestObjects methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 13:29:18'!
createCart

	^Dictionary with: self itemSellByTheStore -> self itemInStorePrice.! !
!TestObjects methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 13:29:34' prior: 51074005!
createCart

	^Cart acceptingItemsOf: self defaultPriceList keys.! !
!TestObjects methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 13:29:39' prior: 51074011!
createCart

	^Cart acceptingItemsOf: self defaultCatalog keys.! !
!TestObjects methodsFor: 'as yet unclassified' stamp: 'ET 6/24/2021 13:29:41' prior: 51074017!
createCart

	^Cart acceptingItemsOf: self defaultCatalog.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/24/2021 13:29:51'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/24/2021 13:29:51'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/24/2021 13:29:51'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/24/2021 13:29:51'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/24/2021 13:29:52'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/24/2021 13:29:52'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/24/2021 13:29:52'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/24/2021 13:29:52'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:29:53'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:29:53'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:29:53'!
ERROR!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:29:53'!
ERROR!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 13:29:53'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 13:29:53'!
FAILURE!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:30:09' prior: 51073897!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := testObjects createCart.
	cart add: testObjects itemSellByTheStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 1 equals: (sales items occurrencesOf: testObjects itemSellByTheStore).
	self assert: self itemInStorePrice equals: sales totalAmount.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:30:11'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:30:11'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 13:30:11'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:30:11'!
ERROR!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:30:11'!
ERROR!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 13:30:11'!
FAILURE!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:30:13'!
ERROR!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:31:26' prior: 51073652!
test01CanNotCheckoutEmptyCart

	|cart cashier aSalesBook |

	cart := testObjects createCart.
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: testObjects validCreditCard.]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier emptyCartErrorDescription. 
			self assert: aSalesBook isEmpty.]! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:31:27'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:31:27'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:31:27'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:31:27'!
ERROR!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:31:27'!
ERROR!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 13:31:27'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 13:31:27'!
FAILURE!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:31:38' prior: 51073878!
test02CanNotCheckoutCartWithNonPricedItem

	|cart cashier aSalesBook |
	
	cart := testObjects createCart.
	cart add: testObjects itemSellByTheStore.
	
	aSalesBook := OrderedCollection new.
	
	cashier := self newCashierWithPriceList: Dictionary new salesBook: aSalesBook.
	
	self should: [cashier checkout: cart withCreditCard: testObjects validCreditCard]
	 raise: Error
	 withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier itemNotInPriceListErrorDescription. 
			self assert: aSalesBook isEmpty]! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:31:49' prior: 51074074!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := testObjects createCart.
	cart add: testObjects itemSellByTheStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: testObjects validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 1 equals: (sales items occurrencesOf: testObjects itemSellByTheStore).
	self assert: self itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'support' stamp: 'ET 6/24/2021 13:32:16' prior: 51072008!
newCashierWithSalesBook: aSalesBook
	
	^self newCashierWithPriceList: testObjects defaultPriceList salesBook: aSalesBook.
		
		! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:32:35'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:32:38'!
FAILURE!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:32:38'!
FAILURE!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:36:09' prior: 51074180!
test03CheckoutCartWithOneItemReturnsThePriceOfThatItem

	|cart cashier aSalesBook sales |
	
	cart := testObjects createCart.
	cart add: testObjects itemSellByTheStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	
	sales _ cashier checkout: cart withCreditCard: testObjects validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 1 equals: (sales items occurrencesOf: testObjects itemSellByTheStore).
	self assert: testObjects itemInStorePrice equals: sales totalAmount.! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:36:10'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:36:10'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:36:10'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:36:10'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:36:10'!
FAILURE!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 13:36:10'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 13:36:10'!
FAILURE!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:36:22' prior: 51073938!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := testObjects createCart.
	cart add: 2 of: testObjects itemSellByTheStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 2 equals: (sales items occurrencesOf: self itemInStore).
	self assert: 2 * testObjects itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:36:33' prior: 51073978!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier aSalesBook messageError |

	cart := testObjects createCart.
	cart add: testObjects itemSellByTheStore.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: testObjects defaultPriceList registerSalesOn: aSalesBook merchantProcessor: (self createMerchantProcessorThatRaisesError: messageError).
	
	
	self should: [ (cashier checkout: cart withCreditCard: self validCreditCard )]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:36:40'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:36:40'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:36:40'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 13:36:40'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:36:40'!
FAILURE!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 13:36:40'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:36:40'!
FAILURE!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:36:56' prior: 51074265!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := testObjects createCart.
	cart add: 2 of: testObjects itemSellByTheStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: self validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 2 equals: (sales items occurrencesOf: testObjects itemSellByTheStore ).
	self assert: 2 * testObjects itemInStorePrice equals: sales totalAmount.! !

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:36:58'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:37:01'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:37:01'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:37:01'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:37:01'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:37:01'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 13:37:01'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 13:37:01'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:37:03'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 13:37:04'!
PASSED!

!methodRemoval: CashierTest #createCart stamp: 'ET 6/24/2021 13:37:23'!
createCart

	^Cart acceptingItemsOf: self defaultPriceList keys.!

!methodRemoval: CashierTest #defaultPriceList stamp: 'ET 6/24/2021 13:37:36'!
defaultPriceList

	^Dictionary with: self itemInStore -> self itemInStorePrice.!

!methodRemoval: CashierTest #itemInStore stamp: 'ET 6/24/2021 13:37:40'!
itemInStore

	^'book in store'.!

!methodRemoval: CashierTest #itemInStorePrice stamp: 'ET 6/24/2021 13:37:47'!
itemInStorePrice

	^1.!
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:38:25' prior: 51074336!
test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems

	|cart cashier aSalesBook sales |

	cart := testObjects createCart.
	cart add: 2 of: testObjects itemSellByTheStore.
	
	
	aSalesBook := OrderedCollection new.
	cashier := self newCashierWithSalesBook: aSalesBook.
	sales _ cashier checkout: cart withCreditCard: testObjects validCreditCard.
	self assert: 1 equals: aSalesBook size.
	self assert: aSalesBook first = sales.
	self assert: 2 equals: (sales items occurrencesOf: testObjects itemSellByTheStore ).
	self assert: 2 * testObjects itemInStorePrice equals: sales totalAmount.! !
!CashierTest methodsFor: 'tests' stamp: 'ET 6/24/2021 13:38:31' prior: 51074286!
test06CanNotCheckoutIfMerchantProcessorRaisesError

	|cart cashier aSalesBook messageError |

	cart := testObjects createCart.
	cart add: testObjects itemSellByTheStore.

	messageError := 'Something unexpected happened'.
	
	aSalesBook := OrderedCollection new.
	cashier := Cashier with: testObjects defaultPriceList registerSalesOn: aSalesBook merchantProcessor: (self createMerchantProcessorThatRaisesError: messageError).
	
	
	self should: [ (cashier checkout: cart withCreditCard: testObjects validCreditCard )]
	raise: Error - MessageNotUnderstood
	withExceptionDo: [ :anError |
			self assert: anError messageText = messageError.
			self assert: aSalesBook isEmpty ]	.
		
		
		! !

!methodRemoval: CashierTest #validCreditCard stamp: 'ET 6/24/2021 13:38:45'!
validCreditCard
	^ TestObjects new validCreditCard .
	"^ CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next"!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 13:38:48'!
PASSED!

----SNAPSHOT----(24 June 2021 13:40:43) CuisUniversity-4532.image priorSource: 23592453!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/24/2021 18:01:23'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/24/2021 18:01:24'!
PASSED!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\System\Collections-CompactArrays.pck.st----!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\Features\Compression.pck.st----!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\Features\Sound.pck.st----!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\Features\Cryptography-DigitalSignatures.pck.st----!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\Features\Identities-UUID.pck.st----!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\System\Network-Kernel.pck.st----!

----End fileIn of C:\Users\ezequ\Downloads\2021-1c-main (7)\2021-1c-main\20-TusLibros\Iteracion 4\WebClient.pck.st----!

----End fileIn of C:\Users\ezequ\Downloads\2021-1c-main (7)\2021-1c-main\20-TusLibros\Iteracion 4\StringsServicesServer.st----!

----SNAPSHOT----(24 June 2021 19:54:16) CuisUniversity-4532.image priorSource: 23777214!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\Morphic\Morphic-Widgets-Extras.pck.st----!

CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

!classDefinition: #ColorExtrasPackage category: 'Color-Extras' stamp: 'Install-Color-Extras 6/24/2021 20:05:49'!
CodePackage subclass: #ColorExtrasPackage
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Color-Extras'!

ColorExtrasPackage class
	instanceVariableNames: ''!

!classDefinition: 'ColorExtrasPackage class' category: 'Color-Extras' stamp: 'Install-Color-Extras 6/24/2021 20:05:49'!
ColorExtrasPackage class
	instanceVariableNames: ''!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\Features\Color-Extras.pck.st----!

CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classDefinition: #MorphicMisc1Package category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 6/24/2021 20:05:50'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!
!MorphicMisc1Package commentStamp: '<historical>' prior: 0!
My purpose in life is to check that any base image methods overridden have not been updated.
See #MorphMisc1Package class>>prePackageInstall!

MorphicMisc1Package class
	instanceVariableNames: ''!

!classDefinition: 'MorphicMisc1Package class' category: 'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 6/24/2021 20:05:50'!
MorphicMisc1Package class
	instanceVariableNames: ''!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\Morphic\Morphic-Misc1\Morphic-Misc1.pck.st----!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\Morphic\Morphic-Widgets-Extras.pck.st----!

----SNAPSHOT----(24 June 2021 20:10:47) CuisUniversity-4532.image priorSource: 25003653!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Packages\Morphic\Morphic-Widgets-Extras.pck.st----!

CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!

!classDefinition: #MorphicMisc1Package category: #'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 6/24/2021 20:26:02'!
CodePackage subclass: #MorphicMisc1Package
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Misc1'!
!MorphicMisc1Package commentStamp: '<historical>' prior: 51116106!
My purpose in life is to check that any base image methods overridden have not been updated.
See #MorphMisc1Package class>>prePackageInstall!

MorphicMisc1Package class
	instanceVariableNames: ''!

!classDefinition: 'MorphicMisc1Package class' category: #'Morphic-Misc1' stamp: 'Install-Morphic-Misc1 6/24/2021 20:26:02'!
MorphicMisc1Package class
	instanceVariableNames: ''!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 16:38:16' prior: 51132261!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin') 
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		 cartID := store createCartFor: client authenticatedWith: password.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID ccn cced cco creditCard transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.
		ccn := (request fields at:'ccn').
		cco := (request fields at:'cco').
		cced := (request fields at:'cced').
		
		creditCard := self createCreditCardOfOwner: cco number: ccn expiration: cced.
		transactionID := store checkoutCart: cartID creditCard: creditCard.
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (OrderedCollection with: list items with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 16:39:12'!
createCreditCardOfOwner: cco number: ccn expiration: cced
	|expirationDate month year|
	
	self assertExpirationStringIsValid: cced.
	
	month := (cced copyFrom: 1 to: 2) asNumber.
	year := (cced copyFrom: 3 to: 6) asNumber.
	expirationDate := GregorianMonthOfYear yearNumber: year  monthNumber: month.
	
	^CreditCard owner: cco number: ccn expiration: expirationDate.! !
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 16:39:27'!
assertExpirationStringIsValid: cced

	cced size = 6 ifFalse: [self error:CreditCard invalidCreditCardErrorDescription ].
	
	(cced allSatisfy: [:aDigit | aDigit isDigit]	) ifFalse: [self error:CreditCard invalidCreditCardErrorDescription ].! !

StoreRestInterface listeningOn: 8080.!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 16:43:04' prior: 51132445!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin') 
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		 cartID := store createCartFor: client authenticatedWith: password.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asString).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID ccn cced cco creditCard transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.
		ccn := (request fields at:'ccn').
		cco := (request fields at:'cco').
		cced := (request fields at:'cced').
		
		creditCard := self createCreditCardOfOwner: cco number: ccn expiration: cced.
		transactionID := store checkoutCart: cartID creditCard: creditCard.
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (OrderedCollection with: list items with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !

(OrderedCollection with: 2) asString!

WebUtils jsonEncode: (OrderedCollection with: 2)!

WebUtils jsonEncode: (OrderedCollection with: 2) asArray!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 16:44:29' prior: 51132614!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin') 
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		 cartID := store createCartFor: client authenticatedWith: password.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID ccn cced cco creditCard transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.
		ccn := (request fields at:'ccn').
		cco := (request fields at:'cco').
		cced := (request fields at:'cced').
		
		creditCard := self createCreditCardOfOwner: cco number: ccn expiration: cced.
		transactionID := store checkoutCart: cartID creditCard: creditCard.
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (OrderedCollection with: list items with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !

StoreRestInterface listeningOn: 8080.!

StoreRestInterface allInstancesDo: [:anInstance | anInstance destroy]!

StoreRestInterface allInstances!

StoreRestInterface allInstances!

StoreRestInterface allInstances !

self destroy!

self destroy!

self destroy!

self destroy!

self destroy!

self destroy!

self destroy!

StoreRestInterface listeningOn: 8080. !

StoreRestInterface allInstances !

self destroy!

self destroy!

StoreRestInterface listeningOn: 8080.
!

----SNAPSHOT----(28 June 2021 16:48:52) CuisUniversity-4532.image priorSource: 25556262!

----STARTUP---- (28 June 2021 16:49:06) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!


----SNAPSHOT----(28 June 2021 16:49:30) CuisUniversity-4532.image priorSource: 25640577!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 16:50:07' prior: 51132762!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin') 
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		 cartID := store createCartFor: client authenticatedWith: password.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID ccn cced cco creditCard transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.
		ccn := (request fields at:'ccn').
		cco := (request fields at:'cco').
		cced := (request fields at:'cced').
		
		creditCard := self createCreditCardOfOwner: cco number: ccn expiration: cced.
		transactionID := store checkoutCart: cartID creditCard: creditCard.
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list items with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !

StoreRestInterface listeningOn: 8080.!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 16:53:39' prior: 51132928!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin') 
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		 cartID := store createCartFor: client authenticatedWith: password.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID ccn cced cco creditCard transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.
		ccn := (request fields at:'ccn').
		cco := (request fields at:'cco').
		cced := (request fields at:'cced').
		
		creditCard := self createCreditCardOfOwner: cco number: ccn expiration: cced.
		transactionID := store checkoutCart: cartID creditCard: creditCard.
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !

StoreRestInterface allInstances!

self destroy!

self destroy!

self destroy!

self destroy!

self destroy!

self destroy!

self destroy!

StoreRestInterface listeningOn: 8080!

----SNAPSHOT----(28 June 2021 16:55:59) CuisUniversity-4532.image priorSource: 25640772!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 16:57:21' prior: 51133072!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin') 
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		 cartID := store createCartFor: client authenticatedWith: password.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID ccn cced cco creditCard transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.
		ccn := (request fields at:'ccn').
		cco := (request fields at:'cco').
		cced := (request fields at:'cced').
		
		creditCard := self createCreditCardOfOwner: cco number: ccn expiration: cced.
		transactionID := store checkoutCart: cartID creditCard: creditCard.
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !

----SNAPSHOT----(28 June 2021 16:57:49) CuisUniversity-4532.image priorSource: 25650195!

----STARTUP---- (28 June 2021 17:12:17) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!


'hola' substrings!

----End fileIn of C:\Users\ezequ\Desktop\windows64\Wor.st----!

!classDefinition: #StoreRestInterface category: 'TusLibros' stamp: 'ET 6/28/2021 19:27:42'!
Object subclass: #StoreRestInterface
	instanceVariableNames: 'webServer port stringGenius store userCreditCards'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!

!classDefinition: #StoreRestInterface category: 'TusLibros' stamp: 'ET 6/28/2021 19:27:44'!
Object subclass: #StoreRestInterface
	instanceVariableNames: 'webServer port stringGenius store userCreditCards userCarts'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros'!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 19:27:38' prior: 51133223!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin')
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	userCreditCards := Dictionary with: 'admin'-> (CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next).
	
	userCarts := Dictionary new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		cartID := store createCartFor: client authenticatedWith: password.
		
		userCarts add: cartID->client.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID ccn cced cco creditCard transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.
		ccn := (request fields at:'ccn').
		cco := (request fields at:'cco').
		cced := (request fields at:'cced').
		
		creditCard := self createCreditCardOfOwner: cco number: ccn expiration: cced.
		transactionID := store checkoutCart: cartID creditCard:  (self creditCardOfClient: (userCarts at: cartID)).
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 19:28:23'!
creditCardOfClient: aClientID
! !
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 19:28:42' prior: 51133787!
creditCardOfClient: aClientID

	^userCreditCards at: aClientID.
! !
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 19:29:07' prior: 51133637!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin')
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	userCreditCards := Dictionary with: 'admin'-> (CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next).
	
	userCarts := Dictionary new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		cartID := store createCartFor: client authenticatedWith: password.
		
		userCarts add: cartID->client.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.

		transactionID := store checkoutCart: cartID creditCard:  (self creditCardOfClient: (userCarts at: cartID)).
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/28/2021 19:34:31'!
test09CartCanRemoveAnItem

	| cart |
	
	cart := testObjects createCart.
	
	cart add: testObjects itemSellByTheStore.
	cart removeAll: testObjects itemSellByTheStore.
	self assert: cart isEmpty.! !

!testRun: #CartTest #test09CartCanRemoveAnItem stamp: 'ET 6/28/2021 19:34:33'!
ERROR!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/28/2021 19:34:38'!
removeAll: aString 
	self shouldBeImplemented.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/28/2021 19:35:02' prior: 51133953!
removeAll: anItem
	items removeAll: anItem.! !
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/28/2021 19:35:38' prior: 51133958!
removeAll: anItem
	items remove: anItem.! !

!testRun: #CartTest #test09CartCanRemoveAnItem stamp: 'ET 6/28/2021 19:36:11'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/28/2021 19:36:11'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/28/2021 19:36:11'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/28/2021 19:36:11'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/28/2021 19:36:11'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/28/2021 19:36:11'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/28/2021 19:36:11'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/28/2021 19:36:11'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/28/2021 19:36:11'!
PASSED!

!testRun: #CartTest #test09CartCanRemoveAnItem stamp: 'ET 6/28/2021 19:36:11'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'ET 6/28/2021 19:36:34'!
test10

	| cart |
	
	cart := testObjects createCart.
	
	cart add: 2 of: testObjects itemSellByTheStore.
	cart removeAll: testObjects itemSellByTheStore.
	self assert: cart isEmpty.! !
!CartTest methodsFor: 'tests' stamp: 'ET 6/28/2021 19:36:45' prior: 51133998!
test10

	| cart |
	
	cart := testObjects createCart.
	
	cart add: 2 of: testObjects itemSellByTheStore.
	cart removeAll: testObjects itemSellByTheStore.
	self assert: (cart occurrencesOf: testObjects itemSellByTheStore) = 1.! !

!testRun: #CartTest #test10 stamp: 'ET 6/28/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/28/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/28/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/28/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/28/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/28/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/28/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/28/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/28/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test09CartCanRemoveAnItem stamp: 'ET 6/28/2021 19:36:47'!
PASSED!

!testRun: #CartTest #test10 stamp: 'ET 6/28/2021 19:36:47'!
PASSED!
!CartTest methodsFor: 'tests' stamp: 'ET 6/28/2021 19:37:07' prior: 51134007!
test10

	| cart |
	
	cart := testObjects createCart.
	
	cart add: 2 of: testObjects itemSellByTheStore.
	cart removeAll: testObjects itemSellByTheStore.
	self assert: cart isEmpty.! !

!testRun: #CartTest #test10 stamp: 'ET 6/28/2021 19:37:09'!
FAILURE!
!Cart methodsFor: 'as yet unclassified' stamp: 'ET 6/28/2021 19:38:58' prior: 51133963!
removeAll: anItem
	items removeAllSuchThat: [:item | item = anItem].! !

!testRun: #CartTest #test10 stamp: 'ET 6/28/2021 19:38:59'!
PASSED!

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/28/2021 19:38:59'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/28/2021 19:38:59'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/28/2021 19:38:59'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/28/2021 19:38:59'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/28/2021 19:38:59'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/28/2021 19:38:59'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/28/2021 19:39:00'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/28/2021 19:39:00'!
PASSED!

!testRun: #CartTest #test09CartCanRemoveAnItem stamp: 'ET 6/28/2021 19:39:00'!
PASSED!

!testRun: #CartTest #test10 stamp: 'ET 6/28/2021 19:39:00'!
PASSED!
!StoreTest methodsFor: 'tests' stamp: 'ET 6/28/2021 19:41:22'!
test17

	| store cartID cartList |
	store := self store .
	cartID := self createValidCartIn: store.	
	
	
	store addToCart: cartID item: testObjects itemSellByTheStore quantity:1.
	store removeFromCart: cartID allItems: testObjects itemSellByTheStore.
	cartList := store listCart: cartID.
	
	self assert: cartList isEmpty.! !

!testRun: #StoreTest #test17 stamp: 'ET 6/28/2021 19:41:25'!
ERROR!
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/28/2021 19:41:31'!
removeFromCart: aSmallInteger allItems: aString 
	self shouldBeImplemented.! !
!Store methodsFor: 'as yet unclassified' stamp: 'ET 6/28/2021 19:42:08' prior: 51134112!
removeFromCart: cartID allItems: anItem
	
	(carts at: cartID) removeAll: anItem.! !

!testRun: #StoreTest #test17 stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/28/2021 19:42:11'!
PASSED!

!testRun: #StoreTest #test17 stamp: 'ET 6/28/2021 19:42:11'!
PASSED!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 19:42:58' prior: 51133798!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin')
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	userCreditCards := Dictionary with: 'admin'-> (CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next).
	
	userCarts := Dictionary new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		cartID := store createCartFor: client authenticatedWith: password.
		
		userCarts add: cartID->client.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item  |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		
		store removeFromCart: cartID allItems: item.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.

		transactionID := store checkoutCart: cartID creditCard:  (self creditCardOfClient: (userCarts at: cartID)).
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 19:43:07' prior: 51134181!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin')
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	userCreditCards := Dictionary with: 'admin'-> (CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next).
	
	userCarts := Dictionary new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		cartID := store createCartFor: client authenticatedWith: password.
		
		userCarts add: cartID->client.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/removeFromCart' action:[:request | |answerAsJson cartID item  |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		
		store removeFromCart: cartID allItems: item.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.

		transactionID := store checkoutCart: cartID creditCard:  (self creditCardOfClient: (userCarts at: cartID)).
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!Behavior method!
raiseAuthenticationErrorWithMessage: anErrorMessage
	(authenticationErrorMessage _ anErrorMessage
		cover: (84 to: 97)
		declaredAt: (38 to: 51))
		cover: (54 to: 79)
		declaredAt: (54 to: 79).! !
!Behavior method!
defaultPriceList
	^ [
	(Dictionary
		cover: (21 to: 30)
		declaredAt: (21 to: 30)) with:
		([
		([
		(self coverAll:
			{38 to: 41}) itemSellByTheStore ] valueCoveringAll:
			{43 to: 60}) ->
			([
			(self coverAll:
				{65 to: 68}) itemInStorePrice ] valueCoveringAll:
				{70 to: 85}) ] valueCoveringAll:
			{62 to: 63}) ] valueCoveringAll:
		{32 to: 36}.! !
!Behavior method!
itemSellByTheStore
	^ 'validBook' coverAll:
		{25 to: 35}.! !
!Behavior method!
itemInStorePrice
	^ 10 coverAll:
		{21 to: 22}.! !
!Behavior method!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{126 to: 129}) new ] valueCoveringAll:
		{131 to: 133})
		initializeWithClientAuthenticator:
			(aClientAuthenticator
				cover: (170 to: 189)
				declaredAt: (26 to: 45))
		clock:
			(aClock
				cover: (198 to: 203)
				declaredAt: (54 to: 59))
		priceList:
			(priceList
				cover: (216 to: 224)
				declaredAt: (72 to: 80))
		merchantProcessor:
			(aMerchantProcessor
				cover: (245 to: 262)
				declaredAt: (101 to: 118)) ] valueCoveringAll:
		{135 to: 168. 191 to: 196. 205 to: 214. 226 to: 243}.! !
!Behavior method!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList merchantProcessor: aMerchantProcessor
	(clientAuthenticator _ aClientAuthenticator
		cover: (157 to: 176)
		declaredAt: (36 to: 55))
		cover: (134 to: 152)
		declaredAt: (134 to: 152).
	(clock _ aClock
		cover: (189 to: 194)
		declaredAt: (64 to: 69))
		cover: (180 to: 184)
		declaredAt: (180 to: 184).
	(priceList _ aPriceList
		cover: (211 to: 220)
		declaredAt: (82 to: 91))
		cover: (198 to: 206)
		declaredAt: (198 to: 206).
	(carts _ [
	(Dictionary
		cover: (233 to: 242)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{244 to: 246})
		cover: (224 to: 228)
		declaredAt: (224 to: 228).
	(lastTimeCartUsed _ [
	(Dictionary
		cover: (270 to: 279)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{281 to: 283})
		cover: (250 to: 265)
		declaredAt: (250 to: 265).
	(cartOwner _ [
	(Dictionary
		cover: (300 to: 309)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{311 to: 313})
		cover: (287 to: 295)
		declaredAt: (287 to: 295).
	(salesBook _ [
	(OrderedCollection
		cover: (330 to: 346)
		declaredAt: (330 to: 346)) new ] valueCoveringAll:
		{348 to: 350})
		cover: (317 to: 325)
		declaredAt: (317 to: 325).
	(cashier _ [
	(Cashier
		cover: (365 to: 371)
		declaredAt: (365 to: 371))
		with:
			(priceList
				cover: (379 to: 387)
				declaredAt: (198 to: 206))
		registerSalesOn:
			(salesBook
				cover: (406 to: 414)
				declaredAt: (317 to: 325))
		merchantProcessor:
			(aMerchantProcessor
				cover: (435 to: 452)
				declaredAt: (112 to: 129)) ] valueCoveringAll:
		{373 to: 377. 389 to: 404. 416 to: 433})
		cover: (354 to: 360)
		declaredAt: (354 to: 360).
	(currentCartID _ 0 coverAll:
		{474 to: 474})
		cover: (457 to: 469)
		declaredAt: (457 to: 469).! !
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWith:
			(aPriceList
				cover: (112 to: 121)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (140 to: 149)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessor
				cover: (170 to: 187)
				declaredAt: (65 to: 82)) ] valueCoveringAll:
		{96 to: 110. 123 to: 138. 151 to: 168}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	(priceList _ aPriceList
		cover: (111 to: 120)
		declaredAt: (17 to: 26))
		cover: (98 to: 106)
		declaredAt: (98 to: 106).
	(salesBook _ aSalesBook
		cover: (137 to: 146)
		declaredAt: (45 to: 54))
		cover: (124 to: 132)
		declaredAt: (124 to: 132).
	(merchantProcessor _ aMerchantProcessor
		cover: (171 to: 188)
		declaredAt: (75 to: 92))
		cover: (150 to: 166)
		declaredAt: (150 to: 166).! !
!Behavior method!
createCartFor: userID authenticatedWith: aPassword
	| cartID |
	[
	(clientAuthenticator
		cover: (63 to: 81)
		declaredAt: (63 to: 81))
		authenticateUser:
			(userID
				cover: (101 to: 106)
				declaredAt: (16 to: 21))
		withPassword:
			(aPassword
				cover: (122 to: 130)
				declaredAt: (42 to: 50)) ] valueCoveringAll:
		{83 to: 99. 108 to: 120}.
	(cartID _ [
	(self coverAll:
		{147 to: 150}) nextFreeCartID ] valueCoveringAll:
		{152 to: 165})
		cover: (137 to: 142)
		declaredAt: (54 to: 59).
	[
	(carts
		cover: (169 to: 173)
		declaredAt: (169 to: 173)) add:
		([
		(cartID
			cover: (180 to: 185)
			declaredAt: (54 to: 59)) ->
			([
			(Cart
				cover: (191 to: 194)
				declaredAt: (191 to: 194)) acceptingItemsOf:
				([
				(self coverAll:
					{214 to: 217}) itemCatalog ] valueCoveringAll:
					{219 to: 229}) ] valueCoveringAll:
				{196 to: 212}) ] valueCoveringAll:
			{187 to: 188}) ] valueCoveringAll:
		{175 to: 178}.
	[
	(cartOwner
		cover: (234 to: 242)
		declaredAt: (234 to: 242)) add:
		([
		(cartID
			cover: (249 to: 254)
			declaredAt: (54 to: 59)) ->
			(userID
				cover: (259 to: 264)
				declaredAt: (16 to: 21)) ] valueCoveringAll:
			{256 to: 257}) ] valueCoveringAll:
		{244 to: 247}.
	[
	(self coverAll:
		{270 to: 273}) updateLastTimeUsedFor:
		(cartID
			cover: (298 to: 303)
			declaredAt: (54 to: 59)) ] valueCoveringAll:
		{275 to: 296}.
	^ cartID
		cover: (309 to: 314)
		declaredAt: (54 to: 59).! !
!Behavior method!
authenticateUser: aSmallInteger withPassword: aString
	[
	(authenticationErrorMessage
		cover: (57 to: 82)
		declaredAt: (57 to: 82)) ifNotNil: [
		[
		(self coverAll:
			{95 to: 98}) error:
			(authenticationErrorMessage
				cover: (107 to: 132)
				declaredAt: (57 to: 82)) ] valueCoveringAll:
			{100 to: 105} ]] valueCoveringAll:
		{84 to: 92}.! !
!Behavior method!
hasCarts
	^ [
	([
	(carts
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}) not ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/28/2021 19:45:56'!
PASSED!
!Behavior method!
with: aDateTime
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) initializeWith:
		(aDateTime
			cover: (45 to: 53)
			declaredAt: (7 to: 15)) ] valueCoveringAll:
		{29 to: 43}.! !
!Behavior method!
initializeWith: aDateTime
	(dateTime _ aDateTime
		cover: (40 to: 48)
		declaredAt: (17 to: 25))
		cover: (28 to: 35)
		declaredAt: (28 to: 35).! !
!Behavior method!
nextFreeCartID
	(currentCartID _ [
	(currentCartID
		cover: (19 to: 31)
		declaredAt: (19 to: 31)) +
		(1 coverAll:
			{52 to: 52}) ] valueCoveringAll:
		{50 to: 50})
		cover: (36 to: 48)
		declaredAt: (19 to: 31).
	^ currentCartID
		cover: (59 to: 71)
		declaredAt: (19 to: 31).! !
!Behavior method!
itemCatalog
	^ [
	(priceList
		cover: (17 to: 25)
		declaredAt: (17 to: 25)) keys ] valueCoveringAll:
		{27 to: 30}.! !
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
updateLastTimeUsedFor: cartID
	^ [
	(lastTimeCartUsed
		cover: (35 to: 50)
		declaredAt: (35 to: 50))
		at:
			(cartID
				cover: (56 to: 61)
				declaredAt: (24 to: 29))
		put:
			([
			(clock
				cover: (68 to: 72)
				declaredAt: (68 to: 72)) now ] valueCoveringAll:
				{74 to: 76}) ] valueCoveringAll:
		{52 to: 54. 63 to: 66}.! !
!Behavior method!
now
	^ dateTime
		cover: (8 to: 15)
		declaredAt: (8 to: 15).! !
!Behavior method!
hasCartIdentified: aCartId
	[
	(carts
		cover: (33 to: 37)
		declaredAt: (33 to: 37))
		at:
			(aCartId
				cover: (43 to: 49)
				declaredAt: (20 to: 26))
		ifAbsent: [ ^ false coverAll:
				{64 to: 68} ]] valueCoveringAll:
		{39 to: 41. 51 to: 59}.
	[
	([
	(self coverAll:
		{74 to: 77}) expiredCart:
		(aCartId
			cover: (92 to: 98)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{79 to: 90}) ifTrue: [
		[
		(self coverAll:
			{113 to: 116}) invalidateCartId:
			(aCartId
				cover: (136 to: 142)
				declaredAt: (20 to: 26)) ] valueCoveringAll:
			{118 to: 134}.
		^ false coverAll:
			{149 to: 153} ]] valueCoveringAll:
		{104 to: 110}.
	^ true coverAll:
		{159 to: 162}.! !
!Behavior method!
expiredCart: aCartId
	^ [
	([
	([
	(lastTimeCartUsed
		cover: (28 to: 43)
		declaredAt: (28 to: 43)) at:
		(aCartId
			cover: (49 to: 55)
			declaredAt: (14 to: 20)) ] valueCoveringAll:
		{45 to: 47}) next:
		([
		([
		(TimeUnits
			cover: (65 to: 73)
			declaredAt: (65 to: 73)) minute ] valueCoveringAll:
			{75 to: 80}) with:
			([
			(self coverAll:
				{88 to: 91}) maxInactiveTimeInMinutes ] valueCoveringAll:
				{93 to: 116}) ] valueCoveringAll:
			{82 to: 86}) ] valueCoveringAll:
		{58 to: 62}) <
		([
		(clock
			cover: (122 to: 126)
			declaredAt: (122 to: 126)) now ] valueCoveringAll:
			{128 to: 130}) ] valueCoveringAll:
		{120 to: 120}.! !
!Behavior method!
maxInactiveTimeInMinutes
	^ 30 coverAll:
		{30 to: 31}.! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/28/2021 19:45:56'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/28/2021 19:45:56'!
PASSED!
!Behavior method!
listCart: cartID
	| cartList |
	[
	(self coverAll:
		{35 to: 38}) assertCartIDIsValid:
		(cartID
			cover: (61 to: 66)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{40 to: 59}.
	(cartList _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (72 to: 79)
		declaredAt: (23 to: 30).
	[
	([
	(carts
		cover: (109 to: 113)
		declaredAt: (109 to: 113)) at:
		(cartID
			cover: (119 to: 124)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{115 to: 117}) do: [ :anItem |
		[
		(cartList
			cover: (142 to: 149)
			declaredAt: (23 to: 30)) add:
			(anItem
				cover: (156 to: 161)
				declaredAt: (133 to: 138)) ] valueCoveringAll:
			{151 to: 154} ]] valueCoveringAll:
		{127 to: 129}.
	[
	(self coverAll:
		{168 to: 171}) updateLastTimeUsedFor:
		(cartID
			cover: (196 to: 201)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{173 to: 194}.
	^ cartList
		cover: (209 to: 216)
		declaredAt: (23 to: 30).! !
!Behavior method!
assertCartIDIsValid: cartID
	[
	([
	(self coverAll:
		{33 to: 36}) hasCartIdentified:
		(cartID
			cover: (57 to: 62)
			declaredAt: (22 to: 27)) ] valueCoveringAll:
		{38 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) invalidCartIDErrorDescription ] valueCoveringAll:
				{99 to: 127}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/28/2021 19:45:56'!
PASSED!
!Behavior method!
invalidCartIDErrorDescription
	^ 'Cart ID is not in the system' coverAll:
		{33 to: 62}.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/28/2021 19:45:56'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/28/2021 19:45:56'!
PASSED!
!Behavior method!
addMinutes: anAmountOfMinutes
	(dateTime _ [
	(dateTime
		cover: (32 to: 39)
		declaredAt: (32 to: 39)) next:
		([
		([
		(TimeUnits
			cover: (60 to: 68)
			declaredAt: (60 to: 68)) minute ] valueCoveringAll:
			{70 to: 75}) with:
			(anAmountOfMinutes
				cover: (83 to: 99)
				declaredAt: (13 to: 29)) ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{53 to: 57})
		cover: (44 to: 51)
		declaredAt: (32 to: 39).! !
!Behavior method!
invalidateCartId: aCartID
	[
	(carts
		cover: (28 to: 32)
		declaredAt: (28 to: 32)) removeKey:
		(aCartID
			cover: (45 to: 51)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{34 to: 43}.
	[
	(lastTimeCartUsed
		cover: (55 to: 70)
		declaredAt: (55 to: 70)) removeKey:
		(aCartID
			cover: (83 to: 89)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{72 to: 81}.
	[
	(cartOwner
		cover: (93 to: 101)
		declaredAt: (93 to: 101)) removeKey:
		(aCartID
			cover: (114 to: 120)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{103 to: 112}.! !

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/28/2021 19:45:57'!
PASSED!
!Behavior method!
addToCart: aCartID item: anItem quantity: aQuantity
	[
	(self coverAll:
		{55 to: 58}) assertCartIDIsValid:
		(aCartID
			cover: (81 to: 87)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{60 to: 79}.
	[
	([
	(carts
		cover: (94 to: 98)
		declaredAt: (94 to: 98)) at:
		(aCartID
			cover: (104 to: 110)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{100 to: 102})
		add:
			(aQuantity
				cover: (118 to: 126)
				declaredAt: (43 to: 51))
		of:
			(anItem
				cover: (132 to: 137)
				declaredAt: (26 to: 31)) ] valueCoveringAll:
		{113 to: 116. 128 to: 130}.
	[
	(self coverAll:
		{142 to: 145}) updateLastTimeUsedFor:
		(aCartID
			cover: (170 to: 176)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{147 to: 168}.! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/28/2021 19:45:57'!
PASSED!
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/28/2021 19:45:57'!
PASSED!
!Behavior method!
listPurchasesOf: aUserId password: aPassword
	[
	(clientAuthenticator
		cover: (49 to: 67)
		declaredAt: (49 to: 67))
		authenticateUser:
			(aUserId
				cover: (87 to: 93)
				declaredAt: (18 to: 24))
		withPassword:
			(aPassword
				cover: (109 to: 117)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{69 to: 85. 95 to: 107}.
	^ [
	(self coverAll:
		{126 to: 129}) purchaseListFor:
		(aUserId
			cover: (148 to: 154)
			declaredAt: (18 to: 24)) ] valueCoveringAll:
		{131 to: 146}.! !
!Behavior method!
purchaseListFor: aUserID
	| userIDSales items totalAmount |
	(userIDSales _ [
	(salesBook
		cover: (76 to: 84)
		declaredAt: (76 to: 84)) select: [ :aSales |
		[
		([
		(aSales
			cover: (105 to: 110)
			declaredAt: (96 to: 101)) userID ] valueCoveringAll:
			{112 to: 117}) =
			(aUserID
				cover: (121 to: 127)
				declaredAt: (18 to: 24)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{86 to: 92})
		cover: (61 to: 71)
		declaredAt: (28 to: 38).
	(items _ [
	(OrderedCollection
		cover: (141 to: 157)
		declaredAt: (141 to: 157)) new ] valueCoveringAll:
		{159 to: 161})
		cover: (132 to: 136)
		declaredAt: (40 to: 44).
	[
	(userIDSales
		cover: (165 to: 175)
		declaredAt: (28 to: 38)) do: [ :aSales |
		[
		(items
			cover: (192 to: 196)
			declaredAt: (40 to: 44)) addAll:
			([
			(aSales
				cover: (206 to: 211)
				declaredAt: (183 to: 188)) items ] valueCoveringAll:
				{213 to: 217}) ] valueCoveringAll:
			{198 to: 204} ]] valueCoveringAll:
		{177 to: 179}.
	(totalAmount _ [
	(userIDSales
		cover: (237 to: 247)
		declaredAt: (28 to: 38))
		sum: [ :aSales |
			[
			(aSales
				cover: (265 to: 270)
				declaredAt: (256 to: 261)) totalAmount ] valueCoveringAll:
				{272 to: 282} ]
		ifEmpty:
			(0 coverAll:
				{294 to: 294}) ] valueCoveringAll:
		{249 to: 252. 285 to: 292})
		cover: (222 to: 232)
		declaredAt: (46 to: 56).
	^ [
	(PurchaseList
		cover: (299 to: 310)
		declaredAt: (299 to: 310))
		withItems:
			(items
				cover: (323 to: 327)
				declaredAt: (40 to: 44))
		totalAmount:
			(totalAmount
				cover: (342 to: 352)
				declaredAt: (46 to: 56)) ] valueCoveringAll:
		{312 to: 321. 329 to: 340}.! !
!Behavior method!
withItems: anItemList totalAmount: anAmount
	self coverAll:
		{49 to: 52}.
	^ [
	([ self new ] valueCoveringAll:
		{54 to: 56})
		initializeWithItems:
			(anItemList
				cover: (79 to: 88)
				declaredAt: (12 to: 21))
		totalAmount:
			(anAmount
				cover: (103 to: 110)
				declaredAt: (36 to: 43)) ] valueCoveringAll:
		{58 to: 77. 90 to: 101}.! !
!Behavior method!
initializeWithItems: anItemList totalAmount: anAmount
	(itemList _ anItemList
		cover: (69 to: 78)
		declaredAt: (22 to: 31))
		cover: (57 to: 64)
		declaredAt: (57 to: 64).
	(amount _ anAmount
		cover: (92 to: 99)
		declaredAt: (46 to: 53))
		cover: (82 to: 87)
		declaredAt: (82 to: 87).! !
!Behavior method!
isEmpty
	^ [
	(itemList
		cover: (12 to: 19)
		declaredAt: (12 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/28/2021 19:45:57'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/28/2021 19:45:57'!
PASSED!
!Behavior method!
validCreditCard
	^ [
	(CreditCard
		cover: (21 to: 30)
		declaredAt: (21 to: 30))
		owner:
			('owner' coverAll:
				{39 to: 45})
		number:
			('1234567891011121' coverAll:
				{55 to: 72})
		expiration:
			([
			([
			(GregorianMonthOfYear
				cover: (86 to: 105)
				declaredAt: (86 to: 105)) current ] valueCoveringAll:
				{107 to: 113}) next ] valueCoveringAll:
				{115 to: 118}) ] valueCoveringAll:
		{32 to: 37. 47 to: 53. 74 to: 84}.! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{89 to: 121}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (128 to: 134)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (159 to: 164)
			declaredAt: (150 to: 155)) isDigit ] valueCoveringAll:
			{166 to: 172} ]] valueCoveringAll:
		{136 to: 146}) ifFalse: [
		[
		(self coverAll:
			{187 to: 190}) error:
			([
			(self coverAll:
				{199 to: 202}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{204 to: 236}) ] valueCoveringAll:
			{192 to: 197} ]] valueCoveringAll:
		{177 to: 184}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{103 to: 135}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(expirationMonthOfYear _ aGregorianMonthOfYear
		cover: (209 to: 229)
		declaredAt: (76 to: 96))
		cover: (184 to: 204)
		declaredAt: (184 to: 204).! !
!Behavior method!
checkoutCart: aCartId creditCard: aCreditCard
	| userID sales |
	[
	(self coverAll:
		{66 to: 69}) assertCartIDIsValid:
		(aCartId
			cover: (92 to: 98)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{71 to: 90}.
	(sales _ [
	(cashier
		cover: (113 to: 119)
		declaredAt: (113 to: 119))
		checkout:
			([
			(carts
				cover: (132 to: 136)
				declaredAt: (132 to: 136)) at:
				(aCartId
					cover: (142 to: 148)
					declaredAt: (15 to: 21)) ] valueCoveringAll:
				{138 to: 140})
		withCreditCard:
			(aCreditCard
				cover: (167 to: 177)
				declaredAt: (35 to: 45)) ] valueCoveringAll:
		{121 to: 129. 151 to: 165})
		cover: (104 to: 108)
		declaredAt: (58 to: 62).
	(userID _ [
	(cartOwner
		cover: (191 to: 199)
		declaredAt: (191 to: 199)) at:
		(aCartId
			cover: (205 to: 211)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{201 to: 203})
		cover: (181 to: 186)
		declaredAt: (51 to: 56).
	[
	(sales
		cover: (216 to: 220)
		declaredAt: (58 to: 62)) userID:
		(userID
			cover: (230 to: 235)
			declaredAt: (51 to: 56)) ] valueCoveringAll:
		{222 to: 228}.
	[
	(self coverAll:
		{241 to: 244}) invalidateCartId:
		(aCartId
			cover: (264 to: 270)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{246 to: 262}.
	^ [
	(salesBook
		cover: (276 to: 284)
		declaredAt: (276 to: 284)) size ] valueCoveringAll:
		{286 to: 289}.! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice items sales |
	[
	(self coverAll:
		{73 to: 76}) assertCartIsNotEmpty:
		(aCart
			cover: (100 to: 104)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{78 to: 98}.
	[
	(self coverAll:
		{108 to: 111}) assertCreditCardIsNotExpired:
		(aCreditCard
			cover: (143 to: 153)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{113 to: 141}.
	(totalPrice _ 0 coverAll:
		{171 to: 171})
		cover: (157 to: 166)
		declaredAt: (48 to: 57).
	(items _ [
	(OrderedCollection
		cover: (184 to: 200)
		declaredAt: (184 to: 200)) new ] valueCoveringAll:
		{202 to: 204})
		cover: (175 to: 179)
		declaredAt: (59 to: 63).
	[
	(aCart
		cover: (208 to: 212)
		declaredAt: (11 to: 15)) do: [ :anItem |
		(totalPrice _ [
		([
		(totalPrice
			cover: (229 to: 238)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (256 to: 264)
				declaredAt: (256 to: 264)) ] valueCoveringAll:
			{254 to: 254})
			at:
				(anItem
					cover: (270 to: 275)
					declaredAt: (220 to: 225))
			ifAbsent: [
				[
				(self coverAll:
					{288 to: 291}) raiseItemNotInPriceListError ] valueCoveringAll:
					{293 to: 320} ]] valueCoveringAll:
			{266 to: 268. 277 to: 285})
			cover: (243 to: 252)
			declaredAt: (48 to: 57).
		[
		(items
			cover: (326 to: 330)
			declaredAt: (59 to: 63)) add:
			(anItem
				cover: (337 to: 342)
				declaredAt: (220 to: 225)) ] valueCoveringAll:
			{332 to: 335} ]] valueCoveringAll:
		{214 to: 216}.
	[
	(merchantProcessor
		cover: (347 to: 363)
		declaredAt: (347 to: 363))
		charge:
			(totalPrice
				cover: (373 to: 382)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (389 to: 399)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{365 to: 371. 385 to: 387}.
	(sales _ [
	(Sales
		cover: (413 to: 417)
		declaredAt: (413 to: 417))
		withItems:
			(items
				cover: (430 to: 434)
				declaredAt: (59 to: 63))
		totalAmount:
			(totalPrice
				cover: (449 to: 458)
				declaredAt: (48 to: 57)) ] valueCoveringAll:
		{419 to: 428. 436 to: 447})
		cover: (404 to: 408)
		declaredAt: (65 to: 69).
	[
	(salesBook
		cover: (462 to: 470)
		declaredAt: (462 to: 470)) add:
		(sales
			cover: (477 to: 481)
			declaredAt: (65 to: 69)) ] valueCoveringAll:
		{472 to: 475}.
	^ sales
		cover: (486 to: 490)
		declaredAt: (65 to: 69).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) emptyCartErrorDescription ] valueCoveringAll:
				{80 to: 104}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !
!Behavior method!
assertCreditCardIsNotExpired: aCreditCard
	[
	([
	(aCreditCard
		cover: (47 to: 57)
		declaredAt: (31 to: 41)) isExpiredOn:
		([
		(Date
			cover: (72 to: 75)
			declaredAt: (72 to: 75)) today ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{59 to: 70}) ifTrue: [
		[
		(self coverAll:
			{93 to: 96}) error:
			([
			([
			(self coverAll:
				{105 to: 108}) class ] valueCoveringAll:
				{110 to: 114}) expiredCreditCardErrorDescription ] valueCoveringAll:
				{116 to: 148}) ] valueCoveringAll:
			{98 to: 103} ]] valueCoveringAll:
		{84 to: 90}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	([
	(GregorianMonthOfYear
		cover: (26 to: 45)
		declaredAt: (26 to: 45))
		yearNumber:
			([
			(aDate
				cover: (59 to: 63)
				declaredAt: (14 to: 18)) yearNumber ] valueCoveringAll:
				{65 to: 74})
		monthNumber:
			([
			(aDate
				cover: (89 to: 93)
				declaredAt: (14 to: 18)) monthIndex ] valueCoveringAll:
				{95 to: 104}) ] valueCoveringAll:
		{47 to: 57. 76 to: 87}) >
		(expirationMonthOfYear
			cover: (109 to: 129)
			declaredAt: (109 to: 129)) ] valueCoveringAll:
		{107 to: 107}.! !
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !
!Behavior method!
withItems: items totalAmount: anAmount
	^ [
	([
	(self coverAll:
		{43 to: 46}) new ] valueCoveringAll:
		{48 to: 50})
		initializeWithItems:
			(items
				cover: (73 to: 77)
				declaredAt: (12 to: 16))
		totalAmount:
			(anAmount
				cover: (92 to: 99)
				declaredAt: (31 to: 38)) ] valueCoveringAll:
		{52 to: 71. 79 to: 90}.! !
!Behavior method!
initializeWithItems: aCollectionOfItems totalAmount: anAmount
	(items _ aCollectionOfItems
		cover: (75 to: 92)
		declaredAt: (22 to: 39))
		cover: (66 to: 70)
		declaredAt: (66 to: 70).
	(amount _ anAmount
		cover: (106 to: 113)
		declaredAt: (54 to: 61))
		cover: (96 to: 101)
		declaredAt: (96 to: 101).! !
!Behavior method!
userID: aUserID
	(userID _ aUserID
		cover: (28 to: 34)
		declaredAt: (9 to: 15))
		cover: (18 to: 23)
		declaredAt: (18 to: 23).! !
!Behavior method!
userID
	^ userID
		cover: (10 to: 15)
		declaredAt: (10 to: 15).! !
!Behavior method!
items
	^ items
		cover: (9 to: 13)
		declaredAt: (9 to: 13).! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !
!Behavior method!
list
	^ [
	(itemList
		cover: (9 to: 16)
		declaredAt: (9 to: 16)) copy ] valueCoveringAll:
		{18 to: 21}.! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/28/2021 19:45:57'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/28/2021 19:45:58'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/28/2021 19:45:58'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/28/2021 19:45:58'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/28/2021 19:45:58'!
PASSED!
!Behavior method!
removeFromCart: cartID allItems: anItem
	[
	([
	(carts
		cover: (45 to: 49)
		declaredAt: (45 to: 49)) at:
		(cartID
			cover: (55 to: 60)
			declaredAt: (17 to: 22)) ] valueCoveringAll:
		{51 to: 53}) removeAll:
		(anItem
			cover: (74 to: 79)
			declaredAt: (34 to: 39)) ] valueCoveringAll:
		{63 to: 72}.! !
!Behavior method!
removeAll: anItem
	[
	(items
		cover: (20 to: 24)
		declaredAt: (20 to: 24)) removeAllSuchThat: [ :item |
		[
		(item
			cover: (54 to: 57)
			declaredAt: (47 to: 50)) =
			(anItem
				cover: (61 to: 66)
				declaredAt: (12 to: 17)) ] valueCoveringAll:
			{59 to: 59} ]] valueCoveringAll:
		{26 to: 43}.! !

!testRun: #StoreTest #test17 stamp: 'ET 6/28/2021 19:45:58'!
PASSED!
!Behavior method!
createCart
	^ [
	(Cart
		cover: (15 to: 18)
		declaredAt: (15 to: 18)) acceptingItemsOf:
		([
		(self coverAll:
			{38 to: 41}) defaultCatalog ] valueCoveringAll:
			{43 to: 56}) ] valueCoveringAll:
		{20 to: 36}.! !
!Behavior method!
defaultCatalog
	^ [
	(Array
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) with:
		([
		(self coverAll:
			{33 to: 36}) itemSellByTheStore ] valueCoveringAll:
			{38 to: 55}) ] valueCoveringAll:
		{27 to: 31}.! !
!Behavior method!
itemSellByTheStore
	^ 'validBook' coverAll:
		{25 to: 35}.! !
!Behavior method!
acceptingItemsOf: aCatalog
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) initializeAcceptingItemsOf:
		(aCatalog
			cover: (68 to: 75)
			declaredAt: (19 to: 26)) ] valueCoveringAll:
		{40 to: 66}.! !
!Behavior method!
initializeAcceptingItemsOf: aCatalog
	(catalog _ aCatalog
		cover: (51 to: 58)
		declaredAt: (29 to: 36))
		cover: (40 to: 46)
		declaredAt: (40 to: 46).
	(items _ [
	(OrderedCollection
		cover: (71 to: 87)
		declaredAt: (71 to: 87)) new ] valueCoveringAll:
		{89 to: 91})
		cover: (62 to: 66)
		declaredAt: (62 to: 66).! !
!Behavior method!
isEmpty
	^ [
	(items
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}.! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'ET 6/28/2021 19:46:37'!
PASSED!
!Behavior method!
itemNotSellByTheStore
	^ 'invalidBook' coverAll:
		{28 to: 40}.! !
!Behavior method!
add: anItem
	^ [
	(self coverAll:
		{17 to: 20})
		add:
			(1 coverAll:
				{27 to: 27})
		of:
			(anItem
				cover: (33 to: 38)
				declaredAt: (6 to: 11)) ] valueCoveringAll:
		{22 to: 25. 29 to: 31}.! !
!Behavior method!
add: aQuantity of: anItem
	[
	(self coverAll:
		{29 to: 32}) assertIsValidQuantity:
		(aQuantity
			cover: (57 to: 65)
			declaredAt: (6 to: 14)) ] valueCoveringAll:
		{34 to: 55}.
	[
	(self coverAll:
		{69 to: 72}) assertIsValidItem:
		(anItem
			cover: (93 to: 98)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{74 to: 91}.
	[
	(1 coverAll:
		{103 to: 103})
		to:
			(aQuantity
				cover: (109 to: 117)
				declaredAt: (6 to: 14))
		do: [ :aNumber |
			[
			(items
				cover: (136 to: 140)
				declaredAt: (136 to: 140)) add:
				(anItem
					cover: (147 to: 152)
					declaredAt: (20 to: 25)) ] valueCoveringAll:
				{142 to: 145} ]] valueCoveringAll:
		{105 to: 107. 119 to: 121}.! !
!Behavior method!
assertIsValidQuantity: aQuantity
	[
	([
	(aQuantity
		cover: (36 to: 44)
		declaredAt: (24 to: 32)) strictlyPositive ] valueCoveringAll:
		{46 to: 61}) ifFalse: [
		[
		(self coverAll:
			{74 to: 77}) error:
			([
			(self coverAll:
				{86 to: 89}) invalidQuantityErrorMessage ] valueCoveringAll:
				{91 to: 117}) ] valueCoveringAll:
			{79 to: 84} ]] valueCoveringAll:
		{63 to: 70}.! !
!Behavior method!
assertIsValidItem: anItem
	[
	([
	(catalog
		cover: (30 to: 36)
		declaredAt: (30 to: 36)) includes:
		(anItem
			cover: (48 to: 53)
			declaredAt: (20 to: 25)) ] valueCoveringAll:
		{38 to: 46}) ifFalse: [
		[
		(self coverAll:
			{67 to: 70}) error:
			([
			(self coverAll:
				{79 to: 82}) invalidItemErrorMessage ] valueCoveringAll:
				{84 to: 106}) ] valueCoveringAll:
			{72 to: 77} ]] valueCoveringAll:
		{56 to: 63}.! !
!Behavior method!
invalidItemErrorMessage
	^ 'Item is not in catalog' coverAll:
		{29 to: 52}.! !

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'ET 6/28/2021 19:46:37'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'ET 6/28/2021 19:46:37'!
PASSED!
!Behavior method!
invalidQuantityErrorMessage
	^ 'Invalid number of items' coverAll:
		{33 to: 57}.! !

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'ET 6/28/2021 19:46:37'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'ET 6/28/2021 19:46:37'!
PASSED!
!Behavior method!
includes: anItem
	^ [
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) includes:
		(anItem
			cover: (37 to: 42)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{27 to: 35}.! !

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'ET 6/28/2021 19:46:37'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'ET 6/28/2021 19:46:37'!
PASSED!
!Behavior method!
occurrencesOf: anItem
	^ [
	(items
		cover: (26 to: 30)
		declaredAt: (26 to: 30)) occurrencesOf:
		(anItem
			cover: (47 to: 52)
			declaredAt: (16 to: 21)) ] valueCoveringAll:
		{32 to: 45}.! !

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'ET 6/28/2021 19:46:37'!
PASSED!
!Behavior method!
removeAll: anItem
	[
	(items
		cover: (20 to: 24)
		declaredAt: (20 to: 24)) removeAllSuchThat: [ :item |
		[
		(item
			cover: (54 to: 57)
			declaredAt: (47 to: 50)) =
			(anItem
				cover: (61 to: 66)
				declaredAt: (12 to: 17)) ] valueCoveringAll:
			{59 to: 59} ]] valueCoveringAll:
		{26 to: 43}.! !

!testRun: #CartTest #test09CartCanRemoveAnItem stamp: 'ET 6/28/2021 19:46:37'!
PASSED!

!testRun: #CartTest #test10 stamp: 'ET 6/28/2021 19:46:37'!
PASSED!
!Behavior method!
defaultPriceList
	^ [
	(Dictionary
		cover: (21 to: 30)
		declaredAt: (21 to: 30)) with:
		([
		([
		(self coverAll:
			{38 to: 41}) itemSellByTheStore ] valueCoveringAll:
			{43 to: 60}) ->
			([
			(self coverAll:
				{65 to: 68}) itemInStorePrice ] valueCoveringAll:
				{70 to: 85}) ] valueCoveringAll:
			{62 to: 63}) ] valueCoveringAll:
		{32 to: 36}.! !
!Behavior method!
itemInStorePrice
	^ 10 coverAll:
		{21 to: 22}.! !
!Behavior method!
with: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{87 to: 90}) new ] valueCoveringAll:
		{92 to: 94})
		initializeWith:
			(aPriceList
				cover: (112 to: 121)
				declaredAt: (7 to: 16))
		registerSalesOn:
			(aSalesBook
				cover: (140 to: 149)
				declaredAt: (35 to: 44))
		merchantProcessor:
			(aMerchantProcessor
				cover: (170 to: 187)
				declaredAt: (65 to: 82)) ] valueCoveringAll:
		{96 to: 110. 123 to: 138. 151 to: 168}.! !
!Behavior method!
initializeWith: aPriceList registerSalesOn: aSalesBook merchantProcessor: aMerchantProcessor
	(priceList _ aPriceList
		cover: (111 to: 120)
		declaredAt: (17 to: 26))
		cover: (98 to: 106)
		declaredAt: (98 to: 106).
	(salesBook _ aSalesBook
		cover: (137 to: 146)
		declaredAt: (45 to: 54))
		cover: (124 to: 132)
		declaredAt: (124 to: 132).
	(merchantProcessor _ aMerchantProcessor
		cover: (171 to: 188)
		declaredAt: (75 to: 92))
		cover: (150 to: 166)
		declaredAt: (150 to: 166).! !
!Behavior method!
validCreditCard
	^ [
	(CreditCard
		cover: (21 to: 30)
		declaredAt: (21 to: 30))
		owner:
			('owner' coverAll:
				{39 to: 45})
		number:
			('1234567891011121' coverAll:
				{55 to: 72})
		expiration:
			([
			([
			(GregorianMonthOfYear
				cover: (86 to: 105)
				declaredAt: (86 to: 105)) current ] valueCoveringAll:
				{107 to: 113}) next ] valueCoveringAll:
				{115 to: 118}) ] valueCoveringAll:
		{32 to: 37. 47 to: 53. 74 to: 84}.! !
!Behavior method!
owner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	[
	(self coverAll:
		{90 to: 93}) assertCreditCardNumberIsValid:
		(aCreditCardNumberString
			cover: (126 to: 148)
			declaredAt: (30 to: 52)) ] valueCoveringAll:
		{95 to: 124}.
	[
	(self coverAll:
		{152 to: 155}) assertNonBlankOwner:
		(anOwnerString
			cover: (178 to: 190)
			declaredAt: (8 to: 20)) ] valueCoveringAll:
		{157 to: 176}.
	^ [
	([
	(self coverAll:
		{195 to: 198}) new ] valueCoveringAll:
		{200 to: 202})
		initializeOwner:
			(anOwnerString
				cover: (221 to: 233)
				declaredAt: (8 to: 20))
		number:
			(aCreditCardNumberString
				cover: (243 to: 265)
				declaredAt: (30 to: 52))
		expiration:
			(aGregorianMonthOfYear
				cover: (279 to: 299)
				declaredAt: (66 to: 86)) ] valueCoveringAll:
		{204 to: 219. 235 to: 241. 267 to: 277}.! !
!Behavior method!
assertCreditCardNumberIsValid: aString
	[
	([
	([
	(aString
		cover: (44 to: 50)
		declaredAt: (32 to: 38)) size ] valueCoveringAll:
		{52 to: 55}) =
		(16 coverAll:
			{59 to: 60}) ] valueCoveringAll:
		{57 to: 57}) ifFalse: [
		[
		(self coverAll:
			{72 to: 75}) error:
			([
			(self coverAll:
				{84 to: 87}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{89 to: 121}) ] valueCoveringAll:
			{77 to: 82} ]] valueCoveringAll:
		{62 to: 69}.
	[
	([
	(aString
		cover: (128 to: 134)
		declaredAt: (32 to: 38)) allSatisfy: [ :aDigit |
		[
		(aDigit
			cover: (159 to: 164)
			declaredAt: (150 to: 155)) isDigit ] valueCoveringAll:
			{166 to: 172} ]] valueCoveringAll:
		{136 to: 146}) ifFalse: [
		[
		(self coverAll:
			{187 to: 190}) error:
			([
			(self coverAll:
				{199 to: 202}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{204 to: 236}) ] valueCoveringAll:
			{192 to: 197} ]] valueCoveringAll:
		{177 to: 184}.! !
!Behavior method!
assertNonBlankOwner: anOwnerString
	[
	([
	([
	(anOwnerString
		cover: (37 to: 49)
		declaredAt: (22 to: 34)) withBlanksTrimmed ] valueCoveringAll:
		{51 to: 67}) isEmpty ] valueCoveringAll:
		{69 to: 75}) ifTrue: [
		[
		(self coverAll:
			{86 to: 89}) error:
			([
			(self coverAll:
				{98 to: 101}) invalidCreditCardErrorDescription ] valueCoveringAll:
				{103 to: 135}) ] valueCoveringAll:
			{91 to: 96} ]] valueCoveringAll:
		{77 to: 83}.! !
!Behavior method!
initializeOwner: anOwnerString number: aCreditCardNumberString expiration: aGregorianMonthOfYear
	(ownerString _ anOwnerString
		cover: (116 to: 128)
		declaredAt: (18 to: 30))
		cover: (101 to: 111)
		declaredAt: (101 to: 111).
	(creditCardNumberString _ aCreditCardNumberString
		cover: (158 to: 180)
		declaredAt: (40 to: 62))
		cover: (132 to: 153)
		declaredAt: (132 to: 153).
	(expirationMonthOfYear _ aGregorianMonthOfYear
		cover: (209 to: 229)
		declaredAt: (76 to: 96))
		cover: (184 to: 204)
		declaredAt: (184 to: 204).! !
!Behavior method!
checkout: aCart withCreditCard: aCreditCard
	| totalPrice items sales |
	[
	(self coverAll:
		{73 to: 76}) assertCartIsNotEmpty:
		(aCart
			cover: (100 to: 104)
			declaredAt: (11 to: 15)) ] valueCoveringAll:
		{78 to: 98}.
	[
	(self coverAll:
		{108 to: 111}) assertCreditCardIsNotExpired:
		(aCreditCard
			cover: (143 to: 153)
			declaredAt: (33 to: 43)) ] valueCoveringAll:
		{113 to: 141}.
	(totalPrice _ 0 coverAll:
		{171 to: 171})
		cover: (157 to: 166)
		declaredAt: (48 to: 57).
	(items _ [
	(OrderedCollection
		cover: (184 to: 200)
		declaredAt: (184 to: 200)) new ] valueCoveringAll:
		{202 to: 204})
		cover: (175 to: 179)
		declaredAt: (59 to: 63).
	[
	(aCart
		cover: (208 to: 212)
		declaredAt: (11 to: 15)) do: [ :anItem |
		(totalPrice _ [
		([
		(totalPrice
			cover: (229 to: 238)
			declaredAt: (48 to: 57)) +
			(priceList
				cover: (256 to: 264)
				declaredAt: (256 to: 264)) ] valueCoveringAll:
			{254 to: 254})
			at:
				(anItem
					cover: (270 to: 275)
					declaredAt: (220 to: 225))
			ifAbsent: [
				[
				(self coverAll:
					{288 to: 291}) raiseItemNotInPriceListError ] valueCoveringAll:
					{293 to: 320} ]] valueCoveringAll:
			{266 to: 268. 277 to: 285})
			cover: (243 to: 252)
			declaredAt: (48 to: 57).
		[
		(items
			cover: (326 to: 330)
			declaredAt: (59 to: 63)) add:
			(anItem
				cover: (337 to: 342)
				declaredAt: (220 to: 225)) ] valueCoveringAll:
			{332 to: 335} ]] valueCoveringAll:
		{214 to: 216}.
	[
	(merchantProcessor
		cover: (347 to: 363)
		declaredAt: (347 to: 363))
		charge:
			(totalPrice
				cover: (373 to: 382)
				declaredAt: (48 to: 57))
		on:
			(aCreditCard
				cover: (389 to: 399)
				declaredAt: (33 to: 43)) ] valueCoveringAll:
		{365 to: 371. 385 to: 387}.
	(sales _ [
	(Sales
		cover: (413 to: 417)
		declaredAt: (413 to: 417))
		withItems:
			(items
				cover: (430 to: 434)
				declaredAt: (59 to: 63))
		totalAmount:
			(totalPrice
				cover: (449 to: 458)
				declaredAt: (48 to: 57)) ] valueCoveringAll:
		{419 to: 428. 436 to: 447})
		cover: (404 to: 408)
		declaredAt: (65 to: 69).
	[
	(salesBook
		cover: (462 to: 470)
		declaredAt: (462 to: 470)) add:
		(sales
			cover: (477 to: 481)
			declaredAt: (65 to: 69)) ] valueCoveringAll:
		{472 to: 475}.
	^ sales
		cover: (486 to: 490)
		declaredAt: (65 to: 69).! !
!Behavior method!
assertCartIsNotEmpty: aCart
	^ [
	([
	(aCart
		cover: (33 to: 37)
		declaredAt: (23 to: 27)) isEmpty ] valueCoveringAll:
		{39 to: 45}) ifTrue: [
		[
		(self coverAll:
			{57 to: 60}) error:
			([
			([
			(self coverAll:
				{69 to: 72}) class ] valueCoveringAll:
				{74 to: 78}) emptyCartErrorDescription ] valueCoveringAll:
				{80 to: 104}) ] valueCoveringAll:
			{62 to: 67} ]] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
emptyCartErrorDescription
	^ 'The cart is empty' coverAll:
		{29 to: 47}.! !

!testRun: #CashierTest #test01CanNotCheckoutEmptyCart stamp: 'ET 6/28/2021 19:46:37'!
PASSED!
!Behavior method!
assertCreditCardIsNotExpired: aCreditCard
	[
	([
	(aCreditCard
		cover: (47 to: 57)
		declaredAt: (31 to: 41)) isExpiredOn:
		([
		(Date
			cover: (72 to: 75)
			declaredAt: (72 to: 75)) today ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{59 to: 70}) ifTrue: [
		[
		(self coverAll:
			{93 to: 96}) error:
			([
			([
			(self coverAll:
				{105 to: 108}) class ] valueCoveringAll:
				{110 to: 114}) expiredCreditCardErrorDescription ] valueCoveringAll:
				{116 to: 148}) ] valueCoveringAll:
			{98 to: 103} ]] valueCoveringAll:
		{84 to: 90}.! !
!Behavior method!
isExpiredOn: aDate
	^ [
	([
	(GregorianMonthOfYear
		cover: (26 to: 45)
		declaredAt: (26 to: 45))
		yearNumber:
			([
			(aDate
				cover: (59 to: 63)
				declaredAt: (14 to: 18)) yearNumber ] valueCoveringAll:
				{65 to: 74})
		monthNumber:
			([
			(aDate
				cover: (89 to: 93)
				declaredAt: (14 to: 18)) monthIndex ] valueCoveringAll:
				{95 to: 104}) ] valueCoveringAll:
		{47 to: 57. 76 to: 87}) >
		(expirationMonthOfYear
			cover: (109 to: 129)
			declaredAt: (109 to: 129)) ] valueCoveringAll:
		{107 to: 107}.! !
!Behavior method!
do: aBlockClosure
	[
	(items
		cover: (21 to: 25)
		declaredAt: (21 to: 25)) do:
		(aBlockClosure
			cover: (31 to: 43)
			declaredAt: (5 to: 17)) ] valueCoveringAll:
		{27 to: 29}.! !
!Behavior method!
raiseItemNotInPriceListError
	^ [
	(self coverAll:
		{34 to: 37}) error:
		([
		([
		(self coverAll:
			{46 to: 49}) class ] valueCoveringAll:
			{51 to: 55}) itemNotInPriceListErrorDescription ] valueCoveringAll:
			{57 to: 90}) ] valueCoveringAll:
		{39 to: 44}.! !
!Behavior method!
itemNotInPriceListErrorDescription
	^ 'An item in the cart is not in the price list' coverAll:
		{38 to: 83}.! !

!testRun: #CashierTest #test02CanNotCheckoutCartWithNonPricedItem stamp: 'ET 6/28/2021 19:46:38'!
PASSED!
!Behavior method!
charge: aCharge on: aCreditCard
	[
	(messageError
		cover: (35 to: 46)
		declaredAt: (35 to: 46)) ifNotNil: [
		[
		(self coverAll:
			{60 to: 63}) error:
			(messageError
				cover: (72 to: 83)
				declaredAt: (35 to: 46)) ] valueCoveringAll:
			{65 to: 70} ]] valueCoveringAll:
		{48 to: 56}.! !
!Behavior method!
withItems: items totalAmount: anAmount
	^ [
	([
	(self coverAll:
		{43 to: 46}) new ] valueCoveringAll:
		{48 to: 50})
		initializeWithItems:
			(items
				cover: (73 to: 77)
				declaredAt: (12 to: 16))
		totalAmount:
			(anAmount
				cover: (92 to: 99)
				declaredAt: (31 to: 38)) ] valueCoveringAll:
		{52 to: 71. 79 to: 90}.! !
!Behavior method!
initializeWithItems: aCollectionOfItems totalAmount: anAmount
	(items _ aCollectionOfItems
		cover: (75 to: 92)
		declaredAt: (22 to: 39))
		cover: (66 to: 70)
		declaredAt: (66 to: 70).
	(amount _ anAmount
		cover: (106 to: 113)
		declaredAt: (54 to: 61))
		cover: (96 to: 101)
		declaredAt: (96 to: 101).! !
!Behavior method!
items
	^ items
		cover: (9 to: 13)
		declaredAt: (9 to: 13).! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !

!testRun: #CashierTest #test03CheckoutCartWithOneItemReturnsThePriceOfThatItem stamp: 'ET 6/28/2021 19:46:38'!
PASSED!

!testRun: #CashierTest #test04CheckoutCartWithManyItemsReturnsTheSumOfThePricesOfThoseItems stamp: 'ET 6/28/2021 19:46:38'!
PASSED!
!Behavior method!
expiredCreditCardErrorDescription
	^ 'The credit card is expired' coverAll:
		{37 to: 64}.! !

!testRun: #CashierTest #test05CanNotCheckoutWithExpiredCreditCard stamp: 'ET 6/28/2021 19:46:38'!
PASSED!
!Behavior method!
raiseErrorOnCharge: aMessageError
	(messageError _ aMessageError
		cover: (53 to: 65)
		declaredAt: (21 to: 33))
		cover: (37 to: 48)
		declaredAt: (37 to: 48).! !

!testRun: #CashierTest #test06CanNotCheckoutIfMerchantProcessorRaisesError stamp: 'ET 6/28/2021 19:46:38'!
PASSED!
!Behavior method!
invalidCreditCardErrorDescription
	^ 'Los datos de la tarjeta de crdito son invlidos' coverAll:
		{37 to: 86}.! !

!testRun: #CreditCardTest #test01CanNotCreateCreditCardWithIncorrectSizeNumber stamp: 'ET 6/28/2021 19:46:38'!
PASSED!

!testRun: #CreditCardTest #test02CanNotCreateCreditCardWithAlphaNumericNumber stamp: 'ET 6/28/2021 19:46:38'!
PASSED!

!testRun: #CreditCardTest #test03CanNotCreateCreditCardWithBlankOwner stamp: 'ET 6/28/2021 19:46:38'!
PASSED!

!testRun: #CreditCardTest #test04ExpiredCreditCardIsExpired stamp: 'ET 6/28/2021 19:46:38'!
PASSED!

!testRun: #CreditCardTest #test05NonExpiredCreditCardIsNotExpired stamp: 'ET 6/28/2021 19:46:38'!
PASSED!
!Behavior method!
raiseAuthenticationErrorWithMessage: anErrorMessage
	(authenticationErrorMessage _ anErrorMessage
		cover: (84 to: 97)
		declaredAt: (38 to: 51))
		cover: (54 to: 79)
		declaredAt: (54 to: 79).! !
!Behavior method!
withClientAuthenticator: aClientAuthenticator clock: aClock priceList: priceList merchantProcessor: aMerchantProcessor
	^ [
	([
	(self coverAll:
		{126 to: 129}) new ] valueCoveringAll:
		{131 to: 133})
		initializeWithClientAuthenticator:
			(aClientAuthenticator
				cover: (170 to: 189)
				declaredAt: (26 to: 45))
		clock:
			(aClock
				cover: (198 to: 203)
				declaredAt: (54 to: 59))
		priceList:
			(priceList
				cover: (216 to: 224)
				declaredAt: (72 to: 80))
		merchantProcessor:
			(aMerchantProcessor
				cover: (245 to: 262)
				declaredAt: (101 to: 118)) ] valueCoveringAll:
		{135 to: 168. 191 to: 196. 205 to: 214. 226 to: 243}.! !
!Behavior method!
initializeWithClientAuthenticator: aClientAuthenticator clock: aClock priceList: aPriceList merchantProcessor: aMerchantProcessor
	(clientAuthenticator _ aClientAuthenticator
		cover: (157 to: 176)
		declaredAt: (36 to: 55))
		cover: (134 to: 152)
		declaredAt: (134 to: 152).
	(clock _ aClock
		cover: (189 to: 194)
		declaredAt: (64 to: 69))
		cover: (180 to: 184)
		declaredAt: (180 to: 184).
	(priceList _ aPriceList
		cover: (211 to: 220)
		declaredAt: (82 to: 91))
		cover: (198 to: 206)
		declaredAt: (198 to: 206).
	(carts _ [
	(Dictionary
		cover: (233 to: 242)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{244 to: 246})
		cover: (224 to: 228)
		declaredAt: (224 to: 228).
	(lastTimeCartUsed _ [
	(Dictionary
		cover: (270 to: 279)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{281 to: 283})
		cover: (250 to: 265)
		declaredAt: (250 to: 265).
	(cartOwner _ [
	(Dictionary
		cover: (300 to: 309)
		declaredAt: (233 to: 242)) new ] valueCoveringAll:
		{311 to: 313})
		cover: (287 to: 295)
		declaredAt: (287 to: 295).
	(salesBook _ [
	(OrderedCollection
		cover: (330 to: 346)
		declaredAt: (330 to: 346)) new ] valueCoveringAll:
		{348 to: 350})
		cover: (317 to: 325)
		declaredAt: (317 to: 325).
	(cashier _ [
	(Cashier
		cover: (365 to: 371)
		declaredAt: (365 to: 371))
		with:
			(priceList
				cover: (379 to: 387)
				declaredAt: (198 to: 206))
		registerSalesOn:
			(salesBook
				cover: (406 to: 414)
				declaredAt: (317 to: 325))
		merchantProcessor:
			(aMerchantProcessor
				cover: (435 to: 452)
				declaredAt: (112 to: 129)) ] valueCoveringAll:
		{373 to: 377. 389 to: 404. 416 to: 433})
		cover: (354 to: 360)
		declaredAt: (354 to: 360).
	(currentCartID _ 0 coverAll:
		{474 to: 474})
		cover: (457 to: 469)
		declaredAt: (457 to: 469).! !
!Behavior method!
createCartFor: userID authenticatedWith: aPassword
	| cartID |
	[
	(clientAuthenticator
		cover: (63 to: 81)
		declaredAt: (63 to: 81))
		authenticateUser:
			(userID
				cover: (101 to: 106)
				declaredAt: (16 to: 21))
		withPassword:
			(aPassword
				cover: (122 to: 130)
				declaredAt: (42 to: 50)) ] valueCoveringAll:
		{83 to: 99. 108 to: 120}.
	(cartID _ [
	(self coverAll:
		{147 to: 150}) nextFreeCartID ] valueCoveringAll:
		{152 to: 165})
		cover: (137 to: 142)
		declaredAt: (54 to: 59).
	[
	(carts
		cover: (169 to: 173)
		declaredAt: (169 to: 173)) add:
		([
		(cartID
			cover: (180 to: 185)
			declaredAt: (54 to: 59)) ->
			([
			(Cart
				cover: (191 to: 194)
				declaredAt: (191 to: 194)) acceptingItemsOf:
				([
				(self coverAll:
					{214 to: 217}) itemCatalog ] valueCoveringAll:
					{219 to: 229}) ] valueCoveringAll:
				{196 to: 212}) ] valueCoveringAll:
			{187 to: 188}) ] valueCoveringAll:
		{175 to: 178}.
	[
	(cartOwner
		cover: (234 to: 242)
		declaredAt: (234 to: 242)) add:
		([
		(cartID
			cover: (249 to: 254)
			declaredAt: (54 to: 59)) ->
			(userID
				cover: (259 to: 264)
				declaredAt: (16 to: 21)) ] valueCoveringAll:
			{256 to: 257}) ] valueCoveringAll:
		{244 to: 247}.
	[
	(self coverAll:
		{270 to: 273}) updateLastTimeUsedFor:
		(cartID
			cover: (298 to: 303)
			declaredAt: (54 to: 59)) ] valueCoveringAll:
		{275 to: 296}.
	^ cartID
		cover: (309 to: 314)
		declaredAt: (54 to: 59).! !
!Behavior method!
authenticateUser: aSmallInteger withPassword: aString
	[
	(authenticationErrorMessage
		cover: (57 to: 82)
		declaredAt: (57 to: 82)) ifNotNil: [
		[
		(self coverAll:
			{95 to: 98}) error:
			(authenticationErrorMessage
				cover: (107 to: 132)
				declaredAt: (57 to: 82)) ] valueCoveringAll:
			{100 to: 105} ]] valueCoveringAll:
		{84 to: 92}.! !
!Behavior method!
hasCarts
	^ [
	([
	(carts
		cover: (13 to: 17)
		declaredAt: (13 to: 17)) isEmpty ] valueCoveringAll:
		{19 to: 25}) not ] valueCoveringAll:
		{27 to: 29}.! !

!testRun: #StoreTest #test01CanNotCreateCartWhenCredentialsCantBeAuthenticated stamp: 'ET 6/28/2021 19:46:38'!
PASSED!
!Behavior method!
with: aDateTime
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) initializeWith:
		(aDateTime
			cover: (45 to: 53)
			declaredAt: (7 to: 15)) ] valueCoveringAll:
		{29 to: 43}.! !
!Behavior method!
initializeWith: aDateTime
	(dateTime _ aDateTime
		cover: (40 to: 48)
		declaredAt: (17 to: 25))
		cover: (28 to: 35)
		declaredAt: (28 to: 35).! !
!Behavior method!
nextFreeCartID
	(currentCartID _ [
	(currentCartID
		cover: (19 to: 31)
		declaredAt: (19 to: 31)) +
		(1 coverAll:
			{52 to: 52}) ] valueCoveringAll:
		{50 to: 50})
		cover: (36 to: 48)
		declaredAt: (19 to: 31).
	^ currentCartID
		cover: (59 to: 71)
		declaredAt: (19 to: 31).! !
!Behavior method!
itemCatalog
	^ [
	(priceList
		cover: (17 to: 25)
		declaredAt: (17 to: 25)) keys ] valueCoveringAll:
		{27 to: 30}.! !
!Behavior method!
updateLastTimeUsedFor: cartID
	^ [
	(lastTimeCartUsed
		cover: (35 to: 50)
		declaredAt: (35 to: 50))
		at:
			(cartID
				cover: (56 to: 61)
				declaredAt: (24 to: 29))
		put:
			([
			(clock
				cover: (68 to: 72)
				declaredAt: (68 to: 72)) now ] valueCoveringAll:
				{74 to: 76}) ] valueCoveringAll:
		{52 to: 54. 63 to: 66}.! !
!Behavior method!
now
	^ dateTime
		cover: (8 to: 15)
		declaredAt: (8 to: 15).! !
!Behavior method!
hasCartIdentified: aCartId
	[
	(carts
		cover: (33 to: 37)
		declaredAt: (33 to: 37))
		at:
			(aCartId
				cover: (43 to: 49)
				declaredAt: (20 to: 26))
		ifAbsent: [ ^ false coverAll:
				{64 to: 68} ]] valueCoveringAll:
		{39 to: 41. 51 to: 59}.
	[
	([
	(self coverAll:
		{74 to: 77}) expiredCart:
		(aCartId
			cover: (92 to: 98)
			declaredAt: (20 to: 26)) ] valueCoveringAll:
		{79 to: 90}) ifTrue: [
		[
		(self coverAll:
			{113 to: 116}) invalidateCartId:
			(aCartId
				cover: (136 to: 142)
				declaredAt: (20 to: 26)) ] valueCoveringAll:
			{118 to: 134}.
		^ false coverAll:
			{149 to: 153} ]] valueCoveringAll:
		{104 to: 110}.
	^ true coverAll:
		{159 to: 162}.! !
!Behavior method!
expiredCart: aCartId
	^ [
	([
	([
	(lastTimeCartUsed
		cover: (28 to: 43)
		declaredAt: (28 to: 43)) at:
		(aCartId
			cover: (49 to: 55)
			declaredAt: (14 to: 20)) ] valueCoveringAll:
		{45 to: 47}) next:
		([
		([
		(TimeUnits
			cover: (65 to: 73)
			declaredAt: (65 to: 73)) minute ] valueCoveringAll:
			{75 to: 80}) with:
			([
			(self coverAll:
				{88 to: 91}) maxInactiveTimeInMinutes ] valueCoveringAll:
				{93 to: 116}) ] valueCoveringAll:
			{82 to: 86}) ] valueCoveringAll:
		{58 to: 62}) <
		([
		(clock
			cover: (122 to: 126)
			declaredAt: (122 to: 126)) now ] valueCoveringAll:
			{128 to: 130}) ] valueCoveringAll:
		{120 to: 120}.! !
!Behavior method!
maxInactiveTimeInMinutes
	^ 30 coverAll:
		{30 to: 31}.! !

!testRun: #StoreTest #test02StoreHasNewCreatedCart stamp: 'ET 6/28/2021 19:46:38'!
PASSED!

!testRun: #StoreTest #test03StoreOnlyIdentifiesIDsMatchedWithCreatedCarts stamp: 'ET 6/28/2021 19:46:38'!
PASSED!
!Behavior method!
listCart: cartID
	| cartList |
	[
	(self coverAll:
		{35 to: 38}) assertCartIDIsValid:
		(cartID
			cover: (61 to: 66)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{40 to: 59}.
	(cartList _ [
	(OrderedCollection
		cover: (84 to: 100)
		declaredAt: (84 to: 100)) new ] valueCoveringAll:
		{102 to: 104})
		cover: (72 to: 79)
		declaredAt: (23 to: 30).
	[
	([
	(carts
		cover: (109 to: 113)
		declaredAt: (109 to: 113)) at:
		(cartID
			cover: (119 to: 124)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{115 to: 117}) do: [ :anItem |
		[
		(cartList
			cover: (142 to: 149)
			declaredAt: (23 to: 30)) add:
			(anItem
				cover: (156 to: 161)
				declaredAt: (133 to: 138)) ] valueCoveringAll:
			{151 to: 154} ]] valueCoveringAll:
		{127 to: 129}.
	[
	(self coverAll:
		{168 to: 171}) updateLastTimeUsedFor:
		(cartID
			cover: (196 to: 201)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{173 to: 194}.
	^ cartList
		cover: (209 to: 216)
		declaredAt: (23 to: 30).! !
!Behavior method!
assertCartIDIsValid: cartID
	[
	([
	(self coverAll:
		{33 to: 36}) hasCartIdentified:
		(cartID
			cover: (57 to: 62)
			declaredAt: (22 to: 27)) ] valueCoveringAll:
		{38 to: 55}) ifFalse: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			([
			(self coverAll:
				{88 to: 91}) class ] valueCoveringAll:
				{93 to: 97}) invalidCartIDErrorDescription ] valueCoveringAll:
				{99 to: 127}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{66 to: 73}.! !

!testRun: #StoreTest #test04NewCreatedCartIsEmpty stamp: 'ET 6/28/2021 19:46:38'!
PASSED!
!Behavior method!
invalidCartIDErrorDescription
	^ 'Cart ID is not in the system' coverAll:
		{33 to: 62}.! !

!testRun: #StoreTest #test05CanNotListNonIdentifiedCart stamp: 'ET 6/28/2021 19:46:38'!
PASSED!

!testRun: #StoreTest #test06StoreCanCreateMoreThanOneCart stamp: 'ET 6/28/2021 19:46:38'!
PASSED!
!Behavior method!
addMinutes: anAmountOfMinutes
	(dateTime _ [
	(dateTime
		cover: (32 to: 39)
		declaredAt: (32 to: 39)) next:
		([
		([
		(TimeUnits
			cover: (60 to: 68)
			declaredAt: (60 to: 68)) minute ] valueCoveringAll:
			{70 to: 75}) with:
			(anAmountOfMinutes
				cover: (83 to: 99)
				declaredAt: (13 to: 29)) ] valueCoveringAll:
			{77 to: 81}) ] valueCoveringAll:
		{53 to: 57})
		cover: (44 to: 51)
		declaredAt: (32 to: 39).! !
!Behavior method!
invalidateCartId: aCartID
	[
	(carts
		cover: (28 to: 32)
		declaredAt: (28 to: 32)) removeKey:
		(aCartID
			cover: (45 to: 51)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{34 to: 43}.
	[
	(lastTimeCartUsed
		cover: (55 to: 70)
		declaredAt: (55 to: 70)) removeKey:
		(aCartID
			cover: (83 to: 89)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{72 to: 81}.
	[
	(cartOwner
		cover: (93 to: 101)
		declaredAt: (93 to: 101)) removeKey:
		(aCartID
			cover: (114 to: 120)
			declaredAt: (19 to: 25)) ] valueCoveringAll:
		{103 to: 112}.! !

!testRun: #StoreTest #test07CartIsInvalidAfter30MinOfItsCreation stamp: 'ET 6/28/2021 19:46:39'!
PASSED!
!Behavior method!
addToCart: aCartID item: anItem quantity: aQuantity
	[
	(self coverAll:
		{55 to: 58}) assertCartIDIsValid:
		(aCartID
			cover: (81 to: 87)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{60 to: 79}.
	[
	([
	(carts
		cover: (94 to: 98)
		declaredAt: (94 to: 98)) at:
		(aCartID
			cover: (104 to: 110)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{100 to: 102})
		add:
			(aQuantity
				cover: (118 to: 126)
				declaredAt: (43 to: 51))
		of:
			(anItem
				cover: (132 to: 137)
				declaredAt: (26 to: 31)) ] valueCoveringAll:
		{113 to: 116. 128 to: 130}.
	[
	(self coverAll:
		{142 to: 145}) updateLastTimeUsedFor:
		(aCartID
			cover: (170 to: 176)
			declaredAt: (12 to: 18)) ] valueCoveringAll:
		{147 to: 168}.! !

!testRun: #StoreTest #test08CannotAddToCartAfter30MinOfItsCreation stamp: 'ET 6/28/2021 19:46:39'!
PASSED!

!testRun: #StoreTest #test09ItemsAddedToCartAreListed stamp: 'ET 6/28/2021 19:46:39'!
PASSED!
!Behavior method!
listPurchasesOf: aUserId password: aPassword
	[
	(clientAuthenticator
		cover: (49 to: 67)
		declaredAt: (49 to: 67))
		authenticateUser:
			(aUserId
				cover: (87 to: 93)
				declaredAt: (18 to: 24))
		withPassword:
			(aPassword
				cover: (109 to: 117)
				declaredAt: (36 to: 44)) ] valueCoveringAll:
		{69 to: 85. 95 to: 107}.
	^ [
	(self coverAll:
		{126 to: 129}) purchaseListFor:
		(aUserId
			cover: (148 to: 154)
			declaredAt: (18 to: 24)) ] valueCoveringAll:
		{131 to: 146}.! !
!Behavior method!
purchaseListFor: aUserID
	| userIDSales items totalAmount |
	(userIDSales _ [
	(salesBook
		cover: (76 to: 84)
		declaredAt: (76 to: 84)) select: [ :aSales |
		[
		([
		(aSales
			cover: (105 to: 110)
			declaredAt: (96 to: 101)) userID ] valueCoveringAll:
			{112 to: 117}) =
			(aUserID
				cover: (121 to: 127)
				declaredAt: (18 to: 24)) ] valueCoveringAll:
			{119 to: 119} ]] valueCoveringAll:
		{86 to: 92})
		cover: (61 to: 71)
		declaredAt: (28 to: 38).
	(items _ [
	(OrderedCollection
		cover: (141 to: 157)
		declaredAt: (141 to: 157)) new ] valueCoveringAll:
		{159 to: 161})
		cover: (132 to: 136)
		declaredAt: (40 to: 44).
	[
	(userIDSales
		cover: (165 to: 175)
		declaredAt: (28 to: 38)) do: [ :aSales |
		[
		(items
			cover: (192 to: 196)
			declaredAt: (40 to: 44)) addAll:
			([
			(aSales
				cover: (206 to: 211)
				declaredAt: (183 to: 188)) items ] valueCoveringAll:
				{213 to: 217}) ] valueCoveringAll:
			{198 to: 204} ]] valueCoveringAll:
		{177 to: 179}.
	(totalAmount _ [
	(userIDSales
		cover: (237 to: 247)
		declaredAt: (28 to: 38))
		sum: [ :aSales |
			[
			(aSales
				cover: (265 to: 270)
				declaredAt: (256 to: 261)) totalAmount ] valueCoveringAll:
				{272 to: 282} ]
		ifEmpty:
			(0 coverAll:
				{294 to: 294}) ] valueCoveringAll:
		{249 to: 252. 285 to: 292})
		cover: (222 to: 232)
		declaredAt: (46 to: 56).
	^ [
	(PurchaseList
		cover: (299 to: 310)
		declaredAt: (299 to: 310))
		withItems:
			(items
				cover: (323 to: 327)
				declaredAt: (40 to: 44))
		totalAmount:
			(totalAmount
				cover: (342 to: 352)
				declaredAt: (46 to: 56)) ] valueCoveringAll:
		{312 to: 321. 329 to: 340}.! !
!Behavior method!
withItems: anItemList totalAmount: anAmount
	self coverAll:
		{49 to: 52}.
	^ [
	([ self new ] valueCoveringAll:
		{54 to: 56})
		initializeWithItems:
			(anItemList
				cover: (79 to: 88)
				declaredAt: (12 to: 21))
		totalAmount:
			(anAmount
				cover: (103 to: 110)
				declaredAt: (36 to: 43)) ] valueCoveringAll:
		{58 to: 77. 90 to: 101}.! !
!Behavior method!
initializeWithItems: anItemList totalAmount: anAmount
	(itemList _ anItemList
		cover: (69 to: 78)
		declaredAt: (22 to: 31))
		cover: (57 to: 64)
		declaredAt: (57 to: 64).
	(amount _ anAmount
		cover: (92 to: 99)
		declaredAt: (46 to: 53))
		cover: (82 to: 87)
		declaredAt: (82 to: 87).! !
!Behavior method!
isEmpty
	^ [
	(itemList
		cover: (12 to: 19)
		declaredAt: (12 to: 19)) isEmpty ] valueCoveringAll:
		{21 to: 27}.! !
!Behavior method!
totalAmount
	^ amount
		cover: (15 to: 20)
		declaredAt: (15 to: 20).! !

!testRun: #StoreTest #test10PurchaseListOfUserWithoutPurchasesIsEmpty stamp: 'ET 6/28/2021 19:46:39'!
PASSED!

!testRun: #StoreTest #test11CanNotListPurchasesWhenCredentialsCantBeAuthenticated stamp: 'ET 6/28/2021 19:46:39'!
PASSED!
!Behavior method!
checkoutCart: aCartId creditCard: aCreditCard
	| userID sales |
	[
	(self coverAll:
		{66 to: 69}) assertCartIDIsValid:
		(aCartId
			cover: (92 to: 98)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{71 to: 90}.
	(sales _ [
	(cashier
		cover: (113 to: 119)
		declaredAt: (113 to: 119))
		checkout:
			([
			(carts
				cover: (132 to: 136)
				declaredAt: (132 to: 136)) at:
				(aCartId
					cover: (142 to: 148)
					declaredAt: (15 to: 21)) ] valueCoveringAll:
				{138 to: 140})
		withCreditCard:
			(aCreditCard
				cover: (167 to: 177)
				declaredAt: (35 to: 45)) ] valueCoveringAll:
		{121 to: 129. 151 to: 165})
		cover: (104 to: 108)
		declaredAt: (58 to: 62).
	(userID _ [
	(cartOwner
		cover: (191 to: 199)
		declaredAt: (191 to: 199)) at:
		(aCartId
			cover: (205 to: 211)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{201 to: 203})
		cover: (181 to: 186)
		declaredAt: (51 to: 56).
	[
	(sales
		cover: (216 to: 220)
		declaredAt: (58 to: 62)) userID:
		(userID
			cover: (230 to: 235)
			declaredAt: (51 to: 56)) ] valueCoveringAll:
		{222 to: 228}.
	[
	(self coverAll:
		{241 to: 244}) invalidateCartId:
		(aCartId
			cover: (264 to: 270)
			declaredAt: (15 to: 21)) ] valueCoveringAll:
		{246 to: 262}.
	^ [
	(salesBook
		cover: (276 to: 284)
		declaredAt: (276 to: 284)) size ] valueCoveringAll:
		{286 to: 289}.! !
!Behavior method!
userID: aUserID
	(userID _ aUserID
		cover: (28 to: 34)
		declaredAt: (9 to: 15))
		cover: (18 to: 23)
		declaredAt: (18 to: 23).! !
!Behavior method!
userID
	^ userID
		cover: (10 to: 15)
		declaredAt: (10 to: 15).! !
!Behavior method!
list
	^ [
	(itemList
		cover: (9 to: 16)
		declaredAt: (9 to: 16)) copy ] valueCoveringAll:
		{18 to: 21}.! !

!testRun: #StoreTest #test12CheckoutUpdatesPurchaseListOfUserWithTheSales stamp: 'ET 6/28/2021 19:46:39'!
PASSED!

!testRun: #StoreTest #test13CannotCheckoutWithInvalidCartID stamp: 'ET 6/28/2021 19:46:39'!
PASSED!

!testRun: #StoreTest #test14CheckoutInvalidatesCartId stamp: 'ET 6/28/2021 19:46:39'!
PASSED!

!testRun: #StoreTest #test15CheckoutCartReturnsUniqueTransactionIDs stamp: 'ET 6/28/2021 19:46:39'!
PASSED!

!testRun: #StoreTest #test16UseCartUpdatesTimeLimit stamp: 'ET 6/28/2021 19:46:39'!
PASSED!
!Behavior method!
removeFromCart: cartID allItems: anItem
	[
	([
	(carts
		cover: (45 to: 49)
		declaredAt: (45 to: 49)) at:
		(cartID
			cover: (55 to: 60)
			declaredAt: (17 to: 22)) ] valueCoveringAll:
		{51 to: 53}) removeAll:
		(anItem
			cover: (74 to: 79)
			declaredAt: (34 to: 39)) ] valueCoveringAll:
		{63 to: 72}.! !

!testRun: #StoreTest #test17 stamp: 'ET 6/28/2021 19:46:39'!
PASSED!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 19:49:00' prior: 51134338!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin')
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	userCreditCards := Dictionary with: 'admin'-> (CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next).
	
	userCarts := Dictionary new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		cartID := store createCartFor: client authenticatedWith: password.
		
		userCarts add: cartID->client.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/removeFromCart' action:[:request | |answerAsJson cartID item  |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		
		store removeFromCart: cartID allItems: item.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/removeFromCart' action:[:request | |answerAsJson catalog  |
		
		[catalog := store itemCatalog.
		
		answerAsJson:= WebUtils jsonEncode: (catalog asArray).
		request send200Response: (answerAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.

		transactionID := store checkoutCart: cartID creditCard:  (self creditCardOfClient: (userCarts at: cartID)).
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !

!classRenamed: #WordsClientWindow as: #StoreClientWindow stamp: 'ET 6/28/2021 19:52:04'!
Smalltalk renameClassNamed: #WordsClientWindow as: #StoreClientWindow!

!classRenamed: #WordsClientWindowModel as: #StoreClientWindowModel stamp: 'ET 6/28/2021 19:52:15'!
Smalltalk renameClassNamed: #WordsClientWindowModel as: #StoreClientWindowModel!
!StoreClientWindow methodsFor: 'as yet unclassified' stamp: 'ET 6/28/2021 19:52:15' prior: 51133390!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (StoreClientWindowModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !

!classRenamed: #WordsRestInterface as: #StoreClientRestInterface stamp: 'ET 6/28/2021 19:52:56'!
Smalltalk renameClassNamed: #WordsRestInterface as: #StoreClientRestInterface!
!StoreClientWindowModel methodsFor: 'as yet unclassified' stamp: 'ET 6/28/2021 19:52:57' prior: 51133536 overrides: 16896425!
initialize

	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.! !

Panel subclass: #LogInWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

!classDefinition: #LogInWindow category: 'TusLibros-Client' stamp: 'ET 6/28/2021 19:53:40'!
Panel subclass: #LogInWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

LogInWindow class
	instanceVariableNames: ''!

!classDefinition: 'LogInWindow class' category: 'TusLibros-Client' stamp: 'ET 6/28/2021 19:53:40'!
LogInWindow class
	instanceVariableNames: ''!
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 19:53:40' overrides: 51119131!
defaultExtent

	^ 1035@485
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 19:53:40'!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (StoreClientWindowModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!LogInWindow methodsFor: 'access' stamp: 'ET 6/28/2021 19:53:40'!
refreshListOfWords
	
	wordsListMorph updateList.
	wordsListMorph setSelectionIndex: 0.
	! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 19:53:40'!
build1stColumn2ndRow
	| firstColumnLayoutMorphOfSecondRow |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
		
	firstColumnLayoutMorphOfSecondRow := LayoutMorph newColumn.
	firstColumnLayoutMorphOfSecondRow separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Results');
	addMorph: wordsListMorph.
	
	"Dos opciones para jugar con los layouts... ¿Qué diferencia hay?"
	firstColumnLayoutMorphOfSecondRow layoutSpec fixedWidth: 390.
	"wordsListMorph layoutSpec proportionalWidth: 100.
	wordsListMorph layoutSpec proportionalHeight: 100."
		
	^firstColumnLayoutMorphOfSecondRow.
	! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 19:53:40'!
build1stRow
	| sendRequestButtonMorph firstRowLayoutMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendWordsFromSentenceRequest  label: 'Send Request To Server'.
	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter sentence:');
	addMorph: sentenceTextBoxMorph;
 	addMorph: sendRequestButtonMorph.
	
	^firstRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 19:53:40'!
build2ndRow
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'Show Selected Word In Transcript'.	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self build1stColumn2ndRow;
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 19:53:40' overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow.
	! !
!LogInWindow class methodsFor: 'instance creation' stamp: 'ET 6/28/2021 19:53:40'!
open
	
	^self new initializeWith: 'Words-Service Client Window'.! !
!LogInWindow class methodsFor: 'instance creation' stamp: 'ET 6/28/2021 19:54:34' prior: 51136929!
open
	
	^self new initializeWith: 'Store Client Window'.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 19:57:25' prior: 51136875!
build1stRow
	| sendRequestButtonMorph firstRowLayoutMorph |
	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter sentence:');
	addMorph: sentenceTextBoxMorph;
 	addMorph: sendRequestButtonMorph.
	
	^firstRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 19:57:48' prior: 51136940!
build1stRow
	| sendRequestButtonMorph firstRowLayoutMorph |
	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter sentence:');
	addMorph: sentenceTextBoxMorph;
 	addMorph: sendRequestButtonMorph.
	
	^firstRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 19:59:07' prior: 51136964!
build1stRow
	| sendRequestButtonMorph firstRowLayoutMorph |
	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: sentenceTextBoxMorph;

	^firstRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 19:59:11' prior: 51136988!
build1stRow
	| firstRowLayoutMorph |
	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: sentenceTextBoxMorph.

	^firstRowLayoutMorph.! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:00:37' prior: 51137011!
build1stRow
	| firstRowLayoutMorph |
	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 100.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: sentenceTextBoxMorph.

	^firstRowLayoutMorph.! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:01:11' prior: 51137033!
build1stRow
	| firstRowLayoutMorph |
	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: sentenceTextBoxMorph.

	^firstRowLayoutMorph.! !

LogInWindow open. !

Panel subclass: #LogInWindow
	instanceVariableNames: 'usernameTextBoxMorph  passwordTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

!classDefinition: #LogInWindow category: 'TusLibros-Client' stamp: 'ET 6/28/2021 20:01:57'!
Panel subclass: #LogInWindow
	instanceVariableNames: 'usernameTextBoxMorph passwordTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

Panel subclass: #LogInWindow
	instanceVariableNames: 'sentenceTextBoxMorph passwordTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

!classDefinition: #LogInWindow category: 'TusLibros-Client' stamp: 'ET 6/28/2021 20:02:44'!
Panel subclass: #LogInWindow
	instanceVariableNames: 'sentenceTextBoxMorph passwordTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

!classDefinition: #LogInWindow category: 'TusLibros-Client' stamp: 'ET 6/28/2021 20:02:51'!
Panel subclass: #LogInWindow
	instanceVariableNames: 'usernameTextBoxMorph passwordTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!LogInWindow methodsFor: 'as yet unclassified' stamp: 'ET 6/28/2021 20:02:51' prior: 51137056!
build1stRow
	| firstRowLayoutMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	usernameTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph textMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: usernameTextBoxMorph.

	^firstRowLayoutMorph.! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:03:53' prior: 51136903!
build2ndRow
	| secondRowLayoutMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	usernameTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph textMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: usernameTextBoxMorph.

	^secondRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:04:23' prior: 51137141!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	passwordTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph textMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter password:');
	addMorph: passwordTextBoxMorph.

	^secondRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:04:34' prior: 51137164!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	passwordTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph textMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter password:');
	addMorph: passwordTextBoxMorph.

	^secondRowLayoutMorph.! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:05:39' prior: 51136921 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 5;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow.
	! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:06:50' prior: 51137211 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow.
	! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:07:08' prior: 51137118!
build1stRow
	| firstRowLayoutMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	usernameTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph textMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 10;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: usernameTextBoxMorph.

	^firstRowLayoutMorph.! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:08:26' prior: 51137228!
build1stRow
	| firstRowLayoutMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	usernameTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph textMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: usernameTextBoxMorph.

	^firstRowLayoutMorph.! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:10:28' prior: 51136825 overrides: 51119131!
defaultExtent

	^ 564@184
	! !

LogInWindow open.!
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:11:16' prior: 51137274 overrides: 51119131!
defaultExtent

	^ 567@242
	! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:12:13'!
build3rdRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	passwordTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph textMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter password:');
	addMorph: passwordTextBoxMorph.

	^secondRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:13:10' prior: 51137284!
build3rdRow
	| secondRowLayoutMorph sendRequestButtonMorph |	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendWordsFromSentenceRequest  label: 'Log in'.
	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter password:');
	addMorph: passwordTextBoxMorph.

	^secondRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:13:27' prior: 51137307!
build3rdRow
	| sendRequestButtonMorph |	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendWordsFromSentenceRequest  label: 'Log in'.
	
	
	^sendRequestButtonMorph! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:14:12' prior: 51137220 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	
	addMorph: self build3rdRow.
	! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:15:01'!
build4thRow
	| sendRequestButtonMorph |	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendWordsFromSentenceRequest  label: 'Log in'.
	
	
	^sendRequestButtonMorph! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:15:38' prior: 51137344!
build4thRow
	
	
	^(LabelMorph contents:'err').! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:15:54' prior: 51137335 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	
	addMorph: self build3rdRow;
	
	addMorph: self build4thRow.
	! !

LogInWindow open.!
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:16:27' prior: 51137280 overrides: 51119131!
defaultExtent

	^ 567@328
	! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:17:22' prior: 51137251!
build1stRow
	| firstRowLayoutMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph textMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: usernameTextBoxMorph.

	^firstRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:17:34' prior: 51137187!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph textMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter password:');
	addMorph: passwordTextBoxMorph.

	^secondRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:17:47' prior: 51137324!
build3rdRow
	| sendRequestButtonMorph |	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #logInRequest  label: 'Log in'.
	
	
	^sendRequestButtonMorph! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:18:10' prior: 51137420!
build3rdRow
	| sendRequestButtonMorph |	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #createCartRequest  label: 'Create cart'.
	
	
	^sendRequestButtonMorph! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:24:43' prior: 51136829!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (StoreClientWindowModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #successfulLogIn send: #changeToStoreClientWindow to: self.
	
	self model when: #failedLogIn send: #showFailedLogInError to: self.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:25:06'!
showFailedLogInError

	
	! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:27:43' prior: 51137359 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	
	addMorph: self build3rdRow.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:28:06' prior: 51137455!
showFailedLogInError

	self addMorph: self build4thRow.

	
	! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:04:34' prior: 51137397!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	passwordTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph textMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter password:');
	addMorph: passwordTextBoxMorph.

	^secondRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:08:26' prior: 51137375!
build1stRow
	| firstRowLayoutMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	usernameTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph textMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: usernameTextBoxMorph.

	^firstRowLayoutMorph.! !

LogInWindow open.!

LogInWindow open.!

self showFailedLogInError !

self showFailedLogInError !

self showFailedLogInError !

self showFailedLogInError !

self showFailedLogInError !

self showFailedLogInError !

self showFailedLogInError !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:17:34' prior: 51137475!
build2ndRow
	| secondRowLayoutMorph |
	
	passwordTextBoxMorph := TextModelMorph textProvider: self model textGetter: #passwordText textSetter: #passwordText:. 
	passwordTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | passwordTextBoxMorph textMorph acceptContents ] .
	passwordTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter password:');
	addMorph: passwordTextBoxMorph.

	^secondRowLayoutMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:17:22' prior: 51137498!
build1stRow
	| firstRowLayoutMorph |
	
	usernameTextBoxMorph := TextModelMorph textProvider: self model textGetter: #usernameText textSetter: #usernameText:. 
	usernameTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | usernameTextBoxMorph textMorph acceptContents ] .
	usernameTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300; morphHeight: 10.
	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter username:');
	addMorph: usernameTextBoxMorph.

	^firstRowLayoutMorph.! !

Object subclass: #LogInWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

!classDefinition: #LogInWindowModel category: 'TusLibros-Client' stamp: 'ET 6/28/2021 20:31:13'!
Object subclass: #LogInWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

LogInWindowModel class
	instanceVariableNames: ''!

!classDefinition: 'LogInWindowModel class' category: 'TusLibros-Client' stamp: 'ET 6/28/2021 20:31:13'!
LogInWindowModel class
	instanceVariableNames: ''!
!LogInWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 6/28/2021 20:31:13'!
words
	
	^words.
! !
!LogInWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 6/28/2021 20:31:13'!
wordsListIndex
	
	^selectedIndex.! !
!LogInWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 6/28/2021 20:31:13'!
wordsListIndex: anIndex
	
	selectedIndex := anIndex.! !
!LogInWindowModel methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:31:13' overrides: 16896425!
initialize

	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.! !
!LogInWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 6/28/2021 20:31:13'!
sentenceText
	
	^sentence.! !
!LogInWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 6/28/2021 20:31:13'!
sentenceText: aSentence

	sentence := aSentence.
	^true.! !
!LogInWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 20:31:14'!
sendWordsFromSentenceRequest
		
	words := restInterface sendRequest: sentence.
	
	self triggerEvent: #newWordsArrived with: self.
	! !
!LogInWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 20:31:14'!
showWordInTranscript
	
	(selectedIndex = 0) ifFalse: 
		[TranscriptWindow openTranscript.
		Transcript clear.
		Transcript show: 'The word selected is: '.
		Transcript show: (words at: selectedIndex).
		Transcript show: ' '.].
! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:31:37' prior: 51137439!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (LogInWindowModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #successfulLogIn send: #changeToStoreClientWindow to: self.
	
	self model when: #failedLogIn send: #showFailedLogInError to: self.
	! !
!LogInWindowModel methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:31:50' prior: 51137607 overrides: 16896425!
initialize

	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.! !

Object subclass: #LogInWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface username password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

!classDefinition: #LogInWindowModel category: 'TusLibros-Client' stamp: 'ET 6/28/2021 20:31:55'!
Object subclass: #LogInWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface username password'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

Object subclass: #LogInWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface username password errormsg'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

!classDefinition: #LogInWindowModel category: 'TusLibros-Client' stamp: 'ET 6/28/2021 20:32:16'!
Object subclass: #LogInWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface username password errormsg'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

Object subclass: #LogInWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface username password errorMessage'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!

!classDefinition: #LogInWindowModel category: 'TusLibros-Client' stamp: 'ET 6/28/2021 20:32:22'!
Object subclass: #LogInWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface username password errorMessage'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!LogInWindowModel methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:33:00' prior: 51137660 overrides: 16896425!
initialize

	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	
	username := ''.
	
	password := ''.
	
	! !
!LogInWindowModel methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:33:07' prior: 51137716 overrides: 16896425!
initialize

	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	
	username := ''.
	
	password := ''.
	
	errorMessage := ''.! !
!LogInWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 6/28/2021 20:33:29'!
usernameText
	
	^username.! !
!LogInWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 6/28/2021 20:33:41'!
usernameText: aUsername
	
	username := aUsername.! !
!LogInWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 6/28/2021 20:33:48' prior: 51137740!
usernameText: aUsername
	
	username := aUsername.
	
	^true.! !
!LogInWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 6/28/2021 20:34:05'!
passwordText: aPassword
	
	password := aPassword.
	
	^true.! !
!LogInWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 6/28/2021 20:34:17'!
passwordText
	
	^password.! !

LogInWindow open.!
!LogInWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 20:36:46'!
createCartRequest
	|cartID|
	
	cartID := restInterface sendRequest: sentence.
	
	self triggerEvent: #newWordsArrived with: self.
	! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 20:37:51'!
createCartFor: aUser password: aPassword

	| fieldDict resp urlEncodedSentence sentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !

{'hola'. 'chau'.}!

{'hola'. 'chau'.}!
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 20:42:03' prior: 51137768!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 20:42:14' prior: 51137788!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 20:42:22' prior: 51137804!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !

LogInWindow open.!

StoreRestInterface listeningOn: 8080!

LogInWindow open.!
!LogInWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 20:44:20' prior: 51137760!
createCartRequest
	|cartID|
	
	cartID := restInterface createCartFor: username password: password.
	
	self triggerEvent: #newWordsArrived with: self.
	! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 20:44:48' prior: 51137820!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !

StoreRestInterface allInstances !
!LogInWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 20:49:55' prior: 51137839!
createCartRequest
	|cartID|
	
	[cartID := restInterface createCartFor: username password: password]
	on: Error
	do: [:anError | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].
	
	self triggerEvent: #successfulLogIn with: self.
	! !
!LogInWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 20:50:13' prior: 51137865!
createCartRequest
	|cartID|
	
	[cartID := restInterface createCartFor: username password: password.
	self triggerEvent: #successfulLogIn with: self.]
	on: Error
	do: [:anError | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].

	! !
!LogInWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 20:50:22' prior: 51137877!
createCartRequest
	|cartID|
	
	[cartID := restInterface createCartFor: username password: password.
	self triggerEvent: #successfulLogIn with: self.
	^cartID]
	on: Error
	do: [:anError | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].

	! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 20:51:10' prior: 51137848!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: (WebUtils jsonDecode: ((resp content) readStream))].! !

LogInWindow open.!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 20:51:57' prior: 51137354!
build4thRow
	
	
	^(LabelMorph contents: self model errorMessage).! !
!LogInWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 6/28/2021 20:52:26'!
errorMessage
	^errorMessage.! !

LogInWindow open.!
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 20:53:00' prior: 51137901!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !

LogInWindow open.!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 20:55:32' prior: 51136600!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin')
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	userCreditCards := Dictionary with: 'admin'-> (CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next).
	
	userCarts := Dictionary new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		cartID := store createCartFor: client authenticatedWith: password.
		
		userCarts add: cartID->client.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request sendResponseCode: 400 
		content: anError messageText asUtf8
		type: 'text/html; charset=utf-8'
		close: true. ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/removeFromCart' action:[:request | |answerAsJson cartID item  |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		
		store removeFromCart: cartID allItems: item.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/removeFromCart' action:[:request | |answerAsJson catalog  |
		
		[catalog := store itemCatalog.
		
		answerAsJson:= WebUtils jsonEncode: (catalog asArray).
		request send200Response: (answerAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.

		transactionID := store checkoutCart: cartID creditCard:  (self creditCardOfClient: (userCarts at: cartID)).
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !

StoreRestInterface allInstances !

self destroy!

self destroy!

StoreRestInterface allInstances !

StoreRestInterface allInstances !

StoreRestInterface allInstances !

self destroy!

----SNAPSHOT----(28 June 2021 20:57:01) CuisUniversity-4532.image priorSource: 25654849!

----SNAPSHOT----(28 June 2021 20:57:09) CuisUniversity-4532.image priorSource: 25806957!

----STARTUP---- (28 June 2021 20:57:18) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!


StoreRestInterface listeningOn: 8080.!

LogInWindow open!

!classDefinition: #LogInWindow category: 'TusLibros-Client' stamp: 'ET 6/28/2021 21:01:25'!
Panel subclass: #LogInWindow
	instanceVariableNames: 'usernameTextBoxMorph passwordTextBoxMorph wordsListMorph errorMessageMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:01:23' prior: 51137918!
build4thRow
	
	errorMessageMorph := (LabelMorph contents: '').
	^errorMessageMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:01:40' prior: 51137460 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	
	addMorph: self build3rdRow;
	
	addMorph: self build4thRow.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:02:04' prior: 51137469!
showFailedLogInError

	errorMessageMorph contents: self model errorMessage.

	
	! !

LogInWindow open!
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:03:50'!
changeToStoreClientWindow
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:04:04' prior: 51138162!
changeToStoreClientWindow

	StoreClientWindow open.
	! !

LogInWindow open!
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:04:36' prior: 51138166!
changeToStoreClientWindow

	StoreClientWindow open.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:04:45' prior: 51138172!
changeToStoreClientWindow

	StoreClientWindow open.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:04:52' prior: 51138177!
changeToStoreClientWindow

	StoreClientWindow open.
	! !

self closeBoxHit!
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:07:36' prior: 51138182!
changeToStoreClientWindow

	StoreClientWindow open.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:08:00' prior: 51138188!
changeToStoreClientWindow

	StoreClientWindow open.
	
	self delete.! !

LogInWindow open!

LogInWindow allInstances !
!StoreClientWindow class methodsFor: 'instance creation' stamp: 'ET 6/28/2021 21:11:45'!
openWith: cartID
	
	^self new initializeWith: cartID.! !

!classDefinition: #StoreClientWindow category: 'TusLibros-Client' stamp: 'ET 6/28/2021 21:12:34'!
Panel subclass: #StoreClientWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph cartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:12:32' prior: 51136778!
initializeWith: aCartID
	cartID := aCartID
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel new).
	
	self morphExtent: (self defaultExtent).
	
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:21:23' prior: 51133483 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:21:36'!
build1stColumn
	| sendRequestButtonMorph firstRowLayoutMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendWordsFromSentenceRequest  label: 'Send Request To Server'.
	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter sentence:');
	addMorph: sentenceTextBoxMorph;
 	addMorph: sendRequestButtonMorph.
	
	^firstRowLayoutMorph.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:24:44' prior: 51138238!
build1stColumn
	| firstRowLayoutMorph |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Catalog');
	addMorph: wordsListMorph.

	
	^firstRowLayoutMorph.! !

----End fileIn of C:\Users\ezequ\Desktop\windows64\Wor.st----!

StoreClientWindow openWith: 2.!

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:26:33' prior: 51138214!
initializeWith: aCartID
	cartID := aCartID.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel new).
	
	self morphExtent: (self defaultExtent).
	
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:27:07' prior: 51138230 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn;
	addMorph: self build2ndRow.
	! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:27:57'!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'Show Selected Word In Transcript'.	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self build1stColumn2ndRow;
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:28:13' prior: 51138559!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self build1stColumn2ndRow;
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:29:45' prior: 51138577!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	

	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self build1stColumn2ndRow;
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:30:29' prior: 51138594!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	

	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:31:10' prior: 51138611!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:31:30' prior: 51138550 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn;
	addMorph: self build2ndColumn.
	! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:32:07' prior: 51138629!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 10; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:32:30' prior: 51138669!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 50; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:33:02' prior: 51138700!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:34:05'!
build3rdColumn
	| firstRowLayoutMorph |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: wordsListMorph.

	
	^firstRowLayoutMorph.! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:34:24' prior: 51138660 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn;
	addMorph: self build2ndColumn;
	
	addMorph: self build3rdColumn.
	! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:36:22' prior: 51138761!
build3rdColumn
	| firstRowLayoutMorph showInTranscriptButtonMorph|
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: wordsListMorph;
	addMorph: showInTranscriptButtonMorph.

	
	^firstRowLayoutMorph.! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:36:51' prior: 51138791!
build3rdColumn
	| firstRowLayoutMorph showInTranscriptButtonMorph|
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'remove from cart'.	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: wordsListMorph;
	addMorph: showInTranscriptButtonMorph.

	
	^firstRowLayoutMorph.! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:38:58' prior: 51138816!
build3rdColumn
	| firstRowLayoutMorph showInTranscriptButtonMorph|
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'remove from cart'.	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: wordsListMorph;
	addMorph: showInTranscriptButtonMorph.

	
	^firstRowLayoutMorph.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:39:02' prior: 51138267!
build1stColumn
	| firstRowLayoutMorph |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'Catalog');
	addMorph: wordsListMorph.

	
	^firstRowLayoutMorph.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:39:07' prior: 51138731!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:39:21' prior: 51138885!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

StoreClientWindow openWith: 2.!
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:39:47' prior: 51138534!
initializeWith: aCartID
	cartID := aCartID.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel new).
	
	self morphExtent: (self defaultExtent).
	
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
	
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:41:22' prior: 51138947!
initializeWith: aCartID
	cartID := aCartID.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel new).
	
	self morphExtent: (self defaultExtent).
	
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:42:04' prior: 51138867!
build1stColumn
	| firstRowLayoutMorph |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #items indexGetter: #itemsListIndex indexSetter: #itemsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'Catalog');
	addMorph: wordsListMorph.

	
	^firstRowLayoutMorph.! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 6/28/2021 21:42:22'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 6/28/2021 21:42:20'!
items
	
	^items.
! !
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 6/28/2021 21:42:29'!
itemsListIndex
	
	^selectedIndex.! !
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 6/28/2021 21:42:35'!
itemsListIndex: anIndex
	
	selectedIndex := anIndex.! !
!StoreClientWindowModel methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:42:53' prior: 51136798 overrides: 16896425!
initialize
	items := OrderedCollection new.
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.! !
!StoreClientWindowModel methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:43:20' prior: 51139019 overrides: 16896425!
initialize
	items := OrderedCollection new.
	
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	items := restInterface catalog.! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 21:44:04'!
catalog

	| resp |

	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: Dictionary new.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:44:32' prior: 51137944!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin')
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	userCreditCards := Dictionary with: 'admin'-> (CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next).
	
	userCarts := Dictionary new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		cartID := store createCartFor: client authenticatedWith: password.
		
		userCarts add: cartID->client.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request sendResponseCode: 400 
		content: anError messageText asUtf8
		type: 'text/html; charset=utf-8'
		close: true. ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/removeFromCart' action:[:request | |answerAsJson cartID item  |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		
		store removeFromCart: cartID allItems: item.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/catalog' action:[:request | |answerAsJson catalog  |
		
		[catalog := store itemCatalog.
		
		answerAsJson:= WebUtils jsonEncode: (catalog asArray).
		request send200Response: (answerAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.

		transactionID := store checkoutCart: cartID creditCard:  (self creditCardOfClient: (userCarts at: cartID)).
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 21:45:06' prior: 51139039!
catalog

	| resp |

	resp:= WebClient htmlSubmit: (self url,'/catalog') fields: Dictionary new.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection.] 
		ifFalse:[^self error: resp content].! !

StoreClientWindow openWith: 2.!

StoreRestInterface listeningOn: 8080.!

LogInWindow open!

----STARTUP---- (28 June 2021 21:47:02) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!


!classDefinition: #LogInWindow category: 'TusLibros-Client' stamp: 'ET 6/28/2021 21:47:04'!
Panel subclass: #LogInWindow
	instanceVariableNames: 'usernameTextBoxMorph passwordTextBoxMorph wordsListMorph errorMessageMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:01:23' prior: 51137918!
build4thRow
	
	errorMessageMorph := (LabelMorph contents: '').
	^errorMessageMorph.! !
!LogInWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:01:40' prior: 51137460 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow;
	
	addMorph: self build3rdRow;
	
	addMorph: self build4thRow.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:02:04' prior: 51137469!
showFailedLogInError

	errorMessageMorph contents: self model errorMessage.

	
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:03:50'!
changeToStoreClientWindow
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:04:04' prior: 51139268!
changeToStoreClientWindow

	StoreClientWindow open.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:04:36' prior: 51139272!
changeToStoreClientWindow

	StoreClientWindow open.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:04:45' prior: 51139277!
changeToStoreClientWindow

	StoreClientWindow open.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:04:52' prior: 51139282!
changeToStoreClientWindow

	StoreClientWindow open.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:07:36' prior: 51139287!
changeToStoreClientWindow

	StoreClientWindow open.
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:08:00' prior: 51139292!
changeToStoreClientWindow

	StoreClientWindow open.
	
	self delete.! !
!StoreClientWindow class methodsFor: 'instance creation' stamp: 'ET 6/28/2021 21:11:45'!
openWith: cartID
	
	^self new initializeWith: cartID.! !

!classDefinition: #StoreClientWindow category: 'TusLibros-Client' stamp: 'ET 6/28/2021 21:47:05'!
Panel subclass: #StoreClientWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph cartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:12:32' prior: 51136778!
initializeWith: aCartID
	cartID := aCartID
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel new).
	
	self morphExtent: (self defaultExtent).
	
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:21:23' prior: 51133483 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:21:36'!
build1stColumn
	| sendRequestButtonMorph firstRowLayoutMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendWordsFromSentenceRequest  label: 'Send Request To Server'.
	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter sentence:');
	addMorph: sentenceTextBoxMorph;
 	addMorph: sendRequestButtonMorph.
	
	^firstRowLayoutMorph.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:24:44' prior: 51139340!
build1stColumn
	| firstRowLayoutMorph |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Catalog');
	addMorph: wordsListMorph.

	
	^firstRowLayoutMorph.! !

!classDefinition: #WordsClientWindow category: 'WordsClientDemo' stamp: 'ET 6/28/2021 21:47:05'!
Panel subclass: #WordsClientWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!

!classDefinition: #WordsClientWindow category: 'WordsClientDemo' stamp: 'ET 6/28/2021 21:47:05'!
Panel subclass: #WordsClientWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!
!WordsClientWindow methodsFor: 'initialization' stamp: 'NR 6/22/2021 08:25:04' overrides: 51119131!
defaultExtent

	^ 1035@485
	! !
!WordsClientWindow methodsFor: 'initialization' stamp: 'NR 6/23/2021 06:54:42'!
initializeWith: aTitle

	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: aTitle.
	self model: (WordsClientWindowModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!WordsClientWindow methodsFor: 'access' stamp: 'NR 6/23/2021 06:58:02'!
refreshListOfWords
	
	wordsListMorph updateList.
	wordsListMorph setSelectionIndex: 0.
	! !
!WordsClientWindow methodsFor: 'GUI building' stamp: 'NR 6/28/2021 19:01:09'!
build1stColumn2ndRow
	| firstColumnLayoutMorphOfSecondRow |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.
		
	firstColumnLayoutMorphOfSecondRow := LayoutMorph newColumn.
	firstColumnLayoutMorphOfSecondRow separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Results');
	addMorph: wordsListMorph.
	
	"Dos opciones para jugar con los layouts... ¿Qué diferencia hay?"
	firstColumnLayoutMorphOfSecondRow layoutSpec fixedWidth: 390.
	"wordsListMorph layoutSpec proportionalWidth: 100.
	wordsListMorph layoutSpec proportionalHeight: 100."
		
	^firstColumnLayoutMorphOfSecondRow.
	! !
!WordsClientWindow methodsFor: 'GUI building' stamp: 'NR 6/28/2021 18:34:12'!
build1stRow
	| sendRequestButtonMorph firstRowLayoutMorph |
	
	sendRequestButtonMorph := PluggableButtonMorph model: self model stateGetter: nil action: #sendWordsFromSentenceRequest  label: 'Send Request To Server'.
	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
		
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Enter sentence:');
	addMorph: sentenceTextBoxMorph;
 	addMorph: sendRequestButtonMorph.
	
	^firstRowLayoutMorph.! !
!WordsClientWindow methodsFor: 'GUI building' stamp: 'NR 6/23/2021 06:37:31'!
build2ndRow
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'Show Selected Word In Transcript'.	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self build1stColumn2ndRow;
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!WordsClientWindow methodsFor: 'GUI building' stamp: 'NR 6/22/2021 05:23:32' overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow.
	! !

!classDefinition: 'WordsClientWindow class' category: 'WordsClientDemo' stamp: 'ET 6/28/2021 21:47:06'!
WordsClientWindow class
	instanceVariableNames: ''!

!classDefinition: 'WordsClientWindow class' category: 'WordsClientDemo' stamp: 'ET 6/28/2021 21:47:06'!
WordsClientWindow class
	instanceVariableNames: ''!
!WordsClientWindow class methodsFor: 'instance creation' stamp: 'NR 6/23/2021 06:32:18'!
open
	
	^self new initializeWith: 'Words-Service Client Window'.! !

!classDefinition: #WordsClientWindowModel category: 'WordsClientDemo' stamp: 'ET 6/28/2021 21:47:06'!
Object subclass: #WordsClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!

!classDefinition: #WordsClientWindowModel category: 'WordsClientDemo' stamp: 'ET 6/28/2021 21:47:06'!
Object subclass: #WordsClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!
!WordsClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'NR 6/23/2021 06:56:13'!
words
	
	^words.
! !
!WordsClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'NR 6/23/2021 06:56:37'!
wordsListIndex
	
	^selectedIndex.! !
!WordsClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'NR 6/23/2021 06:56:49'!
wordsListIndex: anIndex
	
	selectedIndex := anIndex.! !
!WordsClientWindowModel methodsFor: 'initialization' stamp: 'NR 6/23/2021 07:56:07' overrides: 16896425!
initialize

	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := WordsRestInterface new.! !
!WordsClientWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'NR 6/25/2019 21:43:32'!
sentenceText
	
	^sentence.! !
!WordsClientWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'NR 6/23/2021 07:08:56'!
sentenceText: aSentence

	sentence := aSentence.
	^true.! !
!WordsClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'NR 6/23/2021 07:56:07'!
sendWordsFromSentenceRequest
		
	words := restInterface sendRequest: sentence.
	
	self triggerEvent: #newWordsArrived with: self.
	! !
!WordsClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'NR 6/23/2021 06:51:02'!
showWordInTranscript
	
	(selectedIndex = 0) ifFalse: 
		[TranscriptWindow openTranscript.
		Transcript clear.
		Transcript show: 'The word selected is: '.
		Transcript show: (words at: selectedIndex).
		Transcript show: ' '.].
! !

!classDefinition: #WordsRestInterface category: 'WordsClientDemo' stamp: 'ET 6/28/2021 21:47:06'!
Object subclass: #WordsRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!

!classDefinition: #WordsRestInterface category: 'WordsClientDemo' stamp: 'ET 6/28/2021 21:47:06'!
Object subclass: #WordsRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'WordsClientDemo'!
!WordsRestInterface methodsFor: 'sending requests' stamp: 'NR 6/25/2019 22:25:36'!
correctlyEncodeSpacesForUrlRequestParameter: aParameter
	
	^ aParameter copyReplaceAll: ' ' with: '%20'. ! !
!WordsRestInterface methodsFor: 'sending requests' stamp: 'NR 6/23/2021 07:54:44'!
sendRequest: sentence

	| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !
!WordsRestInterface methodsFor: 'initialization' stamp: 'NR 6/25/2019 22:15:16'!
port
	
	^port ifNil: [port:=8080].! !
!WordsRestInterface methodsFor: 'initialization' stamp: 'NR 6/24/2019 06:52:37'!
url
	
	^'http://localhost:', self port asString! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:26:33' prior: 51139316!
initializeWith: aCartID
	cartID := aCartID.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel new).
	
	self morphExtent: (self defaultExtent).
	
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:27:07' prior: 51139332 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn;
	addMorph: self build2ndRow.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:27:57'!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'Show Selected Word In Transcript'.	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self build1stColumn2ndRow;
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:28:13' prior: 51139666!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self build1stColumn2ndRow;
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:29:45' prior: 51139684!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	

	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: self build1stColumn2ndRow;
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:30:29' prior: 51139701!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	

	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:31:10' prior: 51139718!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 300. 
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:31:30' prior: 51139658 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn;
	addMorph: self build2ndColumn.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:32:07' prior: 51139736!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 10; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:32:30' prior: 51139774!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 50; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:33:02' prior: 51139804!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:34:05'!
build3rdColumn
	| firstRowLayoutMorph |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: wordsListMorph.

	
	^firstRowLayoutMorph.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:34:24' prior: 51139766 overrides: 51119045!
buildMorphicWindow
		
	self layoutMorph beRow;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stColumn;
	addMorph: self build2ndColumn;
	
	addMorph: self build3rdColumn.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:36:22' prior: 51139863!
build3rdColumn
	| firstRowLayoutMorph showInTranscriptButtonMorph|
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: wordsListMorph;
	addMorph: showInTranscriptButtonMorph.

	
	^firstRowLayoutMorph.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:36:51' prior: 51139891!
build3rdColumn
	| firstRowLayoutMorph showInTranscriptButtonMorph|
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'remove from cart'.	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: wordsListMorph;
	addMorph: showInTranscriptButtonMorph.

	
	^firstRowLayoutMorph.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:38:58' prior: 51139915!
build3rdColumn
	| firstRowLayoutMorph showInTranscriptButtonMorph|
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'remove from cart'.	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: wordsListMorph;
	addMorph: showInTranscriptButtonMorph.

	
	^firstRowLayoutMorph.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:39:02' prior: 51139369!
build1stColumn
	| firstRowLayoutMorph |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'Catalog');
	addMorph: wordsListMorph.

	
	^firstRowLayoutMorph.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:39:07' prior: 51139834!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:39:21' prior: 51139983!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:39:47' prior: 51139642!
initializeWith: aCartID
	cartID := aCartID.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel new).
	
	self morphExtent: (self defaultExtent).
	
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
	
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:41:22' prior: 51140043!
initializeWith: aCartID
	cartID := aCartID.
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel new).
	
	self morphExtent: (self defaultExtent).
	
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:42:04' prior: 51139965!
build1stColumn
	| firstRowLayoutMorph |
	
	wordsListMorph := PluggableListMorph model: self model listGetter: #items indexGetter: #itemsListIndex indexSetter: #itemsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'Catalog');
	addMorph: wordsListMorph.

	
	^firstRowLayoutMorph.! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 6/28/2021 21:47:08'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 6/28/2021 21:42:20'!
items
	
	^items.
! !
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 6/28/2021 21:42:29'!
itemsListIndex
	
	^selectedIndex.! !
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 6/28/2021 21:42:35'!
itemsListIndex: anIndex
	
	selectedIndex := anIndex.! !
!StoreClientWindowModel methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:42:53' prior: 51136798 overrides: 16896425!
initialize
	items := OrderedCollection new.
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.! !
!StoreClientWindowModel methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:43:20' prior: 51140115 overrides: 16896425!
initialize
	items := OrderedCollection new.
	
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	items := restInterface catalog.! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 21:44:04'!
catalog

	| resp |

	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: Dictionary new.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:44:32' prior: 51137944!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin')
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	userCreditCards := Dictionary with: 'admin'-> (CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next).
	
	userCarts := Dictionary new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		cartID := store createCartFor: client authenticatedWith: password.
		
		userCarts add: cartID->client.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request sendResponseCode: 400 
		content: anError messageText asUtf8
		type: 'text/html; charset=utf-8'
		close: true. ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/removeFromCart' action:[:request | |answerAsJson cartID item  |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		
		store removeFromCart: cartID allItems: item.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/catalog' action:[:request | |answerAsJson catalog  |
		
		[catalog := store itemCatalog.
		
		answerAsJson:= WebUtils jsonEncode: (catalog asArray).
		request send200Response: (answerAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.

		transactionID := store checkoutCart: cartID creditCard:  (self creditCardOfClient: (userCarts at: cartID)).
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 21:45:06' prior: 51140135!
catalog

	| resp |

	resp:= WebClient htmlSubmit: (self url,'/catalog') fields: Dictionary new.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection.] 
		ifFalse:[^self error: resp content].! !

----SNAPSHOT----(28 June 2021 21:48:58) CuisUniversity-4532.image priorSource: 25807047!

----SNAPSHOT----(28 June 2021 21:49:04) CuisUniversity-4532.image priorSource: 25877591!

----STARTUP---- (28 June 2021 21:49:14) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!


StoreRestInterface listeningOn: 8080!

LogInWindow open!
!StoreClientWindowModel methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:50:36' prior: 51140125 overrides: 16896425!
initialize	
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	items := restInterface catalog.! !

!classDefinition: #StoreClientWindow category: 'TusLibros-Client' stamp: 'ET 6/28/2021 21:52:12'!
Panel subclass: #StoreClientWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph cartID quantityTextBoxMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:52:10' prior: 51140013!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	quantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	quantityTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | quantityTextBoxMorph textMorph acceptContents ] .
	quantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: quantityTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:54:05' prior: 51140356!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #addItemToCart label: 'add to cart'.	
	quantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	quantityTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | quantityTextBoxMorph textMorph acceptContents ] .
	quantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: quantityTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 6/28/2021 21:54:20' prior: 51140386!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #addItemToCart label: 'add to cart'.	
	quantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #quantityText textSetter: #quantityText:. 
	quantityTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | quantityTextBoxMorph textMorph acceptContents ] .
	quantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: quantityTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 6/28/2021 21:54:42'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items quantity'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 6/28/2021 21:54:40'!
quantityText: aQuantity

	quantity  := aQuantity.
	^true.! !
!StoreClientWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 6/28/2021 21:54:54'!
quantityText

	^quantity.! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 21:55:19'!
addItemToCart


	(selectedIndex = 0) ifFalse: 
		[TranscriptWindow openTranscript.
		Transcript clear.
		Transcript show: 'The word selected is: '.
		Transcript show: (words at: selectedIndex).
		Transcript show: ' '.].
! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 6/28/2021 21:58:01'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items quantity cartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 21:58:13' prior: 51140463!
addItemToCart
	
	
	restInterface addItem: self selectedItem toCart: cartID.
	self triggerEvent: #successfulLogIn with: self.


	(selectedIndex = 0) ifFalse: 
		[TranscriptWindow openTranscript.
		Transcript clear.
		Transcript show: 'The word selected is: '.
		Transcript show: (words at: selectedIndex).
		Transcript show: ' '.].
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 21:58:22' prior: 51140484!
addItemToCart
	
	
	restInterface addItem: self selectedItem toCart: cartID.
	self triggerEvent: #successfulLogIn with: self.


	(selectedIndex = 0) ifFalse: 
		[TranscriptWindow openTranscript.
		Transcript clear.
		Transcript show: 'The word selected is: '.
		Transcript show: (words at: selectedIndex).
		Transcript show: ' '.].
! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:59:04' prior: 51140058!
initializeWith: aCartID
	self titleMorph showButtonsNamed: #( close collapse ).
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel withCartID: aCartID).
	
	self morphExtent: (self defaultExtent).
	
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindowModel class methodsFor: 'no messages' stamp: 'ET 6/28/2021 21:59:26'!
withCartID: cartID

	^self new initializeWithCartID: cartID.! !
!StoreClientWindowModel methodsFor: 'initialization' stamp: 'ET 6/28/2021 21:59:51'!
initializeWithCartID: aCartID	
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	items := restInterface catalog.
	
	cartID := aCartID! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 6/28/2021 22:01:26'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items quantity cartID cartList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 22:01:25' prior: 51140499!
addItemToCart
	
	
	restInterface addItem: self selectedItem toCart: cartID.
	
	cartList := restInterface listCart: cartID.
	
	self triggerEvent: #updateCartList with: self.


	(selectedIndex = 0) ifFalse: 
		[TranscriptWindow openTranscript.
		Transcript clear.
		Transcript show: 'The word selected is: '.
		Transcript show: (words at: selectedIndex).
		Transcript show: ' '.].
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 22:02:12'!
selectedItem

	^items
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 22:02:30' prior: 51140570!
selectedItem

	^items at: selectedIndex.
! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 22:04:49'!
addItem: anItem toCart: cartID withQuantity: aQuantity

	| fieldDict resp |
	fieldDict := Dictionary new.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 6/28/2021 22:05:17' prior: 51140554!
addItemToCart
	
	
	restInterface addItem: self selectedItem toCart: cartID withQuantity: quantity.
	
	cartList := restInterface listCart: cartID.
	
	self triggerEvent: #updateCartList with: self.


	(selectedIndex = 0) ifFalse: 
		[TranscriptWindow openTranscript.
		Transcript clear.
		Transcript show: 'The word selected is: '.
		Transcript show: (words at: selectedIndex).
		Transcript show: ' '.].
! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 6/28/2021 22:11:04' prior: 51140580!
addItem: anItem toCart: cartID withQuantity: aQuantity

	| fieldDict resp |
	fieldDict := Dictionary new.
	
	resp:= WebClient htmlSubmit: (self url,'/addToCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !

----STARTUP---- (1 July 2021 17:06:16) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!

!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:06:29' prior: 51140315!
catalog

	| resp |

	resp:= WebClient htmlSubmit: (self url,'/catalog') fields: Dictionary new.
	
	
	
	resp isSuccess
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection.] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:06:42' prior: 51140628!
catalog

	| resp |

	resp:= WebClient htmlSubmit: (self url,'/catalog') fields: Dictionary new.
	
	
	
	resp isSuccess
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection.] 
		
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:06:44' prior: 51140639!
catalog

	| resp |
	

	resp:= WebClient htmlSubmit: (self url,'/catalog') fields: Dictionary new.
	
	
	
	resp isSuccess
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection.] 
		
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:06:48' prior: 51140651!
catalog


	| resp |
	

	resp:= WebClient htmlSubmit: (self url,'/catalog') fields: Dictionary new.
	
	
	
	resp isSuccess
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection.] 
		
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:06:54' prior: 51133584!
correctlyEncodeSpacesForUrlRequestParameter: aParameter
	
	
	^ aParameter copyReplaceAll: ' ' with: '%20'. ! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:06:57' prior: 51140675!
correctlyEncodeSpacesForUrlRequestParameter: aParameter
	
	
	^ aParameter copyReplaceAll: ' ' with: '%20'. ! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:02' prior: 51137928!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:05' prior: 51140689!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:07' prior: 51140704!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:08' prior: 51140719!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:10' prior: 51140734!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:12' prior: 51140749!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:15' prior: 51140764!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:20' prior: 51133591!
sendRequest: sentence

	| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:22' prior: 51140794!
sendRequest: sentence

	| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:24' prior: 51140812!
sendRequest: sentence


	| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:26' prior: 51140830!
sendRequest: sentence


	| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:07:44' prior: 51140848!
sendRequest: sentence


	| fieldDict resp urlEncodedSentence |

	urlEncodedSentence := self correctlyEncodeSpacesForUrlRequestParameter: sentence.	
	
	fieldDict := Dictionary newFromPairs: {'sentence'. urlEncodedSentence.}.		
	
	resp:= WebClient htmlSubmit: (self url,'/words') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection .] 
		
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:07:56' prior: 51133608!
port
	
	^port ifNil: [port:=8080].! !
!StoreClientRestInterface methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:08:00' prior: 51133612!
url
	
	^'http://localhost:', self port asString! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 7/1/2021 17:08:42' prior: 51139940!
build3rdColumn
	| firstRowLayoutMorph showInTranscriptButtonMorph|
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'remove from cart'.	
	wordsListMorph := PluggableListMorph model: self model listGetter: #words indexGetter: #wordsListIndex indexSetter: #wordsListIndex:.
	wordsListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: wordsListMorph;
	addMorph: showInTranscriptButtonMorph.

	
	^firstRowLayoutMorph.! !

server := StoreRestInterface listeningOn: 8080.!

client := LogInWindow open.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 7/1/2021 17:10:35' prior: 51140013!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	sentenceTextBoxMorph := TextModelMorph textProvider: self model textGetter: #sentenceText textSetter: #sentenceText:. 
	sentenceTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | sentenceTextBoxMorph textMorph acceptContents ] .
	sentenceTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: sentenceTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

client := LogInWindow open.!
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:20:44'!
addItemToCart
	|selectedItem|
	selectedItem := (self items) at: self itemsListIndex.
	
	
! !

LogInWindow open!
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:23:30' prior: 51140952!
addItemToCart
	|selectedItem|
	
	self assertItemIsSelected.
	
	
	selectedItem := (self items) at: self itemsListIndex.
	
	
! !

!classDefinition: #StoreClientWindow category: 'TusLibros-Client' stamp: 'ET 7/1/2021 17:25:08'!
Panel subclass: #StoreClientWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph cartID quantityTextBoxMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 7/1/2021 17:25:07' prior: 51140921!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'add to cart'.	
	quantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #quantityText textSetter: #quantityText:. 
	quantityTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | quantityTextBoxMorph textMorph acceptContents ] .
	quantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: quantityTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

LogInWindow open!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 7/1/2021 17:26:10' prior: 51140976!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #addItemToCart label: 'add to cart'.	
	quantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #quantityText textSetter: #quantityText:. 
	quantityTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | quantityTextBoxMorph textMorph acceptContents ] .
	quantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: quantityTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 7/1/2021 17:26:48'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items quantity'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 7/1/2021 17:26:46'!
quantityText: aQuantity

	quantity := aQuantity.
	
	^true.! !
!StoreClientWindowModel methodsFor: 'TextModelMorphSelectors' stamp: 'ET 7/1/2021 17:26:59'!
quantityText

	^quantity.! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:27:54' prior: 51140959!
addItemToCart
	|selectedItem|
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:28:24' prior: 51141055!
addItemToCart
	|selectedItem|
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:30:14' prior: 51141064!
addItemToCart
	|selectedItem|
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	[ | cartID |cartID := restInterface addToCart: cartID item: selectedItem quantity: quantity.
	self triggerEvent: #successfulLogIn with: self.
	^cartID]
	on: Error
	do: [:anError | | errorMessage | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].
	
	
	
	
! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:31:10' prior: 51140058!
initializeWith: aCartID

	self titleMorph showButtonsNamed: #( close collapse ).
	
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel with: aCartID).
	
	self morphExtent: (self defaultExtent).
	
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindowModel class methodsFor: 'no messages' stamp: 'ET 7/1/2021 17:31:31'!
with: aCartID

	^self new initializeWith: aCartID.! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 7/1/2021 17:32:10'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items quantity acartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:32:09'!
initializeWith: aCartID
	acartID := aCartID.
	items := OrderedCollection new.
	
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	items := restInterface catalog.! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:32:30' prior: 51141073!
addItemToCart
	|selectedItem|
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	[ restInterface addToCart: acartID item: selectedItem quantity: quantity.
	self triggerEvent: #successfulLogIn with: self.
	^acartID]
	on: Error
	do: [:anError | | errorMessage | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].
	
	
	
	
! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 7/1/2021 17:32:40'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items quantity cartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'as yet unclassified' stamp: 'ET 7/1/2021 17:32:40' prior: 51141120!
initializeWith: aCartID
	cartID := aCartID.
	items := OrderedCollection new.
	
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	items := restInterface catalog.! !
!StoreClientWindowModel methodsFor: 'as yet unclassified' stamp: 'ET 7/1/2021 17:32:40' prior: 51141131!
addItemToCart
	|selectedItem|
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	[ restInterface addToCart: cartID item: selectedItem quantity: quantity.
	self triggerEvent: #successfulLogIn with: self.
	^cartID]
	on: Error
	do: [:anError | | errorMessage | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:33:33' prior: 51141169!
addItemToCart
	|selectedItem list|
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	[restInterface addToCart: cartID item: selectedItem quantity: quantity.
	list := restInterface listCart: cartID.
	self triggerEvent: #successfulLogIn with: self.
	^cartID]
	on: Error
	do: [:anError | | errorMessage | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:34:32' prior: 51141186!
addItemToCart
	|selectedItem list|
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	[restInterface addToCart: cartID item: selectedItem quantity: quantity.
	list := restInterface listCart: cartID.
	self triggerEvent: #successfulLogIn with: self.
	^cartID]
	on: Error
	do: [:anError | | errorMessage | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].
	
	
	
	
! !

!classDefinition: #StoreClientWindow category: 'TusLibros-Client' stamp: 'ET 7/1/2021 17:35:58'!
Panel subclass: #StoreClientWindow
	instanceVariableNames: 'sentenceTextBoxMorph wordsListMorph cartID quantityTextBoxMorph cartListMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 7/1/2021 17:35:56' prior: 51140894!
build3rdColumn
	| firstRowLayoutMorph showInTranscriptButtonMorph|
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #showWordInTranscript label: 'remove from cart'.	
	cartListMorph := PluggableListMorph model: self model listGetter: #cartList indexGetter: #cartListIndex indexSetter: #cartListIndex:.
	cartListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: cartListMorph;
	addMorph: showInTranscriptButtonMorph.

	
	^firstRowLayoutMorph.! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:36:11' prior: 51141205!
addItemToCart
	|selectedItem list|
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	[list := restInterface addToCart: cartID item: selectedItem quantity: quantity.
	list := restInterface listCart: cartID.
	self triggerEvent: #successfulLogIn with: self.
	^cartID]
	on: Error
	do: [:anError | | errorMessage | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:36:48' prior: 51141258!
addItemToCart
	|selectedItem list|
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	[list := restInterface addToCart: cartID item: selectedItem quantity: quantity.
	"list := restInterface listCart: cartID."
	self triggerEvent: #successfulLogIn with: self.
	^cartID]
	on: Error
	do: [:anError | | errorMessage | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].
	
	
	
	
! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 7/1/2021 17:37:10'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items quantity cartID cartList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 7/1/2021 17:37:09'!
cartList
	
	^cartList.
! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 7/1/2021 17:37:25'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items quantity cartID cartList cartListIndex'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 7/1/2021 17:37:24'!
cartListIndex
	
	^cartListIndex.! !
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 7/1/2021 17:37:44'!
cartListIndex: anIndex
	
	cartListIndex := anIndex.
	
	^true.! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:39:14' prior: 51141277!
addItemToCart
	|selectedItem |
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	[cartList := restInterface addToCart: cartID item: selectedItem quantity: quantity.
		
	"self triggerEvent: #successfulLogIn with: self."
	"^cartID"]
	on: Error
	do: [:anError | | errorMessage | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:39:31' prior: 51141331!
addItemToCart
	|selectedItem |
	
	self assertItemIsSelected.
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	cartList := restInterface addToCart: cartID item: selectedItem quantity: quantity.
		
	"self triggerEvent: #successfulLogIn with: self."
	"^cartID"
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:39:43' prior: 51141349!
addItemToCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := (self items) at: self itemsListIndex.
	
	cartList := restInterface addToCart: cartID item: selectedItem quantity: quantity.
		
	"self triggerEvent: #successfulLogIn with: self."
	"^cartID"
	
	
	
	
! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:41:42'!
addToCart: cartID item: anItem quantity: aQuantity

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'cartId'->cartID.	
	fieldDict add: 'bookIsbn'->anItem.
	fieldDict add: 'quantityIsbn'->aQuantity.
	
	resp:= WebClient htmlSubmit: (self url,'/addToCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !

LogInWindow open!

server !

----SNAPSHOT----(1 July 2021 17:42:43) CuisUniversity-4532.image priorSource: 25877681!
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:43:14' prior: 51141376!
addToCart: cartID item: anItem quantity: aQuantity

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'cartId'->cartID.	
	fieldDict add: 'bookIsbn'->anItem.
	fieldDict add: 'quantityIsbn'->aQuantity.
	
	resp:= WebClient htmlSubmit: (self url,'/addToCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[
			self halt.
			^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:43:23' prior: 51141397!
addToCart: cartID item: anItem quantity: aQuantity

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'cartId'->cartID.	
	fieldDict add: 'bookIsbn'->anItem.
	fieldDict add: 'quantityIsbn'->aQuantity.
	
	resp:= WebClient htmlSubmit: (self url,'/addToCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[
			^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:43:32' prior: 51140779!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[
			self halt.^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !

LogInWindow open!

(WebUtils jsonDecode: ((resp content) readStream))!
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:45:23' prior: 51141431!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:46:41' prior: 51139297!
changeToStoreClientWindow
	
	self halt.
	StoreClientWindow open.
	
	self delete.! !

LogInWindow open!

LogInWindow open!
!LogInWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:50:35' prior: 51139263!
showFailedLogInError
	self halt.
	errorMessageMorph contents: self model errorMessage.

	
	! !

LogInWindow open!

----STARTUP---- (1 July 2021 17:52:42) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!

!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:43:14' prior: 51141376!
addToCart: cartID item: anItem quantity: aQuantity

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'cartId'->cartID.	
	fieldDict add: 'bookIsbn'->anItem.
	fieldDict add: 'quantityIsbn'->aQuantity.
	
	resp:= WebClient htmlSubmit: (self url,'/addToCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[
			self halt.
			^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:43:23' prior: 51141482!
addToCart: cartID item: anItem quantity: aQuantity

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'cartId'->cartID.	
	fieldDict add: 'bookIsbn'->anItem.
	fieldDict add: 'quantityIsbn'->aQuantity.
	
	resp:= WebClient htmlSubmit: (self url,'/addToCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[
			^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:43:32' prior: 51140779!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[
			self halt.^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 17:45:23' prior: 51141516!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'clientId'->aUser.	
	fieldDict add: 'password'->aPassword.
	
	resp:= WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:46:41' prior: 51139297!
changeToStoreClientWindow
	
	self halt.
	StoreClientWindow open.
	
	self delete.! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:50:35' prior: 51139263!
showFailedLogInError
	self halt.
	errorMessageMorph contents: self model errorMessage.

	
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:53:27' prior: 51141553!
showFailedLogInError

	errorMessageMorph contents: self model errorMessage.

	
	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:53:32' prior: 51141547!
changeToStoreClientWindow
	

	StoreClientWindow open.
	
	self delete.! !

!classDefinition: #LogInWindowModel category: 'TusLibros-Client' stamp: 'ET 7/1/2021 17:54:39'!
Object subclass: #LogInWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface username password errorMessage acartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!LogInWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:54:38' prior: 51137889!
createCartRequest
	
	[acartID := restInterface createCartFor: username password: password.
	self triggerEvent: #successfulLogIn with: self.]
	on: Error
	do: [:anError | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].

	! !

!classDefinition: #LogInWindowModel category: 'TusLibros-Client' stamp: 'ET 7/1/2021 17:54:43'!
Object subclass: #LogInWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface username password errorMessage acartID cartID'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!LogInWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:54:41' prior: 51141581!
createCartRequest
	
	[cartID := restInterface createCartFor: username password: password.
	self triggerEvent: #successfulLogIn with: self.]
	on: Error
	do: [:anError | errorMessage := anError messageText.
		self triggerEvent: #failedLogIn with: self.].

	! !
!LogInWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 17:55:14'!
cartID

	^cartID.

	! !
!LogInWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:55:36' prior: 51141565!
changeToStoreClientWindow
	

	StoreClientWindow with: self model cartID.
	
	self delete.! !

----SNAPSHOT----(1 July 2021 17:55:42) CuisUniversity-4532.image priorSource: 25911745!

LogInWindow open!

----SNAPSHOT----(1 July 2021 17:56:45) CuisUniversity-4532.image priorSource: 25919131!

----STARTUP---- (1 July 2021 17:56:58) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!


server := StoreRestInterface listeningOn: 8080.!

LogInWindow open!
!LogInWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:57:45' prior: 51141618!
changeToStoreClientWindow
	

	StoreClientWindow openWith: self model cartID.
	
	self delete.! !

LogInWindow open!
!StoreClientWindow class methodsFor: 'instance creation' stamp: 'ET 7/1/2021 17:58:27' prior: 51139302!
openWith: cartID
		self halt.
	^self new initializeWith: cartID.! !
!StoreClientWindow class methodsFor: 'instance creation' stamp: 'ET 7/1/2021 17:59:19' prior: 51141643!
openWith: cartID

	^self new initializeWith: cartID.! !

	self halt.!
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 17:59:37' prior: 51141091!
initializeWith: aCartID

	self titleMorph showButtonsNamed: #( close collapse ).
	
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel with: aCartID).
	
	self morphExtent: (self defaultExtent).
	self halt.
	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 18:00:07' prior: 51141655!
initializeWith: aCartID

	self titleMorph showButtonsNamed: #( close collapse ).
	
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel with: aCartID).
	
	self morphExtent: (self defaultExtent).

	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #newWordsArrived send: #refreshListOfWords to: self.! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 7/1/2021 18:00:56' prior: 51141006!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
		self halt.
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #addItemToCart label: 'add to cart'.	
	quantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #quantityText textSetter: #quantityText:. 
	quantityTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | quantityTextBoxMorph textMorph acceptContents ] .
	quantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: quantityTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindowModel methodsFor: 'initialization' stamp: 'ET 7/1/2021 18:02:01' prior: 51141158!
initializeWith: aCartID
	cartID := aCartID.
	items := OrderedCollection new.
	
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	items := restInterface catalog.
	
	quantity := ''.! !
!StoreClientWindowModel methodsFor: 'initialization' stamp: 'ET 7/1/2021 18:03:29' prior: 51141714!
initializeWith: aCartID
	cartID := aCartID.
	items := OrderedCollection new.
	
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	items := restInterface catalog.
	
	quantity := ''.
	
	cartListIndex := 0.! !

----SNAPSHOT----(1 July 2021 18:03:50) CuisUniversity-4532.image priorSource: 25919239!
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:06:20' prior: 51141363!
addItemToCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := (self items) at: self itemsListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	"self triggerEvent: #successfulLogIn with: self."
	"^cartID"
	
	
	
	
! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 18:06:40'!
listCart: cartID

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'cartId'->cartID.	

	
	resp:= WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[
			^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !

LogInWindow openWith: 1.!

StoreClientWindow openWith: 1.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 7/1/2021 18:07:20' prior: 51141684!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #addItemToCart label: 'add to cart'.	
	quantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #quantityText textSetter: #quantityText:. 
	quantityTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | quantityTextBoxMorph textMorph acceptContents ] .
	quantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: quantityTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:08:31' prior: 51141742!
addItemToCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := (self items) at: self itemsListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #updateCartList with: self.
	"^cartID"
	
	
	
	
! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 18:09:16' prior: 51141670!
initializeWith: aCartID

	self titleMorph showButtonsNamed: #( close collapse ).
	
	self setLabel: 'Store Client'.
	
	self model: (StoreClientWindowModel with: aCartID).
	
	self morphExtent: (self defaultExtent).

	self buildMorphicWindow.
	self openInWorld.
	self yourself.
			
	self model when: #cartListChanged send: #updateCartList to: self.! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:09:31' prior: 51141801!
addItemToCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := (self items) at: self itemsListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 18:09:46'!
updateCartList! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 18:09:59' prior: 51141845!
updateCartList

! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 18:10:13' prior: 51141849!
updateCartList

	cartListMorph updateList.! !
!StoreClientWindow methodsFor: 'initialization' stamp: 'ET 7/1/2021 18:10:28' prior: 51141853!
updateCartList

	cartListMorph updateList.
	
	cartListMorph setSelectionIndex: 0.! !

StoreClientWindow openWith: 1.!

----SNAPSHOT----(1 July 2021 18:11:59) CuisUniversity-4532.image priorSource: 25922777!
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:12:39' prior: 51141831!
addItemToCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := (self items) at: self itemsListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !

x := Bag with: 1 with: 1 with: 2.!

x!

x collect: [:x | x]!
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 7/1/2021 18:21:36' prior: 51141306!
cartList
	|showList|
	showList := OrderedCollection new.
	cartList asBag do: [:anItem | showList add: (anItem asString, ' | ', cartList occurrencesOf: anItem)].
	
	^showList.
! !

StoreClientWindow openWith: 1.!
!StoreClientWindowModel methodsFor: 'initialization' stamp: 'ET 7/1/2021 18:22:30' prior: 51141726!
initializeWith: aCartID
	cartID := aCartID.
	items := OrderedCollection new.
	cartList := OrderedCollection new.
	words := OrderedCollection new.
	sentence := ''.
	selectedIndex := 0.
	restInterface := StoreClientRestInterface new.
	
	items := restInterface catalog.
	
	quantity := ''.
	
	cartListIndex := 0.! !

StoreClientWindow openWith: 1.!
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 7/1/2021 18:23:17' prior: 51141885!
cartList
	|showList|
	showList := OrderedCollection new.
	cartList asBag do: [:anItem | showList add: (anItem asString, ' | ', (cartList occurrencesOf: anItem) asString)].
	
	^showList.
! !
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 7/1/2021 18:27:16' prior: 51141910!
cartList
	|showList|
	showList := OrderedCollection new.
	cartList asSet do: [:anItem | showList add: (anItem asString, ' | ', (cartList occurrencesOf: anItem) asString)].
	
	^showList.
! !

StoreClientWindow openWith: 1.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 7/1/2021 18:28:56' prior: 51141233!
build3rdColumn
	| firstRowLayoutMorph showInTranscriptButtonMorph|
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #removeSelectedItemFromCart label: 'remove from cart'.	
	cartListMorph := PluggableListMorph model: self model listGetter: #cartList indexGetter: #cartListIndex indexSetter: #cartListIndex:.
	cartListMorph  borderColor: Color skyBlue; borderWidth: 1; morphWidth:300.

	firstRowLayoutMorph := LayoutMorph newColumn.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'Cart list');
	addMorph: cartListMorph;
	addMorph: showInTranscriptButtonMorph.

	
	^firstRowLayoutMorph.! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:29:13'!
removeSelectedItemFromCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := (self items) at: self itemsListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:29:35' prior: 51141955!
removeSelectedItemFromCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := (cartList) at: self cartListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !

!classDefinition: #StoreClientWindowModel category: 'TusLibros-Client' stamp: 'ET 7/1/2021 18:33:59'!
Object subclass: #StoreClientWindowModel
	instanceVariableNames: 'sentence words selectedIndex restInterface items quantity cartID cartList cartListIndex indexedCartList'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Client'!
!StoreClientWindowModel methodsFor: 'PluggableListSelectors' stamp: 'ET 7/1/2021 18:33:58' prior: 51141920!
cartList
	|showList|
	showList := OrderedCollection new.
	indexedCartList := OrderedCollection new.
	cartList asSet do: [:anItem | showList add: (anItem asString, ' | ', (cartList occurrencesOf: anItem) asString).
				                  indexedCartList add: anItem].
	
	^showList.
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:34:54' prior: 51141970!
removeSelectedItemFromCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := (indexedCartList) at: self cartListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:35:05' prior: 51142009!
removeSelectedItemFromCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := indexedCartList at: self cartListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:35:54' prior: 51142025!
removeSelectedItemFromCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := indexedCartList at: self cartListIndex.
	
	restInterface removeFromCart: cartID Allitems: selectedItem.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:36:06' prior: 51142041!
removeSelectedItemFromCart
	|selectedItem |
	
	"self assertItemIsSelected."
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := indexedCartList at: self cartListIndex.
	
	restInterface removeFromCart: cartID AllItems: selectedItem.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !
!StoreClientRestInterface methodsFor: 'sending requests' stamp: 'ET 7/1/2021 18:36:53'!
removeFromCart: aCartID AllItems: anItem

	| fieldDict resp |
	fieldDict := Dictionary new.
	fieldDict add: 'cartId'->aCartID.	
	fieldDict add: 'bookIsbn'->anItem.

	
	resp:= WebClient htmlSubmit: (self url,'/removeFromCart') fields: fieldDict.
	
	resp isSuccess 
		ifTrue:[
			^(WebUtils jsonDecode: ((resp content) readStream)) .] 
		
		ifFalse:[^self error: resp content].! !

StoreClientWindow openWith: 1.!

----SNAPSHOT----(1 July 2021 18:37:53) CuisUniversity-4532.image priorSource: 25926837!
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:40:27' prior: 51141868!
addItemToCart
	|selectedItem |
	
	self assertListIsSelected: self items.
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := (self items) at: self itemsListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:44:05' prior: 51142091!
addItemToCart
	|selectedItem |
	
	self itemsListIndex = 0 ifTrue: [^self].
	self assertQuantityIsPositiveInteger.
	
	selectedItem := (self items) at: self itemsListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:44:13'!
assertQuantityIsPositiveInteger
	
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:44:49' prior: 51142121!
assertQuantityIsPositiveInteger
	
	
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:48:10' prior: 51142126!
assertQuantityIsPositiveInteger
	
	(quantity allSatisfy: [:aDigit | aDigit isDigit]) ifFalse: ['no es numero'].
	
	quantity asNumber.
	
	
! !
!StoreClientWindowModel methodsFor: 'PluggableButtonSelectors' stamp: 'ET 7/1/2021 18:49:16' prior: 51142106!
addItemToCart
	|selectedItem |
	
	self itemsListIndex = 0 ifTrue: [^self].
	"self assertQuantityIsPositiveInteger."
	
	selectedItem := (self items) at: self itemsListIndex.
	
	restInterface addToCart: cartID item: selectedItem quantity: quantity.
	
	cartList := restInterface listCart: cartID.
		
	self triggerEvent: #cartListChanged with: self.
	"^cartID"
	
	
	
	
! !

resp content!

resp content!

self!
!StoreRestInterface methodsFor: 'initialization' stamp: 'ET 7/1/2021 18:51:40' prior: 51140146!
initializeWith: aPortNumber
	
	store := Store withClientAuthenticator: (ClientAuthenticator withClient: 'admin' password: 'admin')
	clock: GregorianDateTime 
	priceList: (Dictionary with: 'validBook'->10)
	merchantProcessor: MerchantProcessorSimulator new.
	
	userCreditCards := Dictionary with: 'admin'-> (CreditCard owner: 'owner' number: '1234567891011121' expiration: GregorianMonthOfYear current next).
	
	userCarts := Dictionary new.
	
	port:= aPortNumber.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/createCart' action:[:request | |cartIDAsJson client password cartID |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		cartID := store createCartFor: client authenticatedWith: password.
		
		userCarts add: cartID->client.
		
		cartIDAsJson:= WebUtils jsonEncode: (cartID).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request sendResponseCode: 400 
		content: anError messageText asUtf8
		type: 'text/html; charset=utf-8'
		close: true. ]].
	
	webServer addService: '/addToCart' action:[:request | |answerAsJson cartID item quantity |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		quantity := (request fields at: 'quantityIsbn') asNumber.
		
		store addToCart: cartID item: item quantity: quantity.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request sendResponseCode: 400 
		content: anError messageText asUtf8
		type: 'text/html; charset=utf-8'
		close: true. ]].
	
	webServer addService: '/removeFromCart' action:[:request | |answerAsJson cartID item  |
		
		[cartID := (request fields at:'cartId') asNumber.
		item := (request fields at: 'bookIsbn').
		
		store removeFromCart: cartID allItems: item.
		
		answerAsJson:= WebUtils jsonEncode: ('OK').
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request sendResponseCode: 400 
		content: anError messageText asUtf8
		type: 'text/html; charset=utf-8'
		close: true. ]].
	
	webServer addService: '/catalog' action:[:request | |answerAsJson catalog  |
		
		[catalog := store itemCatalog.
		
		answerAsJson:= WebUtils jsonEncode: (catalog asArray).
		request send200Response: (answerAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request sendResponseCode: 400 
		content: anError messageText asUtf8
		type: 'text/html; charset=utf-8'
		close: true. ]].
	
	webServer addService: '/listCart' action:[:request | |answerAsJson cartID  list|
		
		[cartID := (request fields at:'cartId') asNumber.
		
		list := store listCart: cartID.
		
		answerAsJson:= WebUtils jsonEncode: (list asArray).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request sendResponseCode: 400 
		content: anError messageText asUtf8
		type: 'text/html; charset=utf-8'
		close: true. ]].
	
	webServer addService: '/checkOutCart' action:[:request | |answerAsJson cartID transactionID|
		
		[cartID := (request fields at:'cartId') asNumber.

		transactionID := store checkoutCart: cartID creditCard:  (self creditCardOfClient: (userCarts at: cartID)).
		
		answerAsJson:= WebUtils jsonEncode: (transactionID).
		request send200Response: (answerAsJson )
		 ] 
		on: Error
		do: [ :anError |
			request sendResponseCode: 400 
		content: anError messageText asUtf8
		type: 'text/html; charset=utf-8'
		close: true. ]].
	
	
	webServer addService: '/listPurchases' action:[:request | |cartIDAsJson client password list |
		
		[client := (request fields at:'clientId').
		password := (request fields at: 'password').
		
		list := store listPurchasesOf:  client password: password.

		cartIDAsJson:= WebUtils jsonEncode: (Array with: list list with: list totalAmount).
		request send200Response: (cartIDAsJson)
		 ] 
		on: Error
		do: [ :anError |
			request sendResponseCode: 400 
		content: anError messageText asUtf8
		type: 'text/html; charset=utf-8'
		close: true. ]].
	
	
	
	
	
	
	
	stringGenius := StringGenius new.
	
	webServer := WebServer new listenOn: self port.
	
	webServer addService: '/quote' action:[:request |	
		
		request send200Response: (self sayRandomQuote)].
	
	webServer addService: '/words' action:[:request | |wordsAsJson sentence words |
		
		[sentence := (request fields at:'sentence').
		words := stringGenius words: sentence.
		wordsAsJson:= WebUtils jsonEncode: (words).
		request send200Response: (wordsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/firstLetter' action:[:request | |letterAsJson word letter |
		
		[word := (request fields at:'sentence').
		letter := stringGenius firstLetter: word.
		letterAsJson:= WebUtils jsonEncode: (letter asString).
		request send200Response: (letterAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/vowels' action:[:request | |vowelsAsJson word vowels |
		
		[word := (request fields at:'sentence').
		vowels := stringGenius vowels: word.
		vowelsAsJson:= WebUtils jsonEncode: (vowels).
		request send200Response: (vowelsAsJson)
		 ] 
		on: Error 
		do: [ :anError |
			request send400Response: (anError messageText) ]].
	
	webServer addService: '/toUppercase' action:[:request | |upperCasedWordAsJson word upperCasedWord |
		
		[word := (request fields at:'sentence').
		upperCasedWord := stringGenius toUppercase: word.
		upperCasedWordAsJson:= WebUtils jsonEncode: (upperCasedWord).
		request send200Response: (upperCasedWordAsJson)
		 ] 
		on: Error 
		do:  [ :anError | request 
			request send400Response: (anError messageText)]].
! !

----SNAPSHOT----(1 July 2021 18:51:51) CuisUniversity-4532.image priorSource: 25933947!

----SNAPSHOT----(1 July 2021 18:52:25) CuisUniversity-4532.image priorSource: 25941949!

----STARTUP---- (1 July 2021 18:52:39) as C:\Users\ezequ\Desktop\windows64\CuisUniversity-4532.image!


server := StoreRestInterface listeningOn: 8080.!

LogInWindow open.!
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 7/1/2021 18:56:16' prior: 51141771!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #addItemToCart label: 'add to cart'.	
	
	quantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #quantityText textSetter: #quantityText:. 
	quantityTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | quantityTextBoxMorph textMorph acceptContents ] .
	quantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: quantityTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !
!StoreClientWindow methodsFor: 'GUI building' stamp: 'ET 7/1/2021 18:56:46' prior: 51142348!
build2ndColumn
	| showInTranscriptButtonMorph secondRowLayoutMorph |
	
	showInTranscriptButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #addItemToCart label: 'add to cart'.		
	quantityTextBoxMorph := TextModelMorph textProvider: self model textGetter: #quantityText textSetter: #quantityText:. 
	quantityTextBoxMorph textMorph setProperty: #keyStroke: toValue: [ :key | quantityTextBoxMorph textMorph acceptContents ] .
	quantityTextBoxMorph  borderWidth: 1; borderColor: Color skyBlue; morphWidth: 100; morphHeight: 10.
	
	
	secondRowLayoutMorph := LayoutMorph newColumn.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0;
	addMorph: (LabelMorph contents:'quantity to add');
	
	addMorph: quantityTextBoxMorph;
	
	addMorph: showInTranscriptButtonMorph.
	
	^secondRowLayoutMorph.
	! !

----SNAPSHOT----(1 July 2021 18:57:33) CuisUniversity-4532.image priorSource: 25942038!